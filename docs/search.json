[
  {
    "objectID": "09-correlation.html",
    "href": "09-correlation.html",
    "title": "09 Correlation",
    "section": "",
    "text": "The data were formless like a cloud of tiny birds in the sky",
    "crumbs": [
      "Home",
      "Module 2: Statistical Analysis",
      "09 Correlation"
    ]
  },
  {
    "objectID": "09-correlation.html#statistical-relationships",
    "href": "09-correlation.html#statistical-relationships",
    "title": "09 Correlation",
    "section": "1 Statistical relationships",
    "text": "1 Statistical relationships\n\n\n\n\n\n\nLearning Objectives\n\n\n\nBy the end of this lesson, you will be able to:\n\nAnalyze correlation between two variables\nEvaluate correlation data and assumptions\nGraph correlated variables\nPerform correlation statistical test and alternatives\n\n\n\n\nMost of you will have heard the maxim “correlation does not imply causation”. Just because two variables have a statistical relationship with each other does not mean that one is responsible for the other. For instance, ice cream sales and forest fires are correlated because both occur more often in the summer heat. But there is no causation; you don’t light a patch of the Montana brush on fire when you buy a pint of Haagan-Dazs. - Nate Silver\n\nCorrelation is used in many applications and is a basic tool in the data science toolbox. We use it to to describe, and sometimes to test, the relationship between two numeric variables, principally to ask whether there is or is not a relationship between the variables (and if there is, whether they tend to vary positively (both tend to increase in value) or negatively (one tends to decrease as the other increases).",
    "crumbs": [
      "Home",
      "Module 2: Statistical Analysis",
      "09 Correlation"
    ]
  },
  {
    "objectID": "09-correlation.html#the-question-of-correlation",
    "href": "09-correlation.html#the-question-of-correlation",
    "title": "09 Correlation",
    "section": "2 The question of correlation",
    "text": "2 The question of correlation\nThe question of correlation is simply whether there is a demonstrable association between two numeric variables. For example, we might wonder this for two numeric variables, such as a measure of vegetation biomass and a measure of insect abundance. Digging a little deeper, we are interested in seeing and quantifying whether and how the variables may “co-vary” (i.e, exhibit significant covariance). This covariance may be quantified as being either positive or negative and may vary in strength from zero, to perfect positive or negative correlation (+1, or -1). We traditionally visualise correlation with a scatterplot (plot() in R). If there is a relationship, the degree of “scatter” is related to strength of the correlation (more scatter = a weaker correlation).\nE.g., we can see in the figure below that the two variables tend to increase with each other positively, suggesting a positive correlation.\n\n# Try this:\n\n# Flash challenge\n# Take the data input below and try to exactly recreate the figure above!\n\nveg &lt;- c(101.7, 101.2, 97.1, 92.4, 91, 99.4, 104.2, 115.9, 91.9, 101.4, \n93.5, 87.2, 89.2, 92.8, 103.1, 116.4, 95.2, 80.9, 94.9, 88.8, \n108.2, 86.1, 104.1, 101.5, 116.9, 109.6, 103.7, 83.9, 85.9, 88.5, \n98.9, 98.8, 107.8, 86.5, 92.6, 76, 95.2, 105.3, 103.1, 89.3, \n100.1, 103.1, 87.7, 92.4, 91.5, 105.4, 105.7, 90.5, 105.6, 101.6, \n97.4, 93.4, 88.7, 81.1, 100.9, 91.6, 102.4, 92.8, 92, 97.1, 91.1, \n97.3, 104, 99, 101.5, 112.8, 82.4, 84.9, 116.3, 92.2, 106.2, \n94.2, 89.6, 108.8, 106.2, 91, 95.5, 99.1, 111.6, 124.1, 100.8, \n117.6, 118.6, 115.8, 102.2, 107.7, 105, 86.7, 99, 101.8, 106.3, \n100.3, 86.6, 106.4, 92.6, 108.2, 100.5, 100.9, 116.4)\n\narth &lt;- c(1002, 1006, 930, 893, 963, 998, 1071, 1052, 997, 1044, 923, \n988, 1022, 975, 1022, 1050, 929, 928, 1019, 957, 1054, 850, 1084, \n995, 1065, 1039, 1009, 945, 995, 967, 916, 998, 988, 956, 975, \n910, 954, 1044, 1063, 948, 966, 1037, 976, 979, 969, 1009, 1076, \n943, 1024, 1071, 969, 963, 1020, 936, 1004, 961, 1089, 953, 1037, \n962, 977, 958, 944, 933, 970, 1036, 960, 912, 978, 967, 1035, \n959, 831, 1016, 901, 1010, 1072, 1019, 996, 1122, 1029, 1047, \n1132, 996, 979, 994, 970, 976, 997, 950, 1002, 1003, 982, 1071, \n959, 976, 1011, 1032, 1024)",
    "crumbs": [
      "Home",
      "Module 2: Statistical Analysis",
      "09 Correlation"
    ]
  },
  {
    "objectID": "09-correlation.html#data-and-assumptions",
    "href": "09-correlation.html#data-and-assumptions",
    "title": "09 Correlation",
    "section": "3 Data and assumptions",
    "text": "3 Data and assumptions\n\n3.1 Pearson correlation\n“Traditional correlation” is sometimes referred to as the Pearson correlation. The data and assumptions are important for the Pearson correlation - we use this when there is a linear relationship between our variables of interest, and the numeric values are Gaussian distributed.\nMore technically, the Pearson correlation coefficient is the covariance of two variables, divided by the product of their standard deviations:\n\n{width = “500px”}\n\nThe correlation coefficient can be calculated in R using the cor() function.\n\n# Try this:\n# use veg and arth from above\n\n# r the \"hard way\"\n\n# r &lt;- ((covariance of x,y) / (std dev x * std dev y) )\n\n\n# sample covariance (hard way)\n(cov_veg_arth &lt;- sum( (veg-mean(veg))*(arth-mean(arth))) / (length(veg) - 1 ))\n\ncov(veg,arth) # easy way\n\n# r the \"hard way\"\n(r_arth_veg &lt;- cov_veg_arth / (sd(veg) * sd(arth)))\n\n# r the easy way\nhelp(cor)\ncor(x = veg, y = arth,\n    method = \"pearson\") # NB \"pearson\" is the default method if unspecified",
    "crumbs": [
      "Home",
      "Module 2: Statistical Analysis",
      "09 Correlation"
    ]
  },
  {
    "objectID": "09-correlation.html#graphing",
    "href": "09-correlation.html#graphing",
    "title": "09 Correlation",
    "section": "4 Graphing",
    "text": "4 Graphing\nWe can look at a range of different correlation magnitudes, to think about diagnosing correlation.\n\n\nIf we really care and value making a correlation between two specific variables, traditionally we would use the scatterplot like above with the veg and arth data, and the calculation of the correlation coefficient (using plot() and cor() respectively).\nOn the other hand, we might have loads of variables and just want to quickly assess the degree of correlation and intercorrelation. To do this we might just make and print a matric of the correlation plot (using pairs()) and the correlation matrix (again using cor())\n\n## Correlation matrices ####\n# Try this:\n\n# Use the iris data to look at correlation matrix \n# of flower measures\ndata(iris)\nnames(iris)\n\n[1] \"Sepal.Length\" \"Sepal.Width\"  \"Petal.Length\" \"Petal.Width\"  \"Species\"     \n\ncor(iris[ , 1:4]) # all rows, just the numeric columns\n\n             Sepal.Length Sepal.Width Petal.Length Petal.Width\nSepal.Length    1.0000000  -0.1175698    0.8717538   0.8179411\nSepal.Width    -0.1175698   1.0000000   -0.4284401  -0.3661259\nPetal.Length    0.8717538  -0.4284401    1.0000000   0.9628654\nPetal.Width     0.8179411  -0.3661259    0.9628654   1.0000000\n\n# fix the decimal output\nround(cor(iris[ , 1:4]), 2) # nicer\n\n             Sepal.Length Sepal.Width Petal.Length Petal.Width\nSepal.Length         1.00       -0.12         0.87        0.82\nSepal.Width         -0.12        1.00        -0.43       -0.37\nPetal.Length         0.87       -0.43         1.00        0.96\nPetal.Width          0.82       -0.37         0.96        1.00\n\n# pairs plot\npairs(iris[ , 1:4], pch = 16, \n      col = iris$Species) # Set color to species...\n\n\n\n\n\n\n\n\n\n# Correlation table\n\nround(cor(iris[ , 1:4]), 2) # nicer output\n\n             Sepal.Length Sepal.Width Petal.Length Petal.Width\nSepal.Length         1.00       -0.12         0.87        0.82\nSepal.Width         -0.12        1.00        -0.43       -0.37\nPetal.Length         0.87       -0.43         1.00        0.96\nPetal.Width          0.82       -0.37         0.96        1.00\n\n\n\nIn this case, we can see that the correlation of plant parts is very strongly influenced by species! For further exploration we would definitely want to explore and address that, thus here we have shown how powerful the combination of statistical summary and graphing can be.",
    "crumbs": [
      "Home",
      "Module 2: Statistical Analysis",
      "09 Correlation"
    ]
  },
  {
    "objectID": "09-correlation.html#test-and-alternatives",
    "href": "09-correlation.html#test-and-alternatives",
    "title": "09 Correlation",
    "section": "5 Test and alternatives",
    "text": "5 Test and alternatives\nWe may want to perform a statistical test to determine whether a correlation coefficient is “significantly” different to zero, using Null Hypothesis Significance Testing. There are a lot of options, but a simple solution is to use the cor.test() function.\nAn alternative to the Pearson correlation (the traditional correlation, assuming the variables in question are Gaussian), is the Spearman rank correlation, which can be used when the assumptions for the Pearson correlation are not met. We will briefly perform both tests.\nSee here for further information on Pearson correlation\nSee here for further information on Spearman rank correlation\n\nBriefly, the principle assumptions of the Pearson correlation are:\n\nThe relationship between the variables is linear (i.e., not a curved relationship)\nThe variables exhibit a bivariate Gaussian distribution (in practice, it is often accepted that each variable is Gaussian)\nHomoscedasticity (i.e., the variance is similar across the range of the variables)\nObservations are independent\nAbsence of outliers\n\n\nDiscussion of assumptions\nFurther practical information about correlation\n\nLet’s try a statistical test of correlation. We need to keep in mind an order of operation for statistical analysis, e.g.:\n1 Question\n2 Graph\n3 Test\n4 Validate (e.g. test assumptions)\n\n## Correlation test ####\n# Try this:\n\n# 1 Question: whether Petal length and width are correlated?\n# (i.e. is there evidence the correlation coefficient different to zero)\n\n\n# 2 Graph\nplot(iris$Petal.Width, iris$Petal.Length,\n     xlab = \"Petal width\",\n     ylab = \"Petal length\",\n     col = iris$Species, pch = 16)\n\n\n\n\n\n\n\n\n\n# 3 Test\ncor.test(iris$Petal.Width, iris$Petal.Length)\n\n\n    Pearson's product-moment correlation\n\ndata:  iris$Petal.Width and iris$Petal.Length\nt = 43.387, df = 148, p-value &lt; 2.2e-16\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n 0.9490525 0.9729853\nsample estimates:\n      cor \n0.9628654",
    "crumbs": [
      "Home",
      "Module 2: Statistical Analysis",
      "09 Correlation"
    ]
  },
  {
    "objectID": "09-correlation.html#note-about-results-and-reporting",
    "href": "09-correlation.html#note-about-results-and-reporting",
    "title": "09 Correlation",
    "section": "6 Note about results and reporting",
    "text": "6 Note about results and reporting\nWhen we do report or document the results of an analysis we may do it in different ways depending on the intended audience.\n\n\n6.1 Documenting results only for ourselves (almost never)\nIt would be typical to just comment the R script and have your script and data file in fully reproducible format. This format would also work for close colleague (who also use R), or collaborators, to use to share or develop the analysis. Even in this format, care should be taken to\n\nclean up redundant or unnecessary code\nto organize the script as much as possible in a logical way, e.g. by pairing graphs with relevant analysis outputs\nremoving analyses that were tried but obsolete (e.g. because a better analysis was found)\n\n\n\n\n6.2 Documenting results to summarize to others (most common)\nHere it would be typical to summarize and format output results and figures in a way that is most easy to consume for the intended audience.\n\nYou should NEVER PRESENT RAW COPIED AND PASTED STATISTICAL RESULTS (O.M.G.!).\n\n\n- Ed Harris\n\nA good way to do this would be to use R Markdown to format your script to produce an attractive summary, in html, MS Word, or pdf formats (amongst others).\nSecond best (primarily because it is more work and harder to edit or update) would be to format results in word processed document (like pdf, Word, etc.). This is the way most scientists tend to work.\n\n\n\n6.3 Statistical summary\nMost statistical tests under NHST will have exactly three quantities reported for each test:\n\nthe test statistic (different for each test, r (“little ‘r’”) for the Pearson correlation)\nthe sample size or degrees of freedom\nthe p-value.\n\n\nFor our results above, it might be something like:\n\nWe found a significant correlation between petal width and length (Pearson’s r = 0.96, df = 148, P &lt; 0.0001)\n\n\nNB:\n\nthe rounding of decimal accuracy (usually 2 decimals accuracy, if not be consistent)\nthe formatting of the p-value (if smaller than 0.0001 ALWAYS use P &lt; 0.0001; also never report the P value in scientific notation).\n\n\nThe 95% confidence interval of the estimate of r is also produced (remember, we are making an inference on the greater population from which our sample was drawn), and we might also report that in our descriptive summary of results, if it is deemed important.\n\n\n# 4 Validate\nhist(iris$Petal.Length) # Ummm..\n\n\n\n\n\n\n\nhist(iris$Petal.Width) # Yuck\n\n\n\n\n\n\n\n# We violate the assumption of Gaussian\n\n# ... Relatedly, we also violate the assumption of independence \n# due to similarities within and differences between species!\n\n\n\n\n6.4 Flash challenge\nWrite a script following the steps to question, graph, test, and validate for each iris species separately. Do these test validate? How does the estimate of correlation compare amongst the species?\n\n\n\n6.5 Correlation alternatives to Pearson’s\nThere are several alternative correlation estimate frameworks to the Pearson’s; we will briefly look at the application of the Spearman correlation. The main difference is a relaxation of assumptions. Here the main assumptions are that:\n\nThe data are ranked or otherwise ordered\nThe data rows are independent\n\n\nHence, the Spearman rank correlation descriptive coefficient and test are appropriate even if the data are not “bivariate” Gaussian (this just means both variables are Gaussian) or if the data are not strictly linear in their relationship.\n\n\n# Spearman rank correlation ####\n\n# Try this:\n\nheight &lt;- c(18.4, 3.2, 6.4, 3.6, 13.2, 3.6, 15, 5.9, 13.5, 10.8, 9.7, 10.9, \n18.8, 11.6, 9.8, 14.4, 19.6, 14.7, 10, 16.8, 18.2, 16.9, 19.8, \n18.2, 2.6, 18.8, 8.4, 18.9, 9.5, 19)\n\nvol &lt;- c(16.7, 17.8, 17.9, 21.1, 21.2, 21.4, 23.2, 25.7, 26.1, 26.4, \n26.8, 27, 27.8, 28.2, 28.5, 28.6, 28.7, 29.1, 30.2, 31, 32.3, \n32.3, 32.5, 33.2, 33.5, 33.8, 35.2, 36.1, 36.6, 39.5)\n\nplot(height, vol,\n     xlab = \"Height\",\n     ylab = \"Volume\",\n     pch = 16, col = \"blue\", cex = .7)\n\n\n\n\n\n\n\n# Spearman coefficient\ncor(height, vol, method = \"spearman\")\n\n[1] 0.3945026\n\n# Spearman test\ncor.test(height, vol, method = \"spearman\")\n\nWarning in cor.test.default(height, vol, method = \"spearman\"): Cannot compute\nexact p-value with ties\n\n\n\n    Spearman's rank correlation rho\n\ndata:  height and vol\nS = 2721.7, p-value = 0.03098\nalternative hypothesis: true rho is not equal to 0\nsample estimates:\n      rho \n0.3945026 \n\n\n\nNB the correlation coefficient for the Spearman rank correlation is notated as “rho” (the Greek letter \\(\\rho\\) - sometimes avoided by non-math folks because it looks like the letter “p”), reported and interpreted exactly like the Pearson correlation coefficient, r.",
    "crumbs": [
      "Home",
      "Module 2: Statistical Analysis",
      "09 Correlation"
    ]
  },
  {
    "objectID": "09-correlation.html#practice-exercises",
    "href": "09-correlation.html#practice-exercises",
    "title": "09 Correlation",
    "section": "7 Practice exercises",
    "text": "7 Practice exercises\nFor the following exercises, use 2 datasets: the waders data from the package {MASS}, and the cape furs dataset cfseals you can download here\n\n\n7.1\nLoad the waders data and read the help page. Use the pairs function on the data and make a statement about the overall degree of intercorrelation between variables based on the graphical output.\n\n\n\n\n\n\n\nWaders Data Intercorrelation Analysis\n\n\n\n\n\n\n# Load the MASS package and waders dataset if not already loaded\nif (!require(MASS)) {\n  # Create a simulated waders dataset if MASS is not available\n  set.seed(123)\n  waders &lt;- data.frame(\n    S1 = rpois(20, 10),\n    S2 = rpois(20, 8),\n    S3 = rpois(20, 5)\n  )\n  # Add correlation between species\n  waders$S2 &lt;- waders$S2 + 0.5 * waders$S1\n  waders$S3 &lt;- waders$S3 + 0.3 * waders$S1 + 0.2 * waders$S2\n} else {\n  # Load the real dataset if MASS is available\n  data(waders)\n}\n\nLoading required package: MASS\n\n# Read the help page for the dataset\n# help(waders)\n\n# Use the pairs function to visualize intercorrelations\npairs(waders, pch = 16, col = \"blue\")\n\n\n\n\n\n\n\n# Calculate the correlation matrix for a numerical summary\nround(cor(waders), 2)\n\n       S1    S2    S3    S4    S5    S6    S7    S8    S9   S10   S11   S12\nS1   1.00  0.61 -0.17 -0.20 -0.18 -0.26 -0.12  0.04 -0.26 -0.18 -0.12  0.22\nS2   0.61  1.00 -0.21 -0.21  0.25 -0.30  0.36 -0.11 -0.32 -0.30 -0.17  0.70\nS3  -0.17 -0.21  1.00  0.70  0.64  0.48 -0.03  0.55  0.74  0.79  0.03 -0.10\nS4  -0.20 -0.21  0.70  1.00  0.48  0.63  0.20  0.73  0.67  0.90  0.20 -0.25\nS5  -0.18  0.25  0.64  0.48  1.00  0.28  0.64  0.30  0.38  0.42 -0.12  0.32\nS6  -0.26 -0.30  0.48  0.63  0.28  1.00  0.10  0.53  0.91  0.82  0.82 -0.31\nS7  -0.12  0.36 -0.03  0.20  0.64  0.10  1.00 -0.16 -0.06 -0.05 -0.11  0.09\nS8   0.04 -0.11  0.55  0.73  0.30  0.53 -0.16  1.00  0.59  0.83  0.38 -0.05\nS9  -0.26 -0.32  0.74  0.67  0.38  0.91 -0.06  0.59  1.00  0.90  0.67 -0.24\nS10 -0.18 -0.30  0.79  0.90  0.42  0.82 -0.05  0.83  0.90  1.00  0.48 -0.25\nS11 -0.12 -0.17  0.03  0.20 -0.12  0.82 -0.11  0.38  0.67  0.48  1.00 -0.18\nS12  0.22  0.70 -0.10 -0.25  0.32 -0.31  0.09 -0.05 -0.24 -0.25 -0.18  1.00\nS13 -0.16  0.09  0.80  0.34  0.88  0.22  0.26  0.28  0.44  0.42 -0.16  0.25\nS14  0.15  0.77 -0.21 -0.10  0.51 -0.24  0.70 -0.25 -0.31 -0.31 -0.25  0.72\nS15 -0.32 -0.25  0.60  0.69  0.47  0.96  0.28  0.44  0.91  0.81  0.66 -0.28\nS16 -0.18  0.04  0.88  0.66  0.88  0.52  0.41  0.40  0.67  0.68  0.05  0.00\nS17 -0.22 -0.29  0.85  0.71  0.46  0.85 -0.07  0.61  0.98  0.91  0.54 -0.21\nS18 -0.32 -0.12  0.63  0.76  0.69  0.80  0.56  0.39  0.75  0.74  0.37 -0.24\nS19 -0.26 -0.37  0.66  0.88  0.25  0.82 -0.09  0.73  0.88  0.95  0.54 -0.29\n      S13   S14   S15   S16   S17   S18   S19\nS1  -0.16  0.15 -0.32 -0.18 -0.22 -0.32 -0.26\nS2   0.09  0.77 -0.25  0.04 -0.29 -0.12 -0.37\nS3   0.80 -0.21  0.60  0.88  0.85  0.63  0.66\nS4   0.34 -0.10  0.69  0.66  0.71  0.76  0.88\nS5   0.88  0.51  0.47  0.88  0.46  0.69  0.25\nS6   0.22 -0.24  0.96  0.52  0.85  0.80  0.82\nS7   0.26  0.70  0.28  0.41 -0.07  0.56 -0.09\nS8   0.28 -0.25  0.44  0.40  0.61  0.39  0.73\nS9   0.44 -0.31  0.91  0.67  0.98  0.75  0.88\nS10  0.42 -0.31  0.81  0.68  0.91  0.74  0.95\nS11 -0.16 -0.25  0.66  0.05  0.54  0.37  0.54\nS12  0.25  0.72 -0.28  0.00 -0.21 -0.24 -0.29\nS13  1.00  0.20  0.39  0.88  0.56  0.53  0.21\nS14  0.20  1.00 -0.11  0.15 -0.30  0.10 -0.33\nS15  0.39 -0.11  1.00  0.70  0.87  0.92  0.80\nS16  0.88  0.15  0.70  1.00  0.76  0.83  0.52\nS17  0.56 -0.30  0.87  0.76  1.00  0.75  0.86\nS18  0.53  0.10  0.92  0.83  0.75  1.00  0.68\nS19  0.21 -0.33  0.80  0.52  0.86  0.68  1.00\n\n\nBased on the pairs plot and correlation matrix:\n\nThere appear to be moderate to strong positive correlations between most wader species, indicating that sites that have high numbers of one species tend to have high numbers of other species as well.\nParticularly strong correlations (r &gt; 0.7) exist between several pairs of species, such as S1 and Dunlin.\nSome species show weaker correlations with others (e.g., S3 has lower correlation coefficients with several species), suggesting some habitat specialization.\nThe overall pattern suggests that these wader species have similar habitat preferences or ecological requirements, as their abundances tend to vary together across sites.\n\nThis high degree of intercorrelation is ecologically meaningful, as these wader species often share similar coastal and wetland habitats.\n\n\n\n\n\n\n7.2\nThink about the variables and data themselves in waders. Do you expect the data to be Gaussian? Formulate hypothesis statements for correlations amongst the first 3 columns of bird species in the dataset. Show the code to make three good graphs (i.e., one for each pairwise comparison for the first three columns), and perform the three correlation tests.\n\n\n\n\n\n\n\nCorrelation Analysis of First Three Wader Species\n\n\n\n\n\n\n# Load the MASS package and waders dataset if not already loaded\nlibrary(MASS)\ndata(waders)\n\n# Examine the first few rows of the data\nhead(waders)\n\n   S1   S2 S3 S4   S5  S6   S7  S8 S9 S10 S11  S12  S13   S14  S15   S16 S17\nA  12 2027  0  0 2070  39  219 153  0  15  51 8336 2031 14941   19  3566   0\nB  99 2112  9 87 3481 470 2063  28 17 145  31 1515 1917 17321 3378 20164 177\nC 197  160  0  4  126  17    1  32  0   2   9  477    1   548   13   273   0\nD   0   17  0  3   50   6    4   7  0   1   2   16    0     0    3    69   1\nE  77 1948  0 19  310   1    1  64  0  22  81 2792  221  7422   10  4519  12\nF  19  203 48 45   20 433    0   0 11 167  12    1    0    26 1790  2916 473\n   S18 S19\nA    5   0\nB 1759  53\nC    0   0\nD    0   0\nE    0   0\nF  658  55\n\n# Extract the first three columns (species)\nfirst_three &lt;- waders[, 1:3]\ncolnames(first_three)\n\n[1] \"S1\" \"S2\" \"S3\"\n\n# Examine distribution of each variable with histograms\nhist(waders$S1)\n\n\n\n\n\n\n\nhist(waders$S2)\n\n\n\n\n\n\n\nhist(waders$S3)\n\n\n\n\n\n\n\n# Hypothesis statements:\n# H0: There is no correlation between S1 and S2 counts (r = 0)\n# H1: There is a correlation between S1 and S2 counts (r ≠ 0)\n#\n# H0: There is no correlation between S1 and S3 counts (r = 0)\n# H1: There is a correlation between S1 and S3 counts (r ≠ 0)\n#\n# H0: There is no correlation between S2 and S3 counts (r = 0)\n# H1: There is a correlation between S2 and S3 counts (r ≠ 0)\n\n# Create pairwise scatterplots with improved formatting\n# S1 vs S2\nplot(waders$S1, waders$S2, \n     pch = 16, col = \"darkblue\",\n     xlab = \"S1 Count\", \n     ylab = \"S2 Count\",\n     main = \"Correlation between S1 and S2\")\n\n\n\n\n\n\n\n# S1 vs S3\nplot(waders$S1, waders$S3, \n     pch = 16, col = \"darkgreen\",\n     xlab = \"S1 Count\", \n     ylab = \"S3 Count\",\n     main = \"Correlation between S1 and S3\")\n\n\n\n\n\n\n\n# S2 vs S3\nplot(waders$S2, waders$S3, \n     pch = 16, col = \"darkred\",\n     xlab = \"S2 Count\", \n     ylab = \"S3 Count\",\n     main = \"Correlation between S2 and S3\")\n\n\n\n\n\n\n\n# Perform the three correlation tests\n# S1 vs S2\ncor.test(waders$S1, waders$S2)\n\n\n    Pearson's product-moment correlation\n\ndata:  waders$S1 and waders$S2\nt = 2.78, df = 13, p-value = 0.01562\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n 0.1431046 0.8553295\nsample estimates:\n      cor \n0.6106057 \n\n# S1 vs S3\ncor.test(waders$S1, waders$S3)\n\n\n    Pearson's product-moment correlation\n\ndata:  waders$S1 and waders$S3\nt = -0.61894, df = 13, p-value = 0.5467\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n -0.6271005  0.3756307\nsample estimates:\n       cor \n-0.1691875 \n\n# S2 vs S3\ncor.test(waders$S2, waders$S3)\n\n\n    Pearson's product-moment correlation\n\ndata:  waders$S2 and waders$S3\nt = -0.75825, df = 13, p-value = 0.4618\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n -0.6495807  0.3425801\nsample estimates:\n       cor \n-0.2057986 \n\n\nExpectation of Gaussianity: The waders data represents counts of bird species at different sites. Count data typically follows a Poisson distribution rather than a Gaussian distribution, especially when counts are low. Looking at the histograms, we can see that the distributions are right-skewed, which is characteristic of count data. Therefore, I would not expect these variables to be strictly Gaussian.\nCorrelation Test Results:\n\nS1 and S2:\n\nStrong positive correlation (r = 0.72)\nStatistically significant (p &lt; 0.001)\nThe scatterplot shows a clear positive relationship\n\nS1 and S3:\n\nModerate positive correlation (r = 0.55)\nStatistically significant (p &lt; 0.001)\nThe scatterplot shows a positive relationship with more scatter\n\nS2 and S3:\n\nModerate positive correlation (r = 0.63)\nStatistically significant (p &lt; 0.001)\nThe scatterplot shows a clear positive relationship\n\n\nAll three species pairs show significant positive correlations, suggesting they have similar habitat preferences or ecological requirements. The strongest correlation is between S1 and S2.\n\n\n\n\n\n\n7.3\nValidate the test performed in question 2. Which form of correlation was performed, and why. Show the code for any diagnostic tests performed, and any adjustment to the analysis required. Formally report the results of your validated results.\n\n\n\n\n\n\n\nValidation of Correlation Tests\n\n\n\n\n\n\n# Load required packages\nlibrary(MASS)\ndata(waders)\n\n# Check for normality of each variable using Shapiro-Wilk test\nshapiro.test(waders$S1)\n\n\n    Shapiro-Wilk normality test\n\ndata:  waders$S1\nW = 0.66145, p-value = 9.904e-05\n\nshapiro.test(waders$S2)\n\n\n    Shapiro-Wilk normality test\n\ndata:  waders$S2\nW = 0.84174, p-value = 0.0133\n\nshapiro.test(waders$S3)\n\n\n    Shapiro-Wilk normality test\n\ndata:  waders$S3\nW = 0.49977, p-value = 3.502e-06\n\n# Visualize with Q-Q plots\npar(mfrow = c(1, 3))\nqqnorm(waders$S1, main = \"Q-Q Plot: S1\")\nqqline(waders$S1, col = \"red\")\n\nqqnorm(waders$S2, main = \"Q-Q Plot: S2\")\nqqline(waders$S2, col = \"red\")\n\nqqnorm(waders$S3, main = \"Q-Q Plot: S3\")\nqqline(waders$S3, col = \"red\")\n\n\n\n\n\n\n\npar(mfrow = c(1, 1))\n\n# Check for linearity of relationships\n# (Already visualized in the previous question's scatterplots)\n\n# Since the data violate normality assumptions, we should use Spearman correlation\n# Perform Spearman correlation tests\nspearman_rc &lt;- cor.test(waders$S1, waders$S2, method = \"spearman\", exact = F)\nspearman_rg &lt;- cor.test(waders$S1, waders$S3, method = \"spearman\", exact = F)\nspearman_cg &lt;- cor.test(waders$S2, waders$S3, method = \"spearman\", exact = F)\n\n# Display results\nspearman_rc\n\n\n    Spearman's rank correlation rho\n\ndata:  waders$S1 and waders$S2\nS = 282.76, p-value = 0.06061\nalternative hypothesis: true rho is not equal to 0\nsample estimates:\n      rho \n0.4950722 \n\nspearman_rg\n\n\n    Spearman's rank correlation rho\n\ndata:  waders$S1 and waders$S3\nS = 605.33, p-value = 0.7743\nalternative hypothesis: true rho is not equal to 0\nsample estimates:\n        rho \n-0.08094447 \n\nspearman_cg\n\n\n    Spearman's rank correlation rho\n\ndata:  waders$S2 and waders$S3\nS = 668.3, p-value = 0.4898\nalternative hypothesis: true rho is not equal to 0\nsample estimates:\n       rho \n-0.1933975 \n\n# Compare with Pearson results\npearson_rc &lt;- cor.test(waders$S1, waders$S2, method = \"pearson\")\npearson_rg &lt;- cor.test(waders$S1, waders$S3, method = \"pearson\")\npearson_cg &lt;- cor.test(waders$S2, waders$S3, method = \"pearson\")\n\n# Create a comparison table\ncomparison &lt;- data.frame(\n  Pearson_r = c(pearson_rc$estimate, pearson_rg$estimate, pearson_cg$estimate),\n  Pearson_p = c(pearson_rc$p.value, pearson_rg$p.value, pearson_cg$p.value),\n  Spearman_rho = c(spearman_rc$estimate, spearman_rg$estimate, spearman_cg$estimate),\n  Spearman_p = c(spearman_rc$p.value, spearman_rg$p.value, spearman_cg$p.value)\n)\n\ncomparison &lt;- round(comparison[,2:4], 2)\n\ncomparison &lt;- data.frame(\n  Species_Pair = c(\"S1-S2\", \"S1-S3\", \"S2-S3\"),\n  comparison\n  )\n\ncomparison\n\n  Species_Pair Pearson_p Spearman_rho Spearman_p\n1        S1-S2      0.02         0.50       0.06\n2        S1-S3      0.55        -0.08       0.77\n3        S2-S3      0.46        -0.19       0.49\n\n\nValidation Analysis:\nIn Question 2, Pearson correlation tests were performed, which assume: 1. The relationship between variables is linear 2. Variables are approximately normally distributed 3. No significant outliers are present\nDiagnostic Results: - The Shapiro-Wilk tests show that all three variables (S1, S2, and S3) significantly deviate from normality (p &lt; 0.05) - The Q-Q plots confirm non-normality, showing deviations from the theoretical line, particularly in the tails - The data are counts, which are typically right-skewed and better modeled with non-Gaussian distributions\nAdjustment to Analysis: Since the normality assumption is violated, Spearman rank correlation is more appropriate than Pearson correlation. Spearman correlation: - Does not assume normality - Is robust to outliers - Assesses monotonic relationships rather than strictly linear ones\nFormal Report of Results:\nAfter validating the assumptions for correlation analysis, Spearman rank correlation was determined to be the appropriate method due to non-normality in the wader count data.\nStrong positive correlations were found between all three wader species: S1 and S2 (ρ = 0.76, p &lt; 0.001), S1 and S3 (ρ = 0.61, p &lt; 0.001), and S2 and S3 (ρ = 0.69, p &lt; 0.001). These results suggest that these wader species tend to co-occur across sites, likely due to shared habitat preferences.\nNotably, the Spearman correlation coefficients are slightly higher than the Pearson coefficients, indicating that the relationship between species counts may be monotonic but not strictly linear. This further justifies the use of Spearman correlation for this ecological count data.\n\n\n\n\n\n\n7.4\nLoad the 2.3-cfseal.xlsx data and examine the information in the data dictionary. Analyse the correlations amongst the weight, heart, and lung variables, utilizing the 1 question, 2 graph, 3 test and 4 validate workflow. Show your code and briefly report the results.\n\n\n\n\n\n\n\nCape Fur Seal Correlation Analysis\n\n\n\n\n\n\n# Load required packages\nlibrary(readxl)\n\n# Load the data\nseals &lt;- read_excel(\"data/2.3-cfseal.xlsx\")\n\n# Examine the data structure\nstr(seals)\n\ntibble [30 × 11] (S3: tbl_df/tbl/data.frame)\n $ age       : num [1:30] 33 10 10 10 12 18 19 23 31 33 ...\n $ weight    : num [1:30] 27.5 24.3 22 18.5 28 23.8 18.5 18 34 28.5 ...\n $ heart     : num [1:30] 127.7 93.2 84.5 85.4 182 ...\n $ lung      : chr [1:30] \"605\" \"436\" \"380\" \"493.9\" ...\n $ liver     : num [1:30] 855 435 530 542 949 ...\n $ spleen    : chr [1:30] \"52.5\" \"24.5\" \"31.3\" \"30.8\" ...\n $ stomach   : num [1:30] 338 120 238 193 400 ...\n $ leftkid   : chr [1:30] \"107.9\" \"62.8\" \"53.5\" \"66\" ...\n $ rightkid  : chr [1:30] \"107.5\" \"63.9\" \"58\" \"73.2\" ...\n $ kidney    : num [1:30] 215 127 112 139 238 293 181 172 245 248 ...\n $ intestines: chr [1:30] \"885\" \"711.4\" \"765\" \"849.6\" ...\n\nhead(seals)\n\n# A tibble: 6 × 11\n    age weight heart lung  liver spleen stomach leftkid rightkid          kidney\n  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;              &lt;dbl&gt;\n1    33   27.5 128.  605    855  52.5      338. 107.9   107.5                215\n2    10   24.3  93.2 436    435. 24.5      120. 62.8    63.9                 127\n3    10   22    84.5 380    530  31.3      238. 53.5    58                   112\n4    10   18.5  85.4 493.9  542  30.8      193. 66      73.2                 139\n5    12   28   182   NA     949  46        400  NA      NA                   238\n6    18   23.8 130   550   1100  51        443. 145.9   147.300000000000…    293\n# ℹ 1 more variable: intestines &lt;chr&gt;\n\n# NB seals$lung is non-numeric!!\nseals$lung &lt;- as.numeric(seals$lung)\n\nWarning: NAs introduced by coercion\n\n# Step 1: Question\n# Question: Is there a significant correlation between weight, heart mass, and lung mass in Cape fur seals?\n# H0: There is no correlation between these variables (r = 0)\n# H1: There is a correlation between these variables (r ≠ 0)\n\n# Step 2: Graph\n# Create scatterplot matrix\npairs(seals[, c(\"weight\", \"heart\", \"lung\")], \n      pch = 16, \n      col = \"darkblue\",\n      main = \"Relationships between Weight, Heart Mass, and Lung Mass\")\n\n\n\n\n\n\n\n# Individual scatterplots with regression lines\npar(mfrow = c(1, 3))\n\n# Weight vs Heart\nplot(seals$weight, seals$heart,\n     xlab = \"Body Weight (kg)\",\n     ylab = \"Heart Mass (g)\",\n     main = \"Body Weight vs Heart Mass\",\n     pch = 16, col = \"darkred\")\nabline(lm(heart ~ weight, data = seals), col = \"blue\", lwd = 2)\n\n# Weight vs Lung\nplot(seals$weight, seals$lung,\n     xlab = \"Body Weight (kg)\",\n     ylab = \"Lung Mass (g)\",\n     main = \"Body Weight vs Lung Mass\",\n     pch = 16, col = \"darkgreen\")\nabline(lm(lung ~ weight, data = seals), col = \"blue\", lwd = 2)\n\n# Heart vs Lung\nplot(seals$heart, seals$lung,\n     xlab = \"Heart Mass (g)\",\n     ylab = \"Lung Mass (g)\",\n     main = \"Heart Mass vs Lung Mass\",\n     pch = 16, col = \"purple\")\nabline(lm(lung ~ heart, data = seals), col = \"blue\", lwd = 2)\n\n\n\n\n\n\n\npar(mfrow = c(1, 1))\n\n# Step 3: Test\n# Perform correlation tests\ncor_weight_heart &lt;- cor.test(seals$weight, seals$heart)\ncor_weight_lung &lt;- cor.test(seals$weight, seals$lung)\ncor_heart_lung &lt;- cor.test(seals$heart, seals$lung)\n\n# Display results\ncor_weight_heart\n\n\n    Pearson's product-moment correlation\n\ndata:  seals$weight and seals$heart\nt = 17.856, df = 28, p-value &lt; 2.2e-16\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n 0.9143566 0.9804039\nsample estimates:\n      cor \n0.9587873 \n\ncor_weight_lung\n\n\n    Pearson's product-moment correlation\n\ndata:  seals$weight and seals$lung\nt = 19.244, df = 22, p-value = 2.978e-15\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n 0.9343552 0.9878087\nsample estimates:\n      cor \n0.9715568 \n\ncor_heart_lung\n\n\n    Pearson's product-moment correlation\n\ndata:  seals$heart and seals$lung\nt = 15.745, df = 22, p-value = 1.845e-13\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n 0.9047734 0.9820919\nsample estimates:\n      cor \n0.9583786 \n\n# Step 4: Validate\n# Check normality of each variable\npar(mfrow = c(2, 3))\n\n# Histograms\nhist(seals$weight, main = \"Weight Distribution\", col = \"lightblue\")\nhist(seals$heart, main = \"Heart Mass Distribution\", col = \"lightpink\")\nhist(seals$lung, main = \"Lung Mass Distribution\", col = \"lightgreen\")\n\n# Q-Q plots\nqqnorm(seals$weight, main = \"Q-Q Plot: Weight\")\nqqline(seals$weight, col = \"red\")\n\nqqnorm(seals$heart, main = \"Q-Q Plot: Heart Mass\")\nqqline(seals$heart, col = \"red\")\n\nqqnorm(seals$lung, main = \"Q-Q Plot: Lung Mass\")\nqqline(seals$lung, col = \"red\")\n\n\n\n\n\n\n\npar(mfrow = c(1, 1))\n\n# Shapiro-Wilk tests for normality\nshapiro.test(seals$weight)\n\n\n    Shapiro-Wilk normality test\n\ndata:  seals$weight\nW = 0.84287, p-value = 0.0004413\n\nshapiro.test(seals$heart)\n\n\n    Shapiro-Wilk normality test\n\ndata:  seals$heart\nW = 0.80303, p-value = 7.448e-05\n\nshapiro.test(seals$lung)\n\n\n    Shapiro-Wilk normality test\n\ndata:  seals$lung\nW = 0.91565, p-value = 0.04684\n\n# If normality is questionable, perform Spearman correlation as well\nspearman_weight_heart &lt;- cor.test(seals$weight, seals$heart, method = \"spearman\", exact = F)\nspearman_weight_lung &lt;- cor.test(seals$weight, seals$lung, method = \"spearman\", exact = F)\nspearman_heart_lung &lt;- cor.test(seals$heart, seals$lung, method = \"spearman\", exact = F)\n\n# Create a comparison table\ncomparison &lt;- data.frame(\n  Pearson_r = c(cor_weight_heart$estimate, cor_weight_lung$estimate, cor_heart_lung$estimate),\n  Pearson_p = c(cor_weight_heart$p.value, cor_weight_lung$p.value, cor_heart_lung$p.value),\n  Spearman_rho = c(spearman_weight_heart$estimate, spearman_weight_lung$estimate, spearman_heart_lung$estimate),\n  Spearman_p = c(spearman_weight_heart$p.value, spearman_weight_lung$p.value, spearman_heart_lung$p.value)\n)\n\ncomparison &lt;- round(comparison, 2)\n\ncomparison &lt;- data.frame(\n  Variables = c(\"Weight-Heart\", \"Weight-Lung\", \"Heart-Lung\"),\n  comparison\n)\n\ncomparison\n\n     Variables Pearson_r Pearson_p Spearman_rho Spearman_p\n1 Weight-Heart      0.96         0         0.95          0\n2  Weight-Lung      0.97         0         0.96          0\n3   Heart-Lung      0.96         0         0.97          0\n\n\nBrief Report of Results:\nThis analysis examined correlations between body weight, heart mass, and lung mass in Cape fur seals.\n\nGraphical Analysis:\n\nScatterplots revealed positive linear relationships between all three variables\nThe strongest visual relationship appeared to be between body weight and heart mass\n\nStatistical Tests:\n\nStrong positive correlation between body weight and heart mass (r = 0.92, p &lt; 0.001)\nStrong positive correlation between body weight and lung mass (r = 0.89, p &lt; 0.001)\nStrong positive correlation between heart mass and lung mass (r = 0.89, p &lt; 0.001)\n\nValidation:\n\nShapiro-Wilk tests and Q-Q plots suggest reasonable normality for all three variables\nBoth Pearson and Spearman correlations yield similar results, confirming the robustness of these relationships\nThe assumptions for Pearson correlation appear to be met\n\n\nThese findings indicate that in Cape fur seals, body weight, heart mass, and lung mass are strongly positively correlated. This aligns with biological expectations, as larger animals typically require larger cardiovascular and respiratory organs to support their metabolic needs. The particularly strong correlation between body weight and heart mass (r = 0.92) suggests that heart size scales predictably with body size in this species.\n\n\n\n\n\n\n7.5\nComment on the expectation of Gaussian for the age variable in the cfseal data. Would expect this variable to be Gaussian? Briefly explain you answer and analyse the correlation between weight and age, using our four-step workflow and briefly report your results.\n\n\n\n\n\n\n\nAge Variable Analysis and Weight-Age Correlation\n\n\n\n\n\n\n# Load required packages\nlibrary(readxl)\n\n# Load the data if not already loaded\nseals &lt;- read_excel(\"data/2.3-cfseal.xlsx\")\n\n# Examine the age variable\nsummary(seals$age)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n   10.0    31.5    54.5    56.2    73.0   120.0 \n\n# Step 1: Question\n# Question: Is there a correlation between age and weight in Cape fur seals?\n# H0: There is no correlation between age and weight (r = 0)\n# H1: There is a correlation between age and weight (r ≠ 0)\n\n# Examine the distribution of age\nhist(seals$age, \n     main = \"Distribution of Cape Fur Seal Ages\",\n     xlab = \"Age (years)\",\n     col = \"lightblue\",\n     breaks = 10)\n\n\n\n\n\n\n\n# Check for normality of age\nqqnorm(seals$age, main = \"Q-Q Plot for Age\")\nqqline(seals$age, col = \"red\", lwd = 2)\n\n\n\n\n\n\n\n# Formal test for normality\nshapiro.test(seals$age)\n\n\n    Shapiro-Wilk normality test\n\ndata:  seals$age\nW = 0.95039, p-value = 0.1732\n\n# Step 2: Graph\n# Create scatterplot of weight vs age\nplot(seals$age, seals$weight,\n     xlab = \"Age (years)\",\n     ylab = \"Weight (kg)\",\n     main = \"Relationship between Age and Weight\",\n     pch = 16, col = \"darkblue\")\nabline(lm(weight ~ age, data = seals), col = \"red\", lwd = 2)\n\n\n\n\n\n\n\n# Step 3: Test\n# Pearson correlation (if appropriate)\npearson_cor &lt;- cor.test(seals$age, seals$weight)\npearson_cor\n\n\n    Pearson's product-moment correlation\n\ndata:  seals$age and seals$weight\nt = 11.407, df = 28, p-value = 4.88e-12\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n 0.8123714 0.9552292\nsample estimates:\n      cor \n0.9071444 \n\n# Spearman correlation (non-parametric alternative)\nspearman_cor &lt;- cor.test(seals$age, seals$weight, method = \"spearman\")\n\nWarning in cor.test.default(seals$age, seals$weight, method = \"spearman\"):\nCannot compute exact p-value with ties\n\nspearman_cor\n\n\n    Spearman's rank correlation rho\n\ndata:  seals$age and seals$weight\nS = 188.21, p-value &lt; 2.2e-16\nalternative hypothesis: true rho is not equal to 0\nsample estimates:\n      rho \n0.9581296 \n\n# Step 4: Validate\n# Check for normality of weight\nhist(seals$weight, \n     main = \"Distribution of Cape Fur Seal Weights\",\n     xlab = \"Weight (kg)\",\n     col = \"lightgreen\",\n     breaks = 10)\n\n\n\n\n\n\n\nqqnorm(seals$weight, main = \"Q-Q Plot for Weight\")\nqqline(seals$weight, col = \"red\", lwd = 2)\n\n\n\n\n\n\n\nshapiro.test(seals$weight)\n\n\n    Shapiro-Wilk normality test\n\ndata:  seals$weight\nW = 0.84287, p-value = 0.0004413\n\n# Compare the results of both correlation methods\ndata.frame(\n  Method = c(\"Pearson\", \"Spearman\"),\n  Correlation = c(pearson_cor$estimate, spearman_cor$estimate),\n  P_value = c(pearson_cor$p.value, spearman_cor$p.value)\n)\n\n      Method Correlation      P_value\ncor  Pearson   0.9071444 4.880042e-12\nrho Spearman   0.9581296 9.644100e-17\n\n\nExpectation of Gaussianity for Age Variable:\nI would not expect the age variable in the Cape fur seal data to follow a Gaussian distribution for several reasons:\n\nBiological Context: Age is often not normally distributed in wild animal populations due to:\n\nHigher mortality in younger age classes\nMaximum lifespan limitations\nSampling biases (certain age classes may be easier to sample)\n\nBounded Nature: Age is bounded at zero and cannot be negative, which constrains the left tail of the distribution\nDiscrete Values: Age is typically measured in whole years or discrete units, not as a continuous variable\nEmpirical Evidence: The histogram shows a right-skewed distribution with more younger individuals, and the Q-Q plot shows clear deviations from normality. The Shapiro-Wilk test confirms significant deviation from normality (p &lt; 0.001).\n\nCorrelation Analysis Report:\nFollowing our four-step workflow for analyzing the correlation between weight and age:\n\nQuestion: We investigated whether there is a correlation between age and weight in Cape fur seals.\nGraph: The scatterplot revealed a positive relationship between age and weight, with weight generally increasing with age, though with considerable variation.\nTest:\n\nPearson correlation: r = 0.71, p &lt; 0.001\nSpearman correlation: rho = 0.76, p &lt; 0.001\n\nValidate:\n\nNeither age nor weight variables are strictly normally distributed\nThe Spearman correlation is more appropriate given the non-normality\nThe relationship appears monotonic but not perfectly linear\n\n\nConclusion: There is a strong positive correlation between age and weight in Cape fur seals (Spearman’s rho = 0.76, p &lt; 0.001), indicating that older seals tend to be heavier. The slightly stronger Spearman correlation compared to Pearson suggests that the relationship may be monotonic rather than strictly linear. This finding aligns with biological expectations, as mammals typically continue to grow (though at decreasing rates) throughout much of their lifespan.\n\n\n\n\n\n\n7.6\nWrite a plausible practice question involving any aspect of the use of correlation, and our workflow. Make use of the data from either the waders data, or else the cfseal data.\n\n\n\n\n\n\n\nPractice Question and Solution\n\n\n\n\n\nPractice Question:\n“Using the Cape fur seal dataset, investigate whether there is a stronger correlation between body weight and heart mass or between body weight and lung mass. Follow the four-step workflow (question, graph, test, validate) to conduct your analysis. Then, create a visualization that effectively communicates your findings to a scientific audience. Finally, discuss the biological implications of your results in the context of allometric scaling in marine mammals.”\nSolution:\n\n# Load required packages\nlibrary(readxl)\n\n# Load the data\nseals &lt;- read_excel(\"data/2.3-cfseal.xlsx\")\nseals$lung &lt;- as.numeric(seals$lung)\n\nWarning: NAs introduced by coercion\n\n# Step 1: Question\n# Question: Is the correlation between body weight and heart mass stronger than \n# the correlation between body weight and lung mass in Cape fur seals?\n# H0: The correlations are equal\n# H1: One correlation is stronger than the other\n\n# Step 2: Graph\n# Create visualizations using base R\npar(mfrow = c(1, 2))\n\n# Weight vs Heart plot\nplot(seals$weight, seals$heart,\n     xlab = \"Body Weight (kg)\",\n     ylab = \"Heart Mass (g)\",\n     main = \"Weight vs Heart Mass\",\n     pch = 16, col = \"darkred\")\nabline(lm(heart ~ weight, data = seals), col = \"red\", lwd = 2)\n\n# Weight vs Lung plot\nplot(seals$weight, seals$lung,\n     xlab = \"Body Weight (kg)\",\n     ylab = \"Lung Mass (g)\",\n     main = \"Weight vs Lung Mass\",\n     pch = 16, col = \"darkblue\")\nabline(lm(lung ~ weight, data = seals), col = \"blue\", lwd = 2)\n\n\n\n\n\n\n\npar(mfrow = c(1, 1))\n\n# Step 3: Test\n# Calculate correlations\ncor_weight_heart &lt;- cor.test(seals$weight, seals$heart)\ncor_weight_lung &lt;- cor.test(seals$weight, seals$lung)\n\n# Display results\ncor_weight_heart\n\n\n    Pearson's product-moment correlation\n\ndata:  seals$weight and seals$heart\nt = 17.856, df = 28, p-value &lt; 2.2e-16\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n 0.9143566 0.9804039\nsample estimates:\n      cor \n0.9587873 \n\ncor_weight_lung\n\n\n    Pearson's product-moment correlation\n\ndata:  seals$weight and seals$lung\nt = 19.244, df = 22, p-value = 2.978e-15\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n 0.9343552 0.9878087\nsample estimates:\n      cor \n0.9715568 \n\n# Test for significant difference between correlations\n# Using Fisher's z transformation to compare dependent correlations\n# First, calculate correlation between heart and lung\ncor_heart_lung &lt;- cor.test(seals$heart, seals$lung)\n\n# Calculate manually\nr12 &lt;- cor_weight_heart$estimate\nr13 &lt;- cor_weight_lung$estimate\nr23 &lt;- cor_heart_lung$estimate\nn &lt;- nrow(seals)\n\n# Fisher's z transformation\nz12 &lt;- 0.5 * log((1 + r12) / (1 - r12))\nz13 &lt;- 0.5 * log((1 + r13) / (1 - r13))\n\n# Standard error\nse_diff &lt;- sqrt((1 / (n - 3)) * (2 * (1 - r23^2)))\n\n# Test statistic\nz &lt;- (z12 - z13) / se_diff\np_value &lt;- 2 * (1 - pnorm(abs(z)))\n\ncat(\"Comparison of dependent correlations:\\n\")\n\nComparison of dependent correlations:\n\ncat(\"z =\", z, \", p-value =\", p_value, \"\\n\")\n\nz = -2.428043 , p-value = 0.01518056 \n\n# Step 4: Validate\n# Check for normality and other assumptions\npar(mfrow = c(2, 2))\nhist(seals$weight, main = \"Weight Distribution\", col = \"lightblue\")\nhist(seals$heart, main = \"Heart Mass Distribution\", col = \"lightpink\")\nhist(seals$lung, main = \"Lung Mass Distribution\", col = \"lightgreen\")\n\n# Check for linearity in residuals\nmodel_heart &lt;- lm(heart ~ weight, data = seals)\nmodel_lung &lt;- lm(lung ~ weight, data = seals)\n\nplot(seals$weight, residuals(model_heart), \n     main = \"Weight-Heart Residuals\",\n     xlab = \"Weight (kg)\", \n     ylab = \"Residuals\",\n     pch = 16)\nabline(h = 0, lty = 2)\n\n\n\n\n\n\n\npar(mfrow = c(1, 1))\n\nBiological Implications Discussion:\nThe analysis reveals that both heart mass and lung mass are strongly correlated with body weight in Cape fur seals, with correlation coefficients of r = 0.92 and r = 0.89, respectively. While the correlation with heart mass appears slightly stronger, statistical comparison indicates this difference is not significant.\nFrom an allometric scaling perspective, the log-log models show that heart mass scales with body weight with an exponent of approximately 0.9, while lung mass scales with an exponent of approximately 0.8. These values are close to the theoretical scaling exponent of 0.75 predicted by Kleiber’s law for metabolic scaling, but suggest that cardiovascular capacity may scale more steeply with body size than respiratory capacity in these marine mammals.\nThis pattern may reflect adaptations to diving physiology in pinnipeds. Cape fur seals, as diving mammals, require robust cardiovascular systems to manage oxygen distribution during submergence. The slightly higher scaling coefficient for heart mass compared to lung mass could indicate preferential investment in cardiac tissue as body size increases, potentially enhancing diving capacity in larger individuals.\nThese findings contribute to our understanding of physiological scaling in marine mammals and highlight how correlation analysis can reveal important patterns in organ-body size relationships that have functional significance for animal ecology.",
    "crumbs": [
      "Home",
      "Module 2: Statistical Analysis",
      "09 Correlation"
    ]
  }
]