<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.251">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>R Stats Bootcamp - 9 Correlation</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./img/rstats-logo.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">9 Correlation</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
      <a href="./" class="sidebar-logo-link">
      <img src="./img/rstats-logo.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle sidebar-tool" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Information</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">About</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./schedule.html" class="sidebar-item-text sidebar-link">Schedule</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">Module 1: R</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1-setup.html" class="sidebar-item-text sidebar-link">1 Setup &amp; intro</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2-r-lang.html" class="sidebar-item-text sidebar-link">2 R language</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3-functions.html" class="sidebar-item-text sidebar-link">3 R Functions</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./4-data.html" class="sidebar-item-text sidebar-link">4 Data objects</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./5-data-frames.html" class="sidebar-item-text sidebar-link">5 Data frames</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./6-data-manipulation.html" class="sidebar-item-text sidebar-link">6 Data subsetting</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">Module 2: Stats</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./7-question-explore.html" class="sidebar-item-text sidebar-link">7 Explore data</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./8-sampling-dist.html" class="sidebar-item-text sidebar-link">8 Distributions</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./9-correlation.html" class="sidebar-item-text sidebar-link active">9 Correlation</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-regression.html" class="sidebar-item-text sidebar-link">10 Regression</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-t-test.html" class="sidebar-item-text sidebar-link">11 T-test</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-1-way-anova.html" class="sidebar-item-text sidebar-link">12 ANOVA</a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#statistical-relationships" id="toc-statistical-relationships" class="nav-link active" data-scroll-target="#statistical-relationships">1 Statistical relationships</a>
  <ul class="collapse">
  <li><a href="#objectives" id="toc-objectives" class="nav-link" data-scroll-target="#objectives">1.1 Objectives</a></li>
  </ul></li>
  <li><a href="#the-question-of-correlation" id="toc-the-question-of-correlation" class="nav-link" data-scroll-target="#the-question-of-correlation">2 The question of correlation</a></li>
  <li><a href="#data-and-assumptions" id="toc-data-and-assumptions" class="nav-link" data-scroll-target="#data-and-assumptions">3 Data and assumptions</a>
  <ul class="collapse">
  <li><a href="#pearson-correlation" id="toc-pearson-correlation" class="nav-link" data-scroll-target="#pearson-correlation">3.1 Pearson correlation</a></li>
  </ul></li>
  <li><a href="#graphing" id="toc-graphing" class="nav-link" data-scroll-target="#graphing">4 Graphing</a></li>
  <li><a href="#test-and-alternatives" id="toc-test-and-alternatives" class="nav-link" data-scroll-target="#test-and-alternatives">5 Test and alternatives</a></li>
  <li><a href="#note-about-results-and-reporting" id="toc-note-about-results-and-reporting" class="nav-link" data-scroll-target="#note-about-results-and-reporting">6 Note about results and reporting</a>
  <ul class="collapse">
  <li><a href="#documenting-results-only-for-ourselves-almost-never" id="toc-documenting-results-only-for-ourselves-almost-never" class="nav-link" data-scroll-target="#documenting-results-only-for-ourselves-almost-never">6.1 Documenting results only for ourselves (almost never)</a></li>
  <li><a href="#documenting-results-to-summarize-to-others-most-common" id="toc-documenting-results-to-summarize-to-others-most-common" class="nav-link" data-scroll-target="#documenting-results-to-summarize-to-others-most-common">6.2 Documenting results to summarize to others (most common)</a></li>
  <li><a href="#statistical-summary" id="toc-statistical-summary" class="nav-link" data-scroll-target="#statistical-summary">6.3 Statistical summary</a></li>
  <li><a href="#flash-challenge" id="toc-flash-challenge" class="nav-link" data-scroll-target="#flash-challenge">6.4 Flash challenge</a></li>
  <li><a href="#correlation-alternatives-to-pearsons" id="toc-correlation-alternatives-to-pearsons" class="nav-link" data-scroll-target="#correlation-alternatives-to-pearsons">6.5 Correlation alternatives to Pearson’s</a></li>
  </ul></li>
  <li><a href="#practice-exercises" id="toc-practice-exercises" class="nav-link" data-scroll-target="#practice-exercises">7 Practice exercises</a>
  <ul class="collapse">
  <li><a href="#section" id="toc-section" class="nav-link" data-scroll-target="#section">7.1</a></li>
  <li><a href="#section-1" id="toc-section-1" class="nav-link" data-scroll-target="#section-1">7.2</a></li>
  <li><a href="#section-2" id="toc-section-2" class="nav-link" data-scroll-target="#section-2">7.3</a></li>
  <li><a href="#section-3" id="toc-section-3" class="nav-link" data-scroll-target="#section-3">7.4</a></li>
  <li><a href="#section-4" id="toc-section-4" class="nav-link" data-scroll-target="#section-4">7.5</a></li>
  <li><a href="#section-5" id="toc-section-5" class="nav-link" data-scroll-target="#section-5">7.6</a></li>
  </ul></li>
  <li><a href="#harper-adams-data-science" id="toc-harper-adams-data-science" class="nav-link" data-scroll-target="#harper-adams-data-science">Harper Adams Data Science</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">9 Correlation</h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/murmur.png" class="img-fluid figure-img" width="400"></p>
<p></p><figcaption class="figure-caption">The data were formless like a cloud of tiny birds in the sky</figcaption><p></p>
</figure>
</div>
</center>
<p><br></p>
<section id="statistical-relationships" class="level2">
<h2 class="anchored" data-anchor-id="statistical-relationships">1 Statistical relationships</h2>
<blockquote class="blockquote">
<p>Most of you will have heard the maxim “<strong>correlation does not imply causation</strong>”. Just because two variables have a statistical relationship with each other does not mean that one is responsible for the other. For instance, ice cream sales and forest fires are correlated because both occur more often in the summer heat. But there is no causation; you don’t light a patch of the Montana brush on fire when you buy a pint of Haagan-Dazs. - Nate Silver</p>
</blockquote>
<p>Correlation is used in many applications and is a basic tool in the data science toolbox. We use it to to describe, and sometimes to test, the relationship between two numeric variables, principally to ask whether there is or is not a relationship between the variables (and if there is, whether they tend to vary positively (both tend to increase in value) or negatively (one tends to decrease as the other increases).</p>
<section id="objectives" class="level3">
<h3 class="anchored" data-anchor-id="objectives">1.1 Objectives</h3>
<ul>
<li><p>The question of correlation</p></li>
<li><p>Data and assumptions</p></li>
<li><p>Graphing</p></li>
<li><p>Test and alternatives</p></li>
<li><p>Practice exercises</p></li>
</ul>
<p><br></p>
</section>
</section>
<section id="the-question-of-correlation" class="level2">
<h2 class="anchored" data-anchor-id="the-question-of-correlation">2 The question of correlation</h2>
<p><strong>The question</strong> of correlation is simply whether there is a demonstrable <strong>association</strong> between two numeric variables. For example, we might wonder this for two numeric variables, such as a measure of vegetation biomass and a measure of insect abundance. Digging a little deeper, we are interested in seeing and quantifying whether and how the variables may <strong>“co-vary”</strong> (i.e, exhibit significant covariance). This covariance may be quantified as being either positive or negative and may vary in strength from zero, to perfect positive or negative correlation (+1, or -1). We traditionally visualise correlation with a <strong>scatterplot</strong> (<code>plot()</code> in <code>R</code>). If there is a relationship, the degree of “scatter” is related to strength of the correlation (more scatter = a weaker correlation).</p>
<p>E.g., we can see in the figure below that the two variables tend to increase with each other positively, suggesting a positive correlation.</p>
<p><img src="img/2.3-pos-cor.png" class="img-fluid"></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Try this:</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Flash challenge</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Take the data input below and try to exactly recreate the figure above!</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>veg <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">101.7</span>, <span class="fl">101.2</span>, <span class="fl">97.1</span>, <span class="fl">92.4</span>, <span class="dv">91</span>, <span class="fl">99.4</span>, <span class="fl">104.2</span>, <span class="fl">115.9</span>, <span class="fl">91.9</span>, <span class="fl">101.4</span>, </span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fl">93.5</span>, <span class="fl">87.2</span>, <span class="fl">89.2</span>, <span class="fl">92.8</span>, <span class="fl">103.1</span>, <span class="fl">116.4</span>, <span class="fl">95.2</span>, <span class="fl">80.9</span>, <span class="fl">94.9</span>, <span class="fl">88.8</span>, </span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fl">108.2</span>, <span class="fl">86.1</span>, <span class="fl">104.1</span>, <span class="fl">101.5</span>, <span class="fl">116.9</span>, <span class="fl">109.6</span>, <span class="fl">103.7</span>, <span class="fl">83.9</span>, <span class="fl">85.9</span>, <span class="fl">88.5</span>, </span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fl">98.9</span>, <span class="fl">98.8</span>, <span class="fl">107.8</span>, <span class="fl">86.5</span>, <span class="fl">92.6</span>, <span class="dv">76</span>, <span class="fl">95.2</span>, <span class="fl">105.3</span>, <span class="fl">103.1</span>, <span class="fl">89.3</span>, </span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fl">100.1</span>, <span class="fl">103.1</span>, <span class="fl">87.7</span>, <span class="fl">92.4</span>, <span class="fl">91.5</span>, <span class="fl">105.4</span>, <span class="fl">105.7</span>, <span class="fl">90.5</span>, <span class="fl">105.6</span>, <span class="fl">101.6</span>, </span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fl">97.4</span>, <span class="fl">93.4</span>, <span class="fl">88.7</span>, <span class="fl">81.1</span>, <span class="fl">100.9</span>, <span class="fl">91.6</span>, <span class="fl">102.4</span>, <span class="fl">92.8</span>, <span class="dv">92</span>, <span class="fl">97.1</span>, <span class="fl">91.1</span>, </span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fl">97.3</span>, <span class="dv">104</span>, <span class="dv">99</span>, <span class="fl">101.5</span>, <span class="fl">112.8</span>, <span class="fl">82.4</span>, <span class="fl">84.9</span>, <span class="fl">116.3</span>, <span class="fl">92.2</span>, <span class="fl">106.2</span>, </span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fl">94.2</span>, <span class="fl">89.6</span>, <span class="fl">108.8</span>, <span class="fl">106.2</span>, <span class="dv">91</span>, <span class="fl">95.5</span>, <span class="fl">99.1</span>, <span class="fl">111.6</span>, <span class="fl">124.1</span>, <span class="fl">100.8</span>, </span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fl">117.6</span>, <span class="fl">118.6</span>, <span class="fl">115.8</span>, <span class="fl">102.2</span>, <span class="fl">107.7</span>, <span class="dv">105</span>, <span class="fl">86.7</span>, <span class="dv">99</span>, <span class="fl">101.8</span>, <span class="fl">106.3</span>, </span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fl">100.3</span>, <span class="fl">86.6</span>, <span class="fl">106.4</span>, <span class="fl">92.6</span>, <span class="fl">108.2</span>, <span class="fl">100.5</span>, <span class="fl">100.9</span>, <span class="fl">116.4</span>)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>arth <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1002</span>, <span class="dv">1006</span>, <span class="dv">930</span>, <span class="dv">893</span>, <span class="dv">963</span>, <span class="dv">998</span>, <span class="dv">1071</span>, <span class="dv">1052</span>, <span class="dv">997</span>, <span class="dv">1044</span>, <span class="dv">923</span>, </span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="dv">988</span>, <span class="dv">1022</span>, <span class="dv">975</span>, <span class="dv">1022</span>, <span class="dv">1050</span>, <span class="dv">929</span>, <span class="dv">928</span>, <span class="dv">1019</span>, <span class="dv">957</span>, <span class="dv">1054</span>, <span class="dv">850</span>, <span class="dv">1084</span>, </span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="dv">995</span>, <span class="dv">1065</span>, <span class="dv">1039</span>, <span class="dv">1009</span>, <span class="dv">945</span>, <span class="dv">995</span>, <span class="dv">967</span>, <span class="dv">916</span>, <span class="dv">998</span>, <span class="dv">988</span>, <span class="dv">956</span>, <span class="dv">975</span>, </span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="dv">910</span>, <span class="dv">954</span>, <span class="dv">1044</span>, <span class="dv">1063</span>, <span class="dv">948</span>, <span class="dv">966</span>, <span class="dv">1037</span>, <span class="dv">976</span>, <span class="dv">979</span>, <span class="dv">969</span>, <span class="dv">1009</span>, <span class="dv">1076</span>, </span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="dv">943</span>, <span class="dv">1024</span>, <span class="dv">1071</span>, <span class="dv">969</span>, <span class="dv">963</span>, <span class="dv">1020</span>, <span class="dv">936</span>, <span class="dv">1004</span>, <span class="dv">961</span>, <span class="dv">1089</span>, <span class="dv">953</span>, <span class="dv">1037</span>, </span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="dv">962</span>, <span class="dv">977</span>, <span class="dv">958</span>, <span class="dv">944</span>, <span class="dv">933</span>, <span class="dv">970</span>, <span class="dv">1036</span>, <span class="dv">960</span>, <span class="dv">912</span>, <span class="dv">978</span>, <span class="dv">967</span>, <span class="dv">1035</span>, </span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="dv">959</span>, <span class="dv">831</span>, <span class="dv">1016</span>, <span class="dv">901</span>, <span class="dv">1010</span>, <span class="dv">1072</span>, <span class="dv">1019</span>, <span class="dv">996</span>, <span class="dv">1122</span>, <span class="dv">1029</span>, <span class="dv">1047</span>, </span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="dv">1132</span>, <span class="dv">996</span>, <span class="dv">979</span>, <span class="dv">994</span>, <span class="dv">970</span>, <span class="dv">976</span>, <span class="dv">997</span>, <span class="dv">950</span>, <span class="dv">1002</span>, <span class="dv">1003</span>, <span class="dv">982</span>, <span class="dv">1071</span>, </span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="dv">959</span>, <span class="dv">976</span>, <span class="dv">1011</span>, <span class="dv">1032</span>, <span class="dv">1024</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><br></p>
</section>
<section id="data-and-assumptions" class="level2">
<h2 class="anchored" data-anchor-id="data-and-assumptions">3 Data and assumptions</h2>
<section id="pearson-correlation" class="level3">
<h3 class="anchored" data-anchor-id="pearson-correlation">3.1 Pearson correlation</h3>
<p>“Traditional correlation” is sometimes referred to as the <a href="https://en.wikipedia.org/wiki/Pearson_correlation_coefficient">Pearson correlation</a>. The data and assumptions are important for the Pearson correlation - we use this when there is a linear relationship between our variables of interest, and the numeric values are Gaussian distributed.</p>
<p>More technically, the Pearson correlation coefficient is the <strong>covariance</strong> of two variables, divided by the product of their standard deviations:</p>
<p><br></p>
<p><img src="img/2.3-r.png" class="img-fluid">{width = “500px”}</p>
<p><br></p>
<p>The correlation coefficient can be calculated in <code>R</code> using the <code>cor()</code> function.</p>
<p><br></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Try this:</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># use veg and arth from above</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># r the "hard way"</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co"># r &lt;- ((covariance of x,y) / (std dev x * std dev y) )</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co"># sample covariance (hard way)</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>(cov_veg_arth <span class="ot">&lt;-</span> <span class="fu">sum</span>( (veg<span class="sc">-</span><span class="fu">mean</span>(veg))<span class="sc">*</span>(arth<span class="sc">-</span><span class="fu">mean</span>(arth))) <span class="sc">/</span> (<span class="fu">length</span>(veg) <span class="sc">-</span> <span class="dv">1</span> ))</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="fu">cov</span>(veg,arth) <span class="co"># easy way</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="co"># r the "hard way"</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>(r_arth_veg <span class="ot">&lt;-</span> cov_veg_arth <span class="sc">/</span> (<span class="fu">sd</span>(veg) <span class="sc">*</span> <span class="fu">sd</span>(arth)))</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="co"># r the easy way</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="fu">help</span>(cor)</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(<span class="at">x =</span> veg, <span class="at">y =</span> arth,</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"pearson"</span>) <span class="co"># NB "pearson" is the default method if unspecified</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><br></p>
</section>
</section>
<section id="graphing" class="level2">
<h2 class="anchored" data-anchor-id="graphing">4 Graphing</h2>
<p>We can look at a range of different correlation magnitudes, to think about diagnosing correlation.</p>
<p><img src="img/2.3-diff-r.png" class="img-fluid"></p>
<p><br></p>
<p>If we really care and value making a correlation between two specific variables, traditionally we would use the scatterplot like above with the <code>veg</code> and <code>arth</code> data, and the calculation of the correlation coefficient (using <code>plot()</code> and <code>cor()</code> respectively).</p>
<p>On the other hand, we might have loads of variables and just want to quickly assess the degree of correlation and intercorrelation. To do this we might just make and print a matric of the correlation plot (using <code>pairs()</code>) and the correlation matrix (again using <code>cor()</code>)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Correlation matrices ####</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Try this:</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the iris data to look at correlation matrix </span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># of flower measures</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(iris)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(iris)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Sepal.Length" "Sepal.Width"  "Petal.Length" "Petal.Width"  "Species"     </code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(iris[ , <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]) <span class="co"># all rows, just the numeric columns</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Sepal.Length Sepal.Width Petal.Length Petal.Width
Sepal.Length    1.0000000  -0.1175698    0.8717538   0.8179411
Sepal.Width    -0.1175698   1.0000000   -0.4284401  -0.3661259
Petal.Length    0.8717538  -0.4284401    1.0000000   0.9628654
Petal.Width     0.8179411  -0.3661259    0.9628654   1.0000000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fix the decimal output</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">cor</span>(iris[ , <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]), <span class="dv">2</span>) <span class="co"># nicer</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Sepal.Length Sepal.Width Petal.Length Petal.Width
Sepal.Length         1.00       -0.12         0.87        0.82
Sepal.Width         -0.12        1.00        -0.43       -0.37
Petal.Length         0.87       -0.43         1.00        0.96
Petal.Width          0.82       -0.37         0.96        1.00</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pairs plot</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(iris[ , <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>], <span class="at">pch =</span> <span class="dv">16</span>, </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> iris<span class="sc">$</span>Species) <span class="co"># Set color to species...</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="9-correlation_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Correlation table</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">cor</span>(iris[ , <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]), <span class="dv">2</span>) <span class="co"># nicer output</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Sepal.Length Sepal.Width Petal.Length Petal.Width
Sepal.Length         1.00       -0.12         0.87        0.82
Sepal.Width         -0.12        1.00        -0.43       -0.37
Petal.Length         0.87       -0.43         1.00        0.96
Petal.Width          0.82       -0.37         0.96        1.00</code></pre>
</div>
</div>
<p><br></p>
<p>In this case, we can see that the correlation of plant parts is very strongly influenced by species! For further exploration we would definitely want to explore and address that, thus here we have shown how powerful the combination of statistical summary and graphing can be.</p>
<p><br></p>
</section>
<section id="test-and-alternatives" class="level2">
<h2 class="anchored" data-anchor-id="test-and-alternatives">5 Test and alternatives</h2>
<p>We may want to perform a statistical test to determine whether a correlation coefficient is “significantly” different to zero, using Null Hypothesis Significance Testing. There are a lot of options, but a simple solution is to use the <code>cor.test()</code> function.</p>
<p>An alternative to the <strong>Pearson correlation</strong> (the traditional correlation, assuming the variables in question are Gaussian), is the <strong>Spearman rank correlation</strong>, which can be used when the assumptions for the Pearson correlation are not met. We will briefly perform both tests.</p>
<p><a href="http://www.biostathandbook.com/linearregression.html">See here for further information on Pearson correlation</a></p>
<p><a href="http://www.biostathandbook.com/spearman.html">See here for further information on Spearman rank correlation</a></p>
<p><br></p>
<p>Briefly, the principle assumptions of the Pearson correlation are:</p>
<ul>
<li><p>The relationship between the variables is linear (i.e., not a curved relationship)</p></li>
<li><p>The variables exhibit a bivariate Gaussian distribution (in practice, it is often accepted that each variable is Gaussian)</p></li>
<li><p>Homoscedasticity (i.e., the variance is similar across the range of the variables)</p></li>
<li><p>Observations are independent</p></li>
<li><p>Absence of outliers</p></li>
</ul>
<p><br></p>
<p><a href="https://statistics.laerd.com/statistical-guides/pearson-correlation-coefficient-statistical-guide.php">Discussion of assumptions</a></p>
<p><a href="https://rafalab.github.io/dsbook/association-is-not-causation.html">Further practical information about correlation</a></p>
<p><br></p>
<p>Let’s try a statistical test of correlation. We need to keep in mind an order of operation for statistical analysis, e.g.:</p>
<p>1 Question</p>
<p>2 Graph</p>
<p>3 Test</p>
<p>4 Validate (e.g.&nbsp;test assumptions)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Correlation test ####</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Try this:</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 1 Question: whether Petal length and width are correlated?</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co"># (i.e. is there evidence the correlation coefficient different to zero)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2 Graph</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(iris<span class="sc">$</span>Petal.Width, iris<span class="sc">$</span>Petal.Length,</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Petal width"</span>,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Petal length"</span>,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> iris<span class="sc">$</span>Species, <span class="at">pch =</span> <span class="dv">16</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="9-correlation_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 3 Test</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(iris<span class="sc">$</span>Petal.Width, iris<span class="sc">$</span>Petal.Length)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  iris$Petal.Width and iris$Petal.Length
t = 43.387, df = 148, p-value &lt; 2.2e-16
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.9490525 0.9729853
sample estimates:
      cor 
0.9628654 </code></pre>
</div>
</div>
<p><br></p>
</section>
<section id="note-about-results-and-reporting" class="level2">
<h2 class="anchored" data-anchor-id="note-about-results-and-reporting">6 Note about results and reporting</h2>
<p>When we do report or document the results of an analysis we may do it in different ways depending on the intended audience.</p>
<p><br></p>
<section id="documenting-results-only-for-ourselves-almost-never" class="level3">
<h3 class="anchored" data-anchor-id="documenting-results-only-for-ourselves-almost-never">6.1 Documenting results only for ourselves (almost never)</h3>
<p>It would be typical to just comment the <code>R</code> script and have your script and data file in fully reproducible format. This format would also work for close colleague (who also use <code>R</code>), or collaborators, to use to share or develop the analysis. Even in this format, care should be taken to</p>
<ul>
<li><p><em>clean up</em> redundant or unnecessary code</p></li>
<li><p>to organize the script as much as possible in a logical way, e.g.&nbsp;by pairing graphs with relevant analysis outputs</p></li>
<li><p>removing analyses that were tried but obsolete (e.g.&nbsp;because a better analysis was found)</p></li>
</ul>
<p><br></p>
</section>
<section id="documenting-results-to-summarize-to-others-most-common" class="level3">
<h3 class="anchored" data-anchor-id="documenting-results-to-summarize-to-others-most-common">6.2 Documenting results to summarize to others (most common)</h3>
<p>Here it would be typical to summarize and format output results and figures in a way that is most easy to consume for the intended audience.</p>
<blockquote class="blockquote">
<p>You should NEVER PRESENT RAW COPIED AND PASTED STATISTICAL RESULTS (O.M.G.!).</p>
</blockquote>
<blockquote class="blockquote">
<p>- Ed Harris</p>
</blockquote>
<p>A good way to do this would be to use <code>R</code> Markdown to format your script to produce an attractive summary, in html, MS Word, or pdf formats (amongst others).</p>
<p>Second best (primarily because it is more work and harder to edit or update) would be to format results in word processed document (like pdf, Word, etc.). This is the way most scientists tend to work.</p>
<p><br></p>
</section>
<section id="statistical-summary" class="level3">
<h3 class="anchored" data-anchor-id="statistical-summary">6.3 Statistical summary</h3>
<p>Most statistical tests under NHST will have exactly three quantities reported for each test:</p>
<ul>
<li><p>the test statistic (different for each test, <code>r</code> (“little ‘r’”) for the Pearson correlation)</p></li>
<li><p>the sample size or degrees of freedom</p></li>
<li><p>the p-value.</p></li>
</ul>
<p><br></p>
<p>For our results above, it might be something like:</p>
<blockquote class="blockquote">
<p>We found a significant correlation between petal width and length (Pearson’s r = 0.96, df = 148, P &lt; 0.0001)</p>
</blockquote>
<p><br></p>
<p>NB:</p>
<ul>
<li><p>the rounding of decimal accuracy (usually 2 decimals accuracy, if not be consistent)</p></li>
<li><p>the formatting of the p-value (if smaller than 0.0001 ALWAYS use P &lt; 0.0001; also never report the P value in scientific notation).</p></li>
</ul>
<p><br></p>
<p>The 95% confidence interval of the estimate of <code>r</code> is also produced (remember, we are making an inference on the greater population from which our sample was drawn), and we might also report that in our descriptive summary of results, if it is deemed important.</p>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 4 Validate</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(iris<span class="sc">$</span>Petal.Length) <span class="co"># Ummm..</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="9-correlation_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(iris<span class="sc">$</span>Petal.Width) <span class="co"># Yuck</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="9-correlation_files/figure-html/unnamed-chunk-6-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We violate the assumption of Gaussian</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ... Relatedly, we also violate the assumption of independence </span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co"># due to similarities within and differences between species!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br></p>
</section>
<section id="flash-challenge" class="level3">
<h3 class="anchored" data-anchor-id="flash-challenge">6.4 Flash challenge</h3>
<p>Write a script following the steps to question, graph, test, and validate for each iris species separately. Do these test validate? How does the estimate of correlation compare amongst the species?</p>
<p><br></p>
</section>
<section id="correlation-alternatives-to-pearsons" class="level3">
<h3 class="anchored" data-anchor-id="correlation-alternatives-to-pearsons">6.5 Correlation alternatives to Pearson’s</h3>
<p>There are several alternative correlation estimate frameworks to the Pearson’s; we will briefly look at the application of the Spearman correlation. The main difference is a relaxation of assumptions. Here the main assumptions are that:</p>
<ul>
<li><p>The data are ranked or otherwise ordered</p></li>
<li><p>The data rows are independent</p></li>
</ul>
<p><br></p>
<p>Hence, the Spearman rank correlation descriptive coefficient and test are appropriate even if the data are not “bivariate” Gaussian (this just means both variables are Gaussian) or if the data are not strictly linear in their relationship.</p>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Spearman rank correlation ####</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Try this:</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>height <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">18.4</span>, <span class="fl">3.2</span>, <span class="fl">6.4</span>, <span class="fl">3.6</span>, <span class="fl">13.2</span>, <span class="fl">3.6</span>, <span class="dv">15</span>, <span class="fl">5.9</span>, <span class="fl">13.5</span>, <span class="fl">10.8</span>, <span class="fl">9.7</span>, <span class="fl">10.9</span>, </span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="fl">18.8</span>, <span class="fl">11.6</span>, <span class="fl">9.8</span>, <span class="fl">14.4</span>, <span class="fl">19.6</span>, <span class="fl">14.7</span>, <span class="dv">10</span>, <span class="fl">16.8</span>, <span class="fl">18.2</span>, <span class="fl">16.9</span>, <span class="fl">19.8</span>, </span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="fl">18.2</span>, <span class="fl">2.6</span>, <span class="fl">18.8</span>, <span class="fl">8.4</span>, <span class="fl">18.9</span>, <span class="fl">9.5</span>, <span class="dv">19</span>)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>vol <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">16.7</span>, <span class="fl">17.8</span>, <span class="fl">17.9</span>, <span class="fl">21.1</span>, <span class="fl">21.2</span>, <span class="fl">21.4</span>, <span class="fl">23.2</span>, <span class="fl">25.7</span>, <span class="fl">26.1</span>, <span class="fl">26.4</span>, </span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="fl">26.8</span>, <span class="dv">27</span>, <span class="fl">27.8</span>, <span class="fl">28.2</span>, <span class="fl">28.5</span>, <span class="fl">28.6</span>, <span class="fl">28.7</span>, <span class="fl">29.1</span>, <span class="fl">30.2</span>, <span class="dv">31</span>, <span class="fl">32.3</span>, </span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="fl">32.3</span>, <span class="fl">32.5</span>, <span class="fl">33.2</span>, <span class="fl">33.5</span>, <span class="fl">33.8</span>, <span class="fl">35.2</span>, <span class="fl">36.1</span>, <span class="fl">36.6</span>, <span class="fl">39.5</span>)</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(height, vol,</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Height"</span>,</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Volume"</span>,</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">cex =</span> .<span class="dv">7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="9-correlation_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Spearman coefficient</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(height, vol, <span class="at">method =</span> <span class="st">"spearman"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3945026</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Spearman test</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(height, vol, <span class="at">method =</span> <span class="st">"spearman"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in cor.test.default(height, vol, method = "spearman"): Cannot compute
exact p-value with ties</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Spearman's rank correlation rho

data:  height and vol
S = 2721.7, p-value = 0.03098
alternative hypothesis: true rho is not equal to 0
sample estimates:
      rho 
0.3945026 </code></pre>
</div>
</div>
<p><br></p>
<p>NB the correlation coefficient for the Spearman rank correlation is notated as “<code>rho</code>” (the Greek letter <span class="math inline">\(\rho\)</span> - sometimes avoided by non-math folks because it looks like the letter “p”), reported and interpreted exactly like the Pearson correlation coefficient, <code>r</code>.</p>
<p><br></p>
</section>
</section>
<section id="practice-exercises" class="level2">
<h2 class="anchored" data-anchor-id="practice-exercises">7 Practice exercises</h2>
<p>For the following exercises, use 2 datasets: the <code>waders</code> data from the package {<code>MASS</code>}, and the <a href="data/2.3-cfseal.xlsx">cape furs dataset <code>cfseals</code> you can download here</a></p>
<p><br></p>
<section id="section" class="level3">
<h3 class="anchored" data-anchor-id="section">7.1</h3>
<p>Load the <code>waders</code> data and read the help page. Use the pairs function on the data and make a statement about the overall degree of intercorrelation between variables based on the graphical output.</p>
<p><br></p>
</section>
<section id="section-1" class="level3">
<h3 class="anchored" data-anchor-id="section-1">7.2</h3>
<p>Think about the variables and data themselves in <code>waders</code>. Do you expect the data to be Gaussian? Formulate hypothesis statements for correlations amongst the first 3 columns of bird species in the dataset. Show the code to make three good graphs (i.e., one for each pairwise comparison for the first three columns), and perform the three correlation tests.</p>
<p><br></p>
</section>
<section id="section-2" class="level3">
<h3 class="anchored" data-anchor-id="section-2">7.3</h3>
<p>Validate the test performed in question 2. Which form of correlation was performed, and why. Show the code for any diagnostic tests performed, and any adjustment to the analysis required. Formally report the results of your validated results.</p>
<p><br></p>
</section>
<section id="section-3" class="level3">
<h3 class="anchored" data-anchor-id="section-3">7.4</h3>
<p>Load the <code>2.3-cfseal.xlsx</code> data and examine the information in the data dictionary. Analyse the correlations amongst the <code>weight</code>, <code>heart</code>, and <code>lung</code> variables, utilizing the 1 question, 2 graph, 3 test and 4 validate workflow. Show your code and briefly report the results.</p>
<p><br></p>
</section>
<section id="section-4" class="level3">
<h3 class="anchored" data-anchor-id="section-4">7.5</h3>
<p>Comment on the expectation of Gaussian for the <code>age</code> variable in the <code>cfseal</code> data. Would expect this variable to be Gaussian? Briefly explain you answer and analyse the correlation between <code>weight</code> and <code>age</code>, using our four-step workflow and briefly report your results.</p>
<p><br></p>
</section>
<section id="section-5" class="level3">
<h3 class="anchored" data-anchor-id="section-5">7.6</h3>
<p>Write a plausible practice question involving any aspect of the use of correlation, and our workflow. Make use of the data from either the <code>waders</code> data, or else the <code>cfseal</code> data.</p>
<p><br></p>
</section>
</section>
<section id="harper-adams-data-science" class="level2">
<h2 class="anchored" data-anchor-id="harper-adams-data-science">Harper Adams Data Science</h2>
<p><img src="img/HDS.png" class="img-fluid" alt="Harper Data Science" width="125"></p>
<p>This website supports students and staff at <a href="https://www.harper-adams.ac.uk/" title="Harper Adams University">Harper Adams University</a> and the <a href="https://www.harper-adams.ac.uk/courses/postgraduate/201194/data-science-for-global-agriculture-food-and-environment" title="MSc in Data Science">MSc in Data Science for Global Agriculture, Food, and Environment</a> led by <a href="https://www.harper-adams.ac.uk/general/staff/profile/201620/Edwin-Harris/" title="Ed's Faculty page">Ed Harris</a>.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } 
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>