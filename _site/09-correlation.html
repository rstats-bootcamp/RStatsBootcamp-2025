<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.30">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>09 Correlation – R Stats Bootcamp</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./img/rstats-logo.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dee922831e13d8617d658465dd4567ee.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-927edb3cde42616945691bbf0360b549.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dee922831e13d8617d658465dd4567ee.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-ec3125e1e7a9c380590c6781d1052461.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-4848551f56e22cb80adcac86ad2b91da.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="site_libs/bootstrap/bootstrap-ec3125e1e7a9c380590c6781d1052461.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script><link rel="stylesheet" href="styles.css">
<meta property="og:title" content="09 Correlation – R Stats Bootcamp">
<meta property="og:description" content="">
<meta property="og:image" content="https://rstatsbootcamp.com/img/murmur.png">
<meta property="og:site_name" content="R Stats Bootcamp">
<meta property="og:image:height" content="173">
<meta property="og:image:width" content="260">
<meta name="twitter:title" content="09 Correlation – R Stats Bootcamp">
<meta name="twitter:description" content="">
<meta name="twitter:image" content="https://rstatsbootcamp.com/img/murmur.png">
<meta name="twitter:image-height" content="173">
<meta name="twitter:image-width" content="260">
<meta name="twitter:card" content="summary_large_image">
</head>
<body class="nav-sidebar docked nav-fixed quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg " data-bs-theme="dark"><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    <img src="./img/rstats-logo.png" alt="" class="navbar-logo"></a>
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">R Stats Bootcamp</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item">
    <a class="nav-link active" href="./index.html" aria-current="page"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./schedule.html"> 
<span class="menu-text">Schedule</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
</div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./07-question-explore.html">Module 2: Statistical Analysis</a></li><li class="breadcrumb-item"><a href="./09-correlation.html">09 Correlation</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto"><div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Getting Started</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R Stats Bootcamp</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./schedule.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Course Schedule</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./about.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About the Bootcamp</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Module 1: R Foundations</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-setup.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">01 Setup &amp; intro</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-r-lang.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">02 R language</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">03 R Functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">04 Data objects</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-data-frames.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">05 Data frames</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-data-manipulation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">06 Data subsetting</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Module 2: Statistical Analysis</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-question-explore.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">07 Explore data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-sampling-dist.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">08 Distributions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-correlation.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">09 Correlation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">10 Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-t-test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">11 T-test</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-1-way-anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">12 ANOVA</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Module 3: Reproducible Research</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-reproducibility.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">13 Reproducibility</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14-rmarkdown.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">14 R Markdown</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15-github-basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">15 Git and GitHub</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16-collaborative-workflows.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">16 Collaboration</span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li><a href="#statistical-relationships" id="toc-statistical-relationships" class="nav-link active" data-scroll-target="#statistical-relationships">1 Statistical relationships</a></li>
  <li><a href="#the-question-of-correlation" id="toc-the-question-of-correlation" class="nav-link" data-scroll-target="#the-question-of-correlation">2 The question of correlation</a></li>
  <li>
<a href="#data-and-assumptions" id="toc-data-and-assumptions" class="nav-link" data-scroll-target="#data-and-assumptions">3 Data and assumptions</a>
  <ul class="collapse">
<li><a href="#pearson-correlation" id="toc-pearson-correlation" class="nav-link" data-scroll-target="#pearson-correlation">3.1 Pearson correlation</a></li>
  </ul>
</li>
  <li><a href="#graphing" id="toc-graphing" class="nav-link" data-scroll-target="#graphing">4 Graphing</a></li>
  <li><a href="#test-and-alternatives" id="toc-test-and-alternatives" class="nav-link" data-scroll-target="#test-and-alternatives">5 Test and alternatives</a></li>
  <li>
<a href="#note-about-results-and-reporting" id="toc-note-about-results-and-reporting" class="nav-link" data-scroll-target="#note-about-results-and-reporting">6 Note about results and reporting</a>
  <ul class="collapse">
<li><a href="#documenting-results-only-for-ourselves-almost-never" id="toc-documenting-results-only-for-ourselves-almost-never" class="nav-link" data-scroll-target="#documenting-results-only-for-ourselves-almost-never">6.1 Documenting results only for ourselves (almost never)</a></li>
  <li><a href="#documenting-results-to-summarize-to-others-most-common" id="toc-documenting-results-to-summarize-to-others-most-common" class="nav-link" data-scroll-target="#documenting-results-to-summarize-to-others-most-common">6.2 Documenting results to summarize to others (most common)</a></li>
  <li><a href="#statistical-summary" id="toc-statistical-summary" class="nav-link" data-scroll-target="#statistical-summary">6.3 Statistical summary</a></li>
  <li><a href="#flash-challenge" id="toc-flash-challenge" class="nav-link" data-scroll-target="#flash-challenge">6.4 Flash challenge</a></li>
  <li><a href="#correlation-alternatives-to-pearsons" id="toc-correlation-alternatives-to-pearsons" class="nav-link" data-scroll-target="#correlation-alternatives-to-pearsons">6.5 Correlation alternatives to Pearson’s</a></li>
  </ul>
</li>
  <li>
<a href="#practice-exercises" id="toc-practice-exercises" class="nav-link" data-scroll-target="#practice-exercises">7 Practice exercises</a>
  <ul class="collapse">
<li><a href="#exploring-the-waders-dataset" id="toc-exploring-the-waders-dataset" class="nav-link" data-scroll-target="#exploring-the-waders-dataset">7.1 Exploring the <code>waders</code> dataset</a></li>
  <li><a href="#visualizing-the-relationship-between-weight-and-heart-mass" id="toc-visualizing-the-relationship-between-weight-and-heart-mass" class="nav-link" data-scroll-target="#visualizing-the-relationship-between-weight-and-heart-mass">7.2 Visualizing the Relationship Between Weight and Heart Mass</a></li>
  <li><a href="#calculating-the-correlation-coefficient" id="toc-calculating-the-correlation-coefficient" class="nav-link" data-scroll-target="#calculating-the-correlation-coefficient">7.3 Calculating the Correlation Coefficient</a></li>
  <li><a href="#testing-the-correlation" id="toc-testing-the-correlation" class="nav-link" data-scroll-target="#testing-the-correlation">7.4 Testing the Correlation</a></li>
  <li><a href="#age-variable-analysis-and-weight-age-correlation" id="toc-age-variable-analysis-and-weight-age-correlation" class="nav-link" data-scroll-target="#age-variable-analysis-and-weight-age-correlation">7.5 Age Variable Analysis and Weight-Age Correlation</a></li>
  <li><a href="#create-your-own-correlation-question" id="toc-create-your-own-correlation-question" class="nav-link" data-scroll-target="#create-your-own-correlation-question">7.6 Create Your Own Correlation Question</a></li>
  </ul>
</li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./07-question-explore.html">Module 2: Statistical Analysis</a></li><li class="breadcrumb-item"><a href="./09-correlation.html">09 Correlation</a></li></ol></nav><div class="quarto-title">
<h1 class="title">09 Correlation</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="img/murmur.png" class="img-fluid figure-img" width="400"></p>
<figcaption>The data were formless like a cloud of tiny birds in the sky</figcaption></figure>
</div>
</center>
<section id="statistical-relationships" class="level2"><h2 class="anchored" data-anchor-id="statistical-relationships">1 Statistical relationships</h2>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Learning Objectives
</div>
</div>
<div class="callout-body-container callout-body">
<p>By the end of this lesson, you will be able to:</p>
<ul>
<li>Analyze correlation between two variables</li>
<li>Evaluate correlation data and assumptions</li>
<li>Graph correlated variables</li>
<li>Perform correlation statistical test and alternatives</li>
</ul>
</div>
</div>
<blockquote class="blockquote">
<p>Most of you will have heard the maxim “<strong>correlation does not imply causation</strong>”. Just because two variables have a statistical relationship with each other does not mean that one is responsible for the other. For instance, ice cream sales and forest fires are correlated because both occur more often in the summer heat. But there is no causation; you don’t light a patch of the Montana brush on fire when you buy a pint of Haagan-Dazs. - Nate Silver</p>
</blockquote>
<p>Correlation is used in many applications and is a basic tool in the data science toolbox. We use it to to describe, and sometimes to test, the relationship between two numeric variables, principally to ask whether there is or is not a relationship between the variables (and if there is, whether they tend to vary positively (both tend to increase in value) or negatively (one tends to decrease as the other increases).</p>
<p><br></p>
</section><section id="the-question-of-correlation" class="level2"><h2 class="anchored" data-anchor-id="the-question-of-correlation">2 The question of correlation</h2>
<p><strong>The question</strong> of correlation is simply whether there is a demonstrable <strong>association</strong> between two numeric variables. For example, we might wonder this for two numeric variables, such as a measure of vegetation biomass and a measure of insect abundance. Digging a little deeper, we are interested in seeing and quantifying whether and how the variables may <strong>“co-vary”</strong> (i.e, exhibit significant covariance). This covariance may be quantified as being either positive or negative and may vary in strength from zero, to perfect positive or negative correlation (+1, or -1). We traditionally visualise correlation with a <strong>scatterplot</strong> (<code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code> in <code>R</code>). If there is a relationship, the degree of “scatter” is related to strength of the correlation (more scatter = a weaker correlation).</p>
<p>E.g., we can see in the figure below that the two variables tend to increase with each other, suggesting a positive correlation.</p>
<p><img src="img/2.3-pos-cor.png" class="img-fluid"></p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Try this:</span></span>
<span></span>
<span><span class="co"># Flash challenge</span></span>
<span><span class="co"># Take the data input below and try to exactly recreate the figure above!</span></span>
<span></span>
<span><span class="va">veg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">101.7</span>, <span class="fl">101.2</span>, <span class="fl">97.1</span>, <span class="fl">92.4</span>, <span class="fl">91</span>, <span class="fl">99.4</span>, <span class="fl">104.2</span>, <span class="fl">115.9</span>, <span class="fl">91.9</span>, <span class="fl">101.4</span>, </span>
<span><span class="fl">93.5</span>, <span class="fl">87.2</span>, <span class="fl">89.2</span>, <span class="fl">92.8</span>, <span class="fl">103.1</span>, <span class="fl">116.4</span>, <span class="fl">95.2</span>, <span class="fl">80.9</span>, <span class="fl">94.9</span>, <span class="fl">88.8</span>, </span>
<span><span class="fl">108.2</span>, <span class="fl">86.1</span>, <span class="fl">104.1</span>, <span class="fl">101.5</span>, <span class="fl">116.9</span>, <span class="fl">109.6</span>, <span class="fl">103.7</span>, <span class="fl">83.9</span>, <span class="fl">85.9</span>, <span class="fl">88.5</span>, </span>
<span><span class="fl">98.9</span>, <span class="fl">98.8</span>, <span class="fl">107.8</span>, <span class="fl">86.5</span>, <span class="fl">92.6</span>, <span class="fl">76</span>, <span class="fl">95.2</span>, <span class="fl">105.3</span>, <span class="fl">103.1</span>, <span class="fl">89.3</span>, </span>
<span><span class="fl">100.1</span>, <span class="fl">103.1</span>, <span class="fl">87.7</span>, <span class="fl">92.4</span>, <span class="fl">91.5</span>, <span class="fl">105.4</span>, <span class="fl">105.7</span>, <span class="fl">90.5</span>, <span class="fl">105.6</span>, <span class="fl">101.6</span>, </span>
<span><span class="fl">97.4</span>, <span class="fl">93.4</span>, <span class="fl">88.7</span>, <span class="fl">81.1</span>, <span class="fl">100.9</span>, <span class="fl">91.6</span>, <span class="fl">102.4</span>, <span class="fl">92.8</span>, <span class="fl">92</span>, <span class="fl">97.1</span>, <span class="fl">91.1</span>, </span>
<span><span class="fl">97.3</span>, <span class="fl">104</span>, <span class="fl">99</span>, <span class="fl">101.5</span>, <span class="fl">112.8</span>, <span class="fl">82.4</span>, <span class="fl">84.9</span>, <span class="fl">116.3</span>, <span class="fl">92.2</span>, <span class="fl">106.2</span>, </span>
<span><span class="fl">94.2</span>, <span class="fl">89.6</span>, <span class="fl">108.8</span>, <span class="fl">106.2</span>, <span class="fl">91</span>, <span class="fl">95.5</span>, <span class="fl">99.1</span>, <span class="fl">111.6</span>, <span class="fl">124.1</span>, <span class="fl">100.8</span>, </span>
<span><span class="fl">117.6</span>, <span class="fl">118.6</span>, <span class="fl">115.8</span>, <span class="fl">102.2</span>, <span class="fl">107.7</span>, <span class="fl">105</span>, <span class="fl">86.7</span>, <span class="fl">99</span>, <span class="fl">101.8</span>, <span class="fl">106.3</span>, </span>
<span><span class="fl">100.3</span>, <span class="fl">86.6</span>, <span class="fl">106.4</span>, <span class="fl">92.6</span>, <span class="fl">108.2</span>, <span class="fl">100.5</span>, <span class="fl">100.9</span>, <span class="fl">116.4</span><span class="op">)</span></span>
<span></span>
<span><span class="va">arth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1002</span>, <span class="fl">1006</span>, <span class="fl">930</span>, <span class="fl">893</span>, <span class="fl">963</span>, <span class="fl">998</span>, <span class="fl">1071</span>, <span class="fl">1052</span>, <span class="fl">997</span>, <span class="fl">1044</span>, <span class="fl">923</span>, </span>
<span><span class="fl">988</span>, <span class="fl">1022</span>, <span class="fl">975</span>, <span class="fl">1022</span>, <span class="fl">1050</span>, <span class="fl">929</span>, <span class="fl">928</span>, <span class="fl">1019</span>, <span class="fl">957</span>, <span class="fl">1054</span>, <span class="fl">850</span>, <span class="fl">1084</span>, </span>
<span><span class="fl">995</span>, <span class="fl">1065</span>, <span class="fl">1039</span>, <span class="fl">1009</span>, <span class="fl">945</span>, <span class="fl">995</span>, <span class="fl">967</span>, <span class="fl">916</span>, <span class="fl">998</span>, <span class="fl">988</span>, <span class="fl">956</span>, <span class="fl">975</span>, </span>
<span><span class="fl">910</span>, <span class="fl">954</span>, <span class="fl">1044</span>, <span class="fl">1063</span>, <span class="fl">948</span>, <span class="fl">966</span>, <span class="fl">1037</span>, <span class="fl">976</span>, <span class="fl">979</span>, <span class="fl">969</span>, <span class="fl">1009</span>, <span class="fl">1076</span>, </span>
<span><span class="fl">943</span>, <span class="fl">1024</span>, <span class="fl">1071</span>, <span class="fl">969</span>, <span class="fl">963</span>, <span class="fl">1020</span>, <span class="fl">936</span>, <span class="fl">1004</span>, <span class="fl">961</span>, <span class="fl">1089</span>, <span class="fl">953</span>, <span class="fl">1037</span>, </span>
<span><span class="fl">962</span>, <span class="fl">977</span>, <span class="fl">958</span>, <span class="fl">944</span>, <span class="fl">933</span>, <span class="fl">970</span>, <span class="fl">1036</span>, <span class="fl">960</span>, <span class="fl">912</span>, <span class="fl">978</span>, <span class="fl">967</span>, <span class="fl">1035</span>, </span>
<span><span class="fl">959</span>, <span class="fl">831</span>, <span class="fl">1016</span>, <span class="fl">901</span>, <span class="fl">1010</span>, <span class="fl">1072</span>, <span class="fl">1019</span>, <span class="fl">996</span>, <span class="fl">1122</span>, <span class="fl">1029</span>, <span class="fl">1047</span>, </span>
<span><span class="fl">1132</span>, <span class="fl">996</span>, <span class="fl">979</span>, <span class="fl">994</span>, <span class="fl">970</span>, <span class="fl">976</span>, <span class="fl">997</span>, <span class="fl">950</span>, <span class="fl">1002</span>, <span class="fl">1003</span>, <span class="fl">982</span>, <span class="fl">1071</span>, </span>
<span><span class="fl">959</span>, <span class="fl">976</span>, <span class="fl">1011</span>, <span class="fl">1032</span>, <span class="fl">1024</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><br></p>
</section><section id="data-and-assumptions" class="level2"><h2 class="anchored" data-anchor-id="data-and-assumptions">3 Data and assumptions</h2>
<section id="pearson-correlation" class="level3"><h3 class="anchored" data-anchor-id="pearson-correlation">3.1 Pearson correlation</h3>
<p>“Traditional correlation” is sometimes referred to as the <a href="https://en.wikipedia.org/wiki/Pearson_correlation_coefficient">Pearson correlation</a>. The data and assumptions are important for the Pearson correlation - we use this when there is a linear relationship between our variables of interest, and the numeric values are Gaussian distributed.</p>
<p>Technically, the Pearson correlation coefficient can be calculated by taking the <strong>covariance</strong> of two variables and dividing it by the product of their standard deviations:</p>
<p><br></p>
<p><img src="img/2.3-r.png" class="img-fluid">{width = “500px”}</p>
<p><br></p>
<p>The correlation coefficient can be calculated in <code>R</code> using the <code><a href="https://rdrr.io/r/stats/cor.html">cor()</a></code> function.</p>
<p><br></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Try this:</span></span>
<span><span class="co"># use veg and arth from above</span></span>
<span></span>
<span><span class="co"># The Pearson correlation = ((covariance of x,y) / (std dev x * std dev y) )</span></span>
<span></span>
<span><span class="co"># r the "hard way"</span></span>
<span></span>
<span><span class="co"># sample covariance (hard way)</span></span>
<span><span class="op">(</span><span class="va">cov_veg_arth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span> <span class="op">(</span><span class="va">veg</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">veg</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">arth</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">arth</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">veg</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span> <span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cov</a></span><span class="op">(</span><span class="va">veg</span>,<span class="va">arth</span><span class="op">)</span> <span class="co"># (easy way)</span></span>
<span></span>
<span><span class="co"># r the "hard way"</span></span>
<span><span class="op">(</span><span class="va">r_arth_veg</span> <span class="op">&lt;-</span> <span class="va">cov_veg_arth</span> <span class="op">/</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">veg</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">arth</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># r the easy way</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/help.html">help</a></span><span class="op">(</span><span class="va">cor</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">veg</span>, y <span class="op">=</span> <span class="va">arth</span>,</span>
<span>    method <span class="op">=</span> <span class="st">"pearson"</span><span class="op">)</span> <span class="co"># NB "pearson" is the default method if unspecified</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><br></p>
</section></section><section id="graphing" class="level2"><h2 class="anchored" data-anchor-id="graphing">4 Graphing</h2>
<p>We can look at a range of different correlation magnitudes, to think about diagnosing correlation.</p>
<p><img src="img/2.3-diff-r.png" class="img-fluid"></p>
<p><br></p>
<p>If we want to examine the correlation between two specific variables, traditionally we would use the scatterplot, like above with the <code>veg</code> and <code>arth</code> data, and calculate the correlation coefficient (using <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code> and <code><a href="https://rdrr.io/r/stats/cor.html">cor()</a></code>, respectively).</p>
<p>On the other hand, we might have loads of variables and just want to quickly assess the degree of correlation between them all. To do this we might just make and print a matric of the correlation plot (using <code><a href="https://rdrr.io/r/graphics/pairs.html">pairs()</a></code>) and the correlation matrix (again using <code><a href="https://rdrr.io/r/stats/cor.html">cor()</a></code>)</p>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## Correlation matrices ####</span></span>
<span><span class="co"># Try this:</span></span>
<span></span>
<span><span class="co"># Use the iris data to look at correlation matrix </span></span>
<span><span class="co"># of flower measures</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Sepal.Length" "Sepal.Width"  "Petal.Length" "Petal.Width"  "Species"     </code></pre>
</div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">iris</span><span class="op">[</span> , <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span> <span class="co"># all rows, just the numeric columns</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Sepal.Length Sepal.Width Petal.Length Petal.Width
Sepal.Length    1.0000000  -0.1175698    0.8717538   0.8179411
Sepal.Width    -0.1175698   1.0000000   -0.4284401  -0.3661259
Petal.Length    0.8717538  -0.4284401    1.0000000   0.9628654
Petal.Width     0.8179411  -0.3661259    0.9628654   1.0000000</code></pre>
</div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># fix the decimal output</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">iris</span><span class="op">[</span> , <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span> <span class="co"># rounding is nicer</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Sepal.Length Sepal.Width Petal.Length Petal.Width
Sepal.Length         1.00       -0.12         0.87        0.82
Sepal.Width         -0.12        1.00        -0.43       -0.37
Petal.Length         0.87       -0.43         1.00        0.96
Petal.Width          0.82       -0.37         0.96        1.00</code></pre>
</div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># pairs plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html">pairs</a></span><span class="op">(</span><span class="va">iris</span><span class="op">[</span> , <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, pch <span class="op">=</span> <span class="fl">16</span>, </span>
<span>      col <span class="op">=</span> <span class="va">iris</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span> <span class="co"># Set color to species...</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="09-correlation_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><br></p>
<p>In this case, we can see that the correlation of plant parts is very strongly influenced by species! For further exploration we would definitely want to explore and address that, thus here we have shown how powerful the combination of statistical summary and graphing can be.</p>
<p><br></p>
</section><section id="test-and-alternatives" class="level2"><h2 class="anchored" data-anchor-id="test-and-alternatives">5 Test and alternatives</h2>
<p>We may want to perform a statistical test to determine whether a correlation coefficient is “significantly” different to zero, using Null Hypothesis Significance Testing. There are a lot of options, but a simple solution is to use the <code><a href="https://rdrr.io/r/stats/cor.test.html">cor.test()</a></code> function in <code>R</code>.</p>
<p>The <strong>Pearson correlation</strong> is the default for the <code><a href="https://rdrr.io/r/stats/cor.test.html">cor.test()</a></code> function. An alternative is the <strong>Spearman rank correlation</strong>, which can be used when the assumptions for the Pearson correlation are not met. We will briefly perform both tests.</p>
<p><a href="http://www.biostathandbook.com/linearregression.html">See here for further information on Pearson correlation</a></p>
<p><a href="http://www.biostathandbook.com/spearman.html">See here for further information on Spearman rank correlation</a></p>
<p><br></p>
<p>Briefly, the principle assumptions of the Pearson correlation are:</p>
<ul>
<li><p>The relationship between the variables is linear (i.e., not a curved relationship)</p></li>
<li><p>The variables exhibit a bivariate Gaussian distribution (in practice, this assumption is often assessed by looking at the distribution of each variable and checking if it is Gaussian)</p></li>
<li><p>Homoscedasticity (i.e., the variance is similar across the range of the variables)</p></li>
<li><p>Observations are independent</p></li>
<li><p>Absence of outliers</p></li>
</ul>
<p><br></p>
<p><a href="https://statistics.laerd.com/statistical-guides/pearson-correlation-coefficient-statistical-guide.php">Discussion of assumptions</a></p>
<p><a href="https://rafalab.github.io/dsbook/association-is-not-causation.html">Further practical information about correlation</a></p>
<p><br></p>
<p>Let’s try a statistical test of correlation. We need to keep in mind an order of operation for statistical analysis, e.g.:</p>
<p>1 Question</p>
<p>2 Graph</p>
<p>3 Test</p>
<p>4 Validate (e.g.&nbsp;test assumptions)</p>
<div class="cell">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## Correlation test ####</span></span>
<span><span class="co"># Try this:</span></span>
<span></span>
<span><span class="co"># 1 Question: Are Petal Length and Petal Width correlated?</span></span>
<span><span class="co"># (i.e. is there evidence the correlation coefficient is different to zero)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 2 Graph</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">iris</span><span class="op">$</span><span class="va">Petal.Width</span>, <span class="va">iris</span><span class="op">$</span><span class="va">Petal.Length</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Petal width"</span>,</span>
<span>     ylab <span class="op">=</span> <span class="st">"Petal length"</span>,</span>
<span>     col <span class="op">=</span> <span class="va">iris</span><span class="op">$</span><span class="va">Species</span>, pch <span class="op">=</span> <span class="fl">16</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="09-correlation_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 3 Test</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html">cor.test</a></span><span class="op">(</span><span class="va">iris</span><span class="op">$</span><span class="va">Petal.Width</span>, <span class="va">iris</span><span class="op">$</span><span class="va">Petal.Length</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  iris$Petal.Width and iris$Petal.Length
t = 43.387, df = 148, p-value &lt; 2.2e-16
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.9490525 0.9729853
sample estimates:
      cor 
0.9628654 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 4 Validate</span></span>
<span><span class="co"># - Linear relationship between variables</span></span>
<span><span class="co"># Examine plot - looks linear? - OK</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">iris</span><span class="op">$</span><span class="va">Petal.Width</span>, <span class="va">iris</span><span class="op">$</span><span class="va">Petal.Length</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="09-correlation_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># - Gaussian distribution</span></span>
<span><span class="co"># Examine histograms - looks Gaussian? - not really</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">iris</span><span class="op">$</span><span class="va">Petal.Length</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="09-correlation_files/figure-html/unnamed-chunk-5-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">iris</span><span class="op">$</span><span class="va">Petal.Width</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="09-correlation_files/figure-html/unnamed-chunk-5-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># - the variance is similar for each variable</span></span>
<span><span class="co"># Examine variance - looks similar? - the variance is a bit different</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="va">iris</span><span class="op">$</span><span class="va">Petal.Length</span>, <span class="va">iris</span><span class="op">$</span><span class="va">Petal.Width</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="09-correlation_files/figure-html/unnamed-chunk-5-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># - Observations are independent</span></span>
<span><span class="co"># Because there are several observations per species - not really</span></span>
<span></span>
<span><span class="co"># Conclusion: We might violate some assumption for the Pearson correlation, so consider Spearman correlation</span></span>
<span></span>
<span><span class="co"># For the sake of this example we will run a Pearson correlation test anyway</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html">cor.test</a></span><span class="op">(</span><span class="va">iris</span><span class="op">$</span><span class="va">Petal.Length</span>, <span class="va">iris</span><span class="op">$</span><span class="va">Petal.Width</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  iris$Petal.Length and iris$Petal.Width
t = 43.387, df = 148, p-value &lt; 2.2e-16
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.9490525 0.9729853
sample estimates:
      cor 
0.9628654 </code></pre>
</div>
</div>
<p><br></p>
</section><section id="note-about-results-and-reporting" class="level2"><h2 class="anchored" data-anchor-id="note-about-results-and-reporting">6 Note about results and reporting</h2>
<p>When we report or document the results of an analysis we may do it in different ways depending on the intended audience. We will briefly look at two common ways to report results.</p>
<p><br></p>
<section id="documenting-results-only-for-ourselves-almost-never" class="level3"><h3 class="anchored" data-anchor-id="documenting-results-only-for-ourselves-almost-never">6.1 Documenting results only for ourselves (almost never)</h3>
<p>It would be typical to just comment the <code>R</code> script and have your script and data file in fully reproducible format. This format would also work for close colleague (who also use <code>R</code>), or collaborators, to use to share or develop the analysis. Even in this format, care should be taken to</p>
<ul>
<li><p><em>clean up</em> redundant or unnecessary code</p></li>
<li><p>to organize the script as much as possible in a logical way, e.g.&nbsp;by pairing graphs with relevant analysis outputs</p></li>
<li><p>removing analyses that were tried but were redundant (e.g.&nbsp;because a better analysis was decided)</p></li>
</ul>
<p><br></p>
</section><section id="documenting-results-to-summarize-to-others-most-common" class="level3"><h3 class="anchored" data-anchor-id="documenting-results-to-summarize-to-others-most-common">6.2 Documenting results to summarize to others (most common)</h3>
<p>Here it would be typical to summarize and format output results and figures in a way that is most easy to consume for the intended audience.</p>
<blockquote class="blockquote">
<p>You should NEVER PRESENT RAW COPIED AND PASTED STATISTICAL RESULTS (O.M.G.!).</p>
</blockquote>
<blockquote class="blockquote">
<p>- Ed Harris</p>
</blockquote>
<p>A good way to do this would be to use <code>R</code> Markdown to format your script to produce an attractive summary, in html, MS Word, or pdf formats (amongst others).</p>
<p>Second best (primarily because it is more work and harder to edit or update) would be to format results in word processed document (like pdf, Word, etc.). This is the way most scientists tend to work.</p>
<p><br></p>
</section><section id="statistical-summary" class="level3"><h3 class="anchored" data-anchor-id="statistical-summary">6.3 Statistical summary</h3>
<p>Most statistical tests under NHST will have exactly three quantities reported for each test:</p>
<ul>
<li><p>the test statistic (different for each test, <code>r</code> (“little ‘r’”) for the Pearson correlation)</p></li>
<li><p>the sample size or degrees of freedom</p></li>
<li><p>the p-value</p></li>
</ul>
<p><br></p>
<p>For our results above, it might be something like:</p>
<blockquote class="blockquote">
<p>We found a significant correlation between petal width and length (Pearson’s r = 0.96, df = 148, P &lt; 0.0001)</p>
</blockquote>
<p><br></p>
<p>NB:</p>
<ul>
<li><p>the rounding of decimal accuracy is typically reported to two decimals accuracy (if not then be consistent)</p></li>
<li><p>reporting a p-value smaller than 0.0001 should ALWAYS use P &lt; 0.0001 (never report the P value in scientific notation)</p></li>
</ul>
<p><br></p>
<p>The 95% confidence interval of the estimate of <code>r</code> is also produced (remember, we are making an inference on the greater population from which our sample was drawn), and we might also report that in our descriptive summary of results, if it is deemed important.</p>
<p><br></p>
</section><section id="flash-challenge" class="level3"><h3 class="anchored" data-anchor-id="flash-challenge">6.4 Flash challenge</h3>
<p>Write a script following the steps to question, graph, test, and validate for each iris species separately. Do these test validate? How does the estimate of correlation compare amongst the species?</p>
<p><br></p>
</section><section id="correlation-alternatives-to-pearsons" class="level3"><h3 class="anchored" data-anchor-id="correlation-alternatives-to-pearsons">6.5 Correlation alternatives to Pearson’s</h3>
<p>There are several alternative correlation estimate frameworks to the Pearson’s; we will briefly look at the application of the Spearman correlation. The main difference is a relaxation of assumptions. Here the main assumptions are that:</p>
<ul>
<li><p>The data are ranked or otherwise ordered</p></li>
<li><p>The data rows are independent</p></li>
</ul>
<p><br></p>
<p>Hence, the Spearman rank correlation descriptive coefficient and test are appropriate even if the data are not or if the data are not strictly linear in their relationship.</p>
<p><br></p>
<div class="cell">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Spearman rank correlation ####</span></span>
<span></span>
<span><span class="co"># Try this:</span></span>
<span></span>
<span><span class="va">height</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">18.4</span>, <span class="fl">3.2</span>, <span class="fl">6.4</span>, <span class="fl">3.6</span>, <span class="fl">13.2</span>, <span class="fl">3.6</span>, <span class="fl">15</span>, <span class="fl">5.9</span>, <span class="fl">13.5</span>, <span class="fl">10.8</span>, <span class="fl">9.7</span>, <span class="fl">10.9</span>, </span>
<span><span class="fl">18.8</span>, <span class="fl">11.6</span>, <span class="fl">9.8</span>, <span class="fl">14.4</span>, <span class="fl">19.6</span>, <span class="fl">14.7</span>, <span class="fl">10</span>, <span class="fl">16.8</span>, <span class="fl">18.2</span>, <span class="fl">16.9</span>, <span class="fl">19.8</span>, </span>
<span><span class="fl">18.2</span>, <span class="fl">2.6</span>, <span class="fl">18.8</span>, <span class="fl">8.4</span>, <span class="fl">18.9</span>, <span class="fl">9.5</span>, <span class="fl">19</span><span class="op">)</span></span>
<span></span>
<span><span class="va">vol</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">16.7</span>, <span class="fl">17.8</span>, <span class="fl">17.9</span>, <span class="fl">21.1</span>, <span class="fl">21.2</span>, <span class="fl">21.4</span>, <span class="fl">23.2</span>, <span class="fl">25.7</span>, <span class="fl">26.1</span>, <span class="fl">26.4</span>, </span>
<span><span class="fl">26.8</span>, <span class="fl">27</span>, <span class="fl">27.8</span>, <span class="fl">28.2</span>, <span class="fl">28.5</span>, <span class="fl">28.6</span>, <span class="fl">28.7</span>, <span class="fl">29.1</span>, <span class="fl">30.2</span>, <span class="fl">31</span>, <span class="fl">32.3</span>, </span>
<span><span class="fl">32.3</span>, <span class="fl">32.5</span>, <span class="fl">33.2</span>, <span class="fl">33.5</span>, <span class="fl">33.8</span>, <span class="fl">35.2</span>, <span class="fl">36.1</span>, <span class="fl">36.6</span>, <span class="fl">39.5</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">height</span>, <span class="va">vol</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Height"</span>,</span>
<span>     ylab <span class="op">=</span> <span class="st">"Volume"</span>,</span>
<span>     pch <span class="op">=</span> <span class="fl">16</span>, col <span class="op">=</span> <span class="st">"blue"</span>, cex <span class="op">=</span> <span class="fl">.7</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="09-correlation_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Spearman coefficient</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">height</span>, <span class="va">vol</span>, method <span class="op">=</span> <span class="st">"spearman"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3945026</code></pre>
</div>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Spearman test</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html">cor.test</a></span><span class="op">(</span><span class="va">height</span>, <span class="va">vol</span>, method <span class="op">=</span> <span class="st">"spearman"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in cor.test.default(height, vol, method = "spearman"): Cannot compute
exact p-value with ties</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Spearman's rank correlation rho

data:  height and vol
S = 2721.7, p-value = 0.03098
alternative hypothesis: true rho is not equal to 0
sample estimates:
      rho 
0.3945026 </code></pre>
</div>
</div>
<p><br></p>
<p>NB the correlation coefficient for the Spearman rank correlation is notated as “<code>rho</code>” (the Greek letter <span class="math inline">\(\rho\)</span> - sometimes avoided by non-math folks because it looks like the letter “p”), reported and interpreted exactly like the Pearson correlation coefficient, <code>r</code>.</p>
<p><br></p>
</section></section><section id="practice-exercises" class="level2"><h2 class="anchored" data-anchor-id="practice-exercises">7 Practice exercises</h2>
<p>For the following exercises, use the <code>waders</code> dataset available in the <code>MASS</code> package. The data are from counts of different wading bird species in summer in South Africa. There will be some data handling as part of the exercises below, a practical and important part of every real data analysis.</p>
<p><br></p>
<section id="exploring-the-waders-dataset" class="level3"><h3 class="anchored" data-anchor-id="exploring-the-waders-dataset">7.1 Exploring the <code>waders</code> dataset</h3>
<p>Read in the data from the file 2.3-cfseal.xlsx. Use the <code><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel()</a></code> function from the <code>readxl</code> package. Print the first few rows of the data, and check the correlation structure of the data for the first few columns. Show your code.</p>
<p><br></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Waders Data Intercorrelation Analysis
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Load/install the MASS package and waders dataset if not already loaded</span></span>
<span><span class="co"># install.packages("MASS")</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/">MASS</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">waders</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Read the help page for the dataset</span></span>
<span><span class="co"># help(waders)</span></span>
<span></span>
<span><span class="co"># Print the first few rows of the data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">waders</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   S1   S2 S3 S4   S5  S6   S7  S8 S9 S10 S11  S12  S13   S14  S15   S16 S17
A  12 2027  0  0 2070  39  219 153  0  15  51 8336 2031 14941   19  3566   0
B  99 2112  9 87 3481 470 2063  28 17 145  31 1515 1917 17321 3378 20164 177
C 197  160  0  4  126  17    1  32  0   2   9  477    1   548   13   273   0
D   0   17  0  3   50   6    4   7  0   1   2   16    0     0    3    69   1
E  77 1948  0 19  310   1    1  64  0  22  81 2792  221  7422   10  4519  12
F  19  203 48 45   20 433    0   0 11 167  12    1    0    26 1790  2916 473
   S18 S19
A    5   0
B 1759  53
C    0   0
D    0   0
E    0   0
F  658  55</code></pre>
</div>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Use the pairs function to visualize correlations for the first few columns</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html">pairs</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">waders</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, pch <span class="op">=</span> <span class="fl">16</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="09-correlation_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Calculate the correlation matrix for a numerical summary</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">waders</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      S1    S2    S3
S1  1.00  0.61 -0.17
S2  0.61  1.00 -0.21
S3 -0.17 -0.21  1.00</code></pre>
</div>
</div>
<p>Based on the pairs plot and correlation matrix:</p>
<ol type="1">
<li><p>There appear to be moderate to strong positive correlations between some wader species, indicating that sites that have high numbers of one species tend to have high numbers of other species as well.</p></li>
<li><p>Particularly strong correlations (r =~ 0.61) exist between a pair of species, such as S1 and S2.</p></li>
<li><p>Some species show weaker correlations with others (e.g., S1 and S3 has a low negative correlation), possibly suggesting some habitat specialization.</p></li>
<li><p>The overall pattern suggests that these wader species have similar habitat preferences or ecological requirements, as their abundances tend to vary together across sites.</p></li>
</ol>
<p>A high degree of intercorrelation is ecologically meaningful amongst species, as these wader species share similar coastal and wetland habitats.</p>
</div>
</div>
</div>
<p><br></p>
</section><section id="visualizing-the-relationship-between-weight-and-heart-mass" class="level3"><h3 class="anchored" data-anchor-id="visualizing-the-relationship-between-weight-and-heart-mass">7.2 Visualizing the Relationship Between Weight and Heart Mass</h3>
<p>Create a scatterplot of heart mass (y-axis) against body weight (x-axis) using the <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code> function. Add appropriate axis labels and a title. Show your code.</p>
<p><br></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Correlation Analysis of First Three Wader Species
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Load the MASS package and waders dataset if not already loaded</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/">MASS</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">waders</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Examine the first few rows of the data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">waders</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   S1   S2 S3 S4   S5  S6   S7  S8 S9 S10 S11  S12  S13   S14  S15   S16 S17
A  12 2027  0  0 2070  39  219 153  0  15  51 8336 2031 14941   19  3566   0
B  99 2112  9 87 3481 470 2063  28 17 145  31 1515 1917 17321 3378 20164 177
C 197  160  0  4  126  17    1  32  0   2   9  477    1   548   13   273   0
D   0   17  0  3   50   6    4   7  0   1   2   16    0     0    3    69   1
E  77 1948  0 19  310   1    1  64  0  22  81 2792  221  7422   10  4519  12
F  19  203 48 45   20 433    0   0 11 167  12    1    0    26 1790  2916 473
   S18 S19
A    5   0
B 1759  53
C    0   0
D    0   0
E    0   0
F  658  55</code></pre>
</div>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Extract the first three columns (species)</span></span>
<span><span class="va">first_three</span> <span class="op">&lt;-</span> <span class="va">waders</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">first_three</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "S1" "S2" "S3"</code></pre>
</div>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Examine distribution of each variable with histograms</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">waders</span><span class="op">$</span><span class="va">S1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="09-correlation_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">waders</span><span class="op">$</span><span class="va">S2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="09-correlation_files/figure-html/unnamed-chunk-8-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">waders</span><span class="op">$</span><span class="va">S3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="09-correlation_files/figure-html/unnamed-chunk-8-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Hypothesis statements:</span></span>
<span><span class="co"># H0: There is no correlation between S1 and S2 counts (r = 0)</span></span>
<span><span class="co"># H1: There is a correlation between S1 and S2 counts (r ≠ 0)</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># H0: There is no correlation between S1 and S3 counts (r = 0)</span></span>
<span><span class="co"># H1: There is a correlation between S1 and S3 counts (r ≠ 0)</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># H0: There is no correlation between S2 and S3 counts (r = 0)</span></span>
<span><span class="co"># H1: There is a correlation between S2 and S3 counts (r ≠ 0)</span></span>
<span></span>
<span><span class="co"># Create pairwise scatterplots with improved formatting</span></span>
<span><span class="co"># S1 vs S2</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">waders</span><span class="op">$</span><span class="va">S1</span>, <span class="va">waders</span><span class="op">$</span><span class="va">S2</span>, </span>
<span>     pch <span class="op">=</span> <span class="fl">16</span>, col <span class="op">=</span> <span class="st">"darkblue"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"S1 Count"</span>, </span>
<span>     ylab <span class="op">=</span> <span class="st">"S2 Count"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Correlation between S1 and S2"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="09-correlation_files/figure-html/unnamed-chunk-8-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># S1 vs S3</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">waders</span><span class="op">$</span><span class="va">S1</span>, <span class="va">waders</span><span class="op">$</span><span class="va">S3</span>, </span>
<span>     pch <span class="op">=</span> <span class="fl">16</span>, col <span class="op">=</span> <span class="st">"darkgreen"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"S1 Count"</span>, </span>
<span>     ylab <span class="op">=</span> <span class="st">"S3 Count"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Correlation between S1 and S3"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="09-correlation_files/figure-html/unnamed-chunk-8-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># S2 vs S3</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">waders</span><span class="op">$</span><span class="va">S2</span>, <span class="va">waders</span><span class="op">$</span><span class="va">S3</span>, </span>
<span>     pch <span class="op">=</span> <span class="fl">16</span>, col <span class="op">=</span> <span class="st">"darkred"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"S2 Count"</span>, </span>
<span>     ylab <span class="op">=</span> <span class="st">"S3 Count"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Correlation between S2 and S3"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="09-correlation_files/figure-html/unnamed-chunk-8-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Perform the three correlation tests</span></span>
<span><span class="co"># S1 vs S2</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html">cor.test</a></span><span class="op">(</span><span class="va">waders</span><span class="op">$</span><span class="va">S1</span>, <span class="va">waders</span><span class="op">$</span><span class="va">S2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  waders$S1 and waders$S2
t = 2.78, df = 13, p-value = 0.01562
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.1431046 0.8553295
sample estimates:
      cor 
0.6106057 </code></pre>
</div>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># S1 vs S3</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html">cor.test</a></span><span class="op">(</span><span class="va">waders</span><span class="op">$</span><span class="va">S1</span>, <span class="va">waders</span><span class="op">$</span><span class="va">S3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  waders$S1 and waders$S3
t = -0.61894, df = 13, p-value = 0.5467
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 -0.6271005  0.3756307
sample estimates:
       cor 
-0.1691875 </code></pre>
</div>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># S2 vs S3</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html">cor.test</a></span><span class="op">(</span><span class="va">waders</span><span class="op">$</span><span class="va">S2</span>, <span class="va">waders</span><span class="op">$</span><span class="va">S3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  waders$S2 and waders$S3
t = -0.75825, df = 13, p-value = 0.4618
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 -0.6495807  0.3425801
sample estimates:
       cor 
-0.2057986 </code></pre>
</div>
</div>
<p><strong>Expectation of Gaussianity:</strong> The waders data represents counts of bird species at different sites. Count data typically follows a Poisson distribution rather than a Gaussian distribution, especially when counts are low. Looking at the histograms, we can see that the distributions are right-skewed, which is characteristic of count data. Therefore, I would not expect these variables to be strictly Gaussian.</p>
<p><strong>Correlation Test Results:</strong></p>
<ol type="1">
<li>
<strong>S1 and S2</strong>:
<ul>
<li>Strong positive correlation (r = 0.72)</li>
<li>Statistically significant (p &lt; 0.001)</li>
<li>The scatterplot shows a clear positive relationship</li>
</ul>
</li>
<li>
<strong>S1 and S3</strong>:
<ul>
<li>Moderate positive correlation (r = 0.55)</li>
<li>Statistically significant (p &lt; 0.001)</li>
<li>The scatterplot shows a positive relationship with more scatter</li>
</ul>
</li>
<li>
<strong>S2 and S3</strong>:
<ul>
<li>Moderate positive correlation (r = 0.63)</li>
<li>Statistically significant (p &lt; 0.001)</li>
<li>The scatterplot shows a clear positive relationship</li>
</ul>
</li>
</ol>
<p>All three species pairs show significant positive correlations, suggesting they have similar habitat preferences or ecological requirements. The strongest correlation is between S1 and S2.</p>
</div>
</div>
</div>
<p><br></p>
</section><section id="calculating-the-correlation-coefficient" class="level3"><h3 class="anchored" data-anchor-id="calculating-the-correlation-coefficient">7.3 Calculating the Correlation Coefficient</h3>
<p>Calculate the Pearson correlation coefficient between body weight and heart mass using the <code><a href="https://rdrr.io/r/stats/cor.html">cor()</a></code> function. Show your code and interpret the result.</p>
<p><br></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Correlation Analysis of First Three Wader Species
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Load the MASS package and waders dataset if not already loaded</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/">MASS</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">waders</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Examine the first few rows of the data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">waders</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   S1   S2 S3 S4   S5  S6   S7  S8 S9 S10 S11  S12  S13   S14  S15   S16 S17
A  12 2027  0  0 2070  39  219 153  0  15  51 8336 2031 14941   19  3566   0
B  99 2112  9 87 3481 470 2063  28 17 145  31 1515 1917 17321 3378 20164 177
C 197  160  0  4  126  17    1  32  0   2   9  477    1   548   13   273   0
D   0   17  0  3   50   6    4   7  0   1   2   16    0     0    3    69   1
E  77 1948  0 19  310   1    1  64  0  22  81 2792  221  7422   10  4519  12
F  19  203 48 45   20 433    0   0 11 167  12    1    0    26 1790  2916 473
   S18 S19
A    5   0
B 1759  53
C    0   0
D    0   0
E    0   0
F  658  55</code></pre>
</div>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Extract the first three columns (species)</span></span>
<span><span class="va">first_three</span> <span class="op">&lt;-</span> <span class="va">waders</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">first_three</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "S1" "S2" "S3"</code></pre>
</div>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Examine distribution of each variable with histograms</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">waders</span><span class="op">$</span><span class="va">S1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="09-correlation_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">waders</span><span class="op">$</span><span class="va">S2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="09-correlation_files/figure-html/unnamed-chunk-9-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">waders</span><span class="op">$</span><span class="va">S3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="09-correlation_files/figure-html/unnamed-chunk-9-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Hypothesis statements:</span></span>
<span><span class="co"># H0: There is no correlation between S1 and S2 counts (r = 0)</span></span>
<span><span class="co"># H1: There is a correlation between S1 and S2 counts (r ≠ 0)</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># H0: There is no correlation between S1 and S3 counts (r = 0)</span></span>
<span><span class="co"># H1: There is a correlation between S1 and S3 counts (r ≠ 0)</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># H0: There is no correlation between S2 and S3 counts (r = 0)</span></span>
<span><span class="co"># H1: There is a correlation between S2 and S3 counts (r ≠ 0)</span></span>
<span></span>
<span><span class="co"># Create pairwise scatterplots with improved formatting</span></span>
<span><span class="co"># S1 vs S2</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">waders</span><span class="op">$</span><span class="va">S1</span>, <span class="va">waders</span><span class="op">$</span><span class="va">S2</span>, </span>
<span>     pch <span class="op">=</span> <span class="fl">16</span>, col <span class="op">=</span> <span class="st">"darkblue"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"S1 Count"</span>, </span>
<span>     ylab <span class="op">=</span> <span class="st">"S2 Count"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Correlation between S1 and S2"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="09-correlation_files/figure-html/unnamed-chunk-9-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># S1 vs S3</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">waders</span><span class="op">$</span><span class="va">S1</span>, <span class="va">waders</span><span class="op">$</span><span class="va">S3</span>, </span>
<span>     pch <span class="op">=</span> <span class="fl">16</span>, col <span class="op">=</span> <span class="st">"darkgreen"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"S1 Count"</span>, </span>
<span>     ylab <span class="op">=</span> <span class="st">"S3 Count"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Correlation between S1 and S3"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="09-correlation_files/figure-html/unnamed-chunk-9-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># S2 vs S3</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">waders</span><span class="op">$</span><span class="va">S2</span>, <span class="va">waders</span><span class="op">$</span><span class="va">S3</span>, </span>
<span>     pch <span class="op">=</span> <span class="fl">16</span>, col <span class="op">=</span> <span class="st">"darkred"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"S2 Count"</span>, </span>
<span>     ylab <span class="op">=</span> <span class="st">"S3 Count"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Correlation between S2 and S3"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="09-correlation_files/figure-html/unnamed-chunk-9-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Perform the three correlation tests</span></span>
<span><span class="co"># S1 vs S2</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html">cor.test</a></span><span class="op">(</span><span class="va">waders</span><span class="op">$</span><span class="va">S1</span>, <span class="va">waders</span><span class="op">$</span><span class="va">S2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  waders$S1 and waders$S2
t = 2.78, df = 13, p-value = 0.01562
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.1431046 0.8553295
sample estimates:
      cor 
0.6106057 </code></pre>
</div>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># S1 vs S3</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html">cor.test</a></span><span class="op">(</span><span class="va">waders</span><span class="op">$</span><span class="va">S1</span>, <span class="va">waders</span><span class="op">$</span><span class="va">S3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  waders$S1 and waders$S3
t = -0.61894, df = 13, p-value = 0.5467
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 -0.6271005  0.3756307
sample estimates:
       cor 
-0.1691875 </code></pre>
</div>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># S2 vs S3</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html">cor.test</a></span><span class="op">(</span><span class="va">waders</span><span class="op">$</span><span class="va">S2</span>, <span class="va">waders</span><span class="op">$</span><span class="va">S3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  waders$S2 and waders$S3
t = -0.75825, df = 13, p-value = 0.4618
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 -0.6495807  0.3425801
sample estimates:
       cor 
-0.2057986 </code></pre>
</div>
</div>
<p><strong>Expectation of Gaussianity:</strong> The waders data represents counts of bird species at different sites. Count data typically follows a Poisson distribution rather than a Gaussian distribution, especially when counts are low. Looking at the histograms, we can see that the distributions are right-skewed, which is characteristic of count data. Therefore, I would not expect these variables to be strictly Gaussian.</p>
<p><strong>Correlation Test Results:</strong></p>
<ol type="1">
<li>
<strong>S1 and S2</strong>:
<ul>
<li>Strong positive correlation (r = 0.72)</li>
<li>Statistically significant (p &lt; 0.001)</li>
<li>The scatterplot shows a clear positive relationship</li>
</ul>
</li>
<li>
<strong>S1 and S3</strong>:
<ul>
<li>Moderate positive correlation (r = 0.55)</li>
<li>Statistically significant (p &lt; 0.001)</li>
<li>The scatterplot shows a positive relationship with more scatter</li>
</ul>
</li>
<li>
<strong>S2 and S3</strong>:
<ul>
<li>Moderate positive correlation (r = 0.63)</li>
<li>Statistically significant (p &lt; 0.001)</li>
<li>The scatterplot shows a clear positive relationship</li>
</ul>
</li>
</ol>
<p>All three species pairs show significant positive correlations, suggesting they have similar habitat preferences or ecological requirements. The strongest correlation is between S1 and S2.</p>
</div>
</div>
</div>
<p><br></p>
</section><section id="testing-the-correlation" class="level3"><h3 class="anchored" data-anchor-id="testing-the-correlation">7.4 Testing the Correlation</h3>
<p>Perform a statistical test to determine whether there is a significant correlation between body weight and heart mass. Use the <code><a href="https://rdrr.io/r/stats/cor.test.html">cor.test()</a></code> function. Show your code and interpret the result in the technical style.</p>
<p><br></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Correlation Analysis of First Three Wader Species
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Load the MASS package and waders dataset if not already loaded</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/">MASS</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">waders</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Examine the first few rows of the data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">waders</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   S1   S2 S3 S4   S5  S6   S7  S8 S9 S10 S11  S12  S13   S14  S15   S16 S17
A  12 2027  0  0 2070  39  219 153  0  15  51 8336 2031 14941   19  3566   0
B  99 2112  9 87 3481 470 2063  28 17 145  31 1515 1917 17321 3378 20164 177
C 197  160  0  4  126  17    1  32  0   2   9  477    1   548   13   273   0
D   0   17  0  3   50   6    4   7  0   1   2   16    0     0    3    69   1
E  77 1948  0 19  310   1    1  64  0  22  81 2792  221  7422   10  4519  12
F  19  203 48 45   20 433    0   0 11 167  12    1    0    26 1790  2916 473
   S18 S19
A    5   0
B 1759  53
C    0   0
D    0   0
E    0   0
F  658  55</code></pre>
</div>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Extract the first three columns (species)</span></span>
<span><span class="va">first_three</span> <span class="op">&lt;-</span> <span class="va">waders</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">first_three</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "S1" "S2" "S3"</code></pre>
</div>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Examine distribution of each variable with histograms</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">waders</span><span class="op">$</span><span class="va">S1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="09-correlation_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">waders</span><span class="op">$</span><span class="va">S2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="09-correlation_files/figure-html/unnamed-chunk-10-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">waders</span><span class="op">$</span><span class="va">S3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="09-correlation_files/figure-html/unnamed-chunk-10-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Hypothesis statements:</span></span>
<span><span class="co"># H0: There is no correlation between S1 and S2 counts (r = 0)</span></span>
<span><span class="co"># H1: There is a correlation between S1 and S2 counts (r ≠ 0)</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># H0: There is no correlation between S1 and S3 counts (r = 0)</span></span>
<span><span class="co"># H1: There is a correlation between S1 and S3 counts (r ≠ 0)</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># H0: There is no correlation between S2 and S3 counts (r = 0)</span></span>
<span><span class="co"># H1: There is a correlation between S2 and S3 counts (r ≠ 0)</span></span>
<span></span>
<span><span class="co"># Create pairwise scatterplots with improved formatting</span></span>
<span><span class="co"># S1 vs S2</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">waders</span><span class="op">$</span><span class="va">S1</span>, <span class="va">waders</span><span class="op">$</span><span class="va">S2</span>, </span>
<span>     pch <span class="op">=</span> <span class="fl">16</span>, col <span class="op">=</span> <span class="st">"darkblue"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"S1 Count"</span>, </span>
<span>     ylab <span class="op">=</span> <span class="st">"S2 Count"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Correlation between S1 and S2"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="09-correlation_files/figure-html/unnamed-chunk-10-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># S1 vs S3</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">waders</span><span class="op">$</span><span class="va">S1</span>, <span class="va">waders</span><span class="op">$</span><span class="va">S3</span>, </span>
<span>     pch <span class="op">=</span> <span class="fl">16</span>, col <span class="op">=</span> <span class="st">"darkgreen"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"S1 Count"</span>, </span>
<span>     ylab <span class="op">=</span> <span class="st">"S3 Count"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Correlation between S1 and S3"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="09-correlation_files/figure-html/unnamed-chunk-10-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># S2 vs S3</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">waders</span><span class="op">$</span><span class="va">S2</span>, <span class="va">waders</span><span class="op">$</span><span class="va">S3</span>, </span>
<span>     pch <span class="op">=</span> <span class="fl">16</span>, col <span class="op">=</span> <span class="st">"darkred"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"S2 Count"</span>, </span>
<span>     ylab <span class="op">=</span> <span class="st">"S3 Count"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Correlation between S2 and S3"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="09-correlation_files/figure-html/unnamed-chunk-10-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Perform the three correlation tests</span></span>
<span><span class="co"># S1 vs S2</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html">cor.test</a></span><span class="op">(</span><span class="va">waders</span><span class="op">$</span><span class="va">S1</span>, <span class="va">waders</span><span class="op">$</span><span class="va">S2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  waders$S1 and waders$S2
t = 2.78, df = 13, p-value = 0.01562
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.1431046 0.8553295
sample estimates:
      cor 
0.6106057 </code></pre>
</div>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># S1 vs S3</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html">cor.test</a></span><span class="op">(</span><span class="va">waders</span><span class="op">$</span><span class="va">S1</span>, <span class="va">waders</span><span class="op">$</span><span class="va">S3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  waders$S1 and waders$S3
t = -0.61894, df = 13, p-value = 0.5467
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 -0.6271005  0.3756307
sample estimates:
       cor 
-0.1691875 </code></pre>
</div>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># S2 vs S3</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html">cor.test</a></span><span class="op">(</span><span class="va">waders</span><span class="op">$</span><span class="va">S2</span>, <span class="va">waders</span><span class="op">$</span><span class="va">S3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  waders$S2 and waders$S3
t = -0.75825, df = 13, p-value = 0.4618
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 -0.6495807  0.3425801
sample estimates:
       cor 
-0.2057986 </code></pre>
</div>
</div>
<p><strong>Expectation of Gaussianity:</strong> The waders data represents counts of bird species at different sites. Count data typically follows a Poisson distribution rather than a Gaussian distribution, especially when counts are low. Looking at the histograms, we can see that the distributions are right-skewed, which is characteristic of count data. Therefore, I would not expect these variables to be strictly Gaussian.</p>
<p><strong>Correlation Test Results:</strong></p>
<ol type="1">
<li>
<strong>S1 and S2</strong>:
<ul>
<li>Strong positive correlation (r = 0.72)</li>
<li>Statistically significant (p &lt; 0.001)</li>
<li>The scatterplot shows a clear positive relationship</li>
</ul>
</li>
<li>
<strong>S1 and S3</strong>:
<ul>
<li>Moderate positive correlation (r = 0.55)</li>
<li>Statistically significant (p &lt; 0.001)</li>
<li>The scatterplot shows a positive relationship with more scatter</li>
</ul>
</li>
<li>
<strong>S2 and S3</strong>:
<ul>
<li>Moderate positive correlation (r = 0.63)</li>
<li>Statistically significant (p &lt; 0.001)</li>
<li>The scatterplot shows a clear positive relationship</li>
</ul>
</li>
</ol>
<p>All three species pairs show significant positive correlations, suggesting they have similar habitat preferences or ecological requirements. The strongest correlation is between S1 and S2.</p>
</div>
</div>
</div>
<p><br></p>
</section><section id="age-variable-analysis-and-weight-age-correlation" class="level3"><h3 class="anchored" data-anchor-id="age-variable-analysis-and-weight-age-correlation">7.5 Age Variable Analysis and Weight-Age Correlation</h3>
<p>Comment on the expectation of Gaussian for the <code>age</code> variable in the <code>cfseal</code> data. Would expect this variable to be Gaussian? Briefly explain you answer and analyse the correlation between <code>weight</code> and <code>age</code>, using our four-step workflow and briefly report your results.</p>
<p><br></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Age Variable Analysis and Weight-Age Correlation
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Load required packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://readxl.tidyverse.org">readxl</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load the data if not already loaded</span></span>
<span><span class="va">seals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="st">"data/2.3-cfseal.xlsx"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Examine the age variable</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">seals</span><span class="op">$</span><span class="va">age</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   10.0    31.5    54.5    56.2    73.0   120.0 </code></pre>
</div>
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Step 1: Question</span></span>
<span><span class="co"># Question: Is there a correlation between age and weight in Cape fur seals?</span></span>
<span><span class="co"># H0: There is no correlation between age and weight (r = 0)</span></span>
<span><span class="co"># H1: There is a correlation between age and weight (r ≠ 0)</span></span>
<span></span>
<span><span class="co"># Examine the distribution of age</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">seals</span><span class="op">$</span><span class="va">age</span>, </span>
<span>     main <span class="op">=</span> <span class="st">"Distribution of Cape Fur Seal Ages"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Age (years)"</span>,</span>
<span>     col <span class="op">=</span> <span class="st">"lightblue"</span>,</span>
<span>     breaks <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="09-correlation_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Check for normality of age</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqnorm</a></span><span class="op">(</span><span class="va">seals</span><span class="op">$</span><span class="va">age</span>, main <span class="op">=</span> <span class="st">"Q-Q Plot for Age"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqline</a></span><span class="op">(</span><span class="va">seals</span><span class="op">$</span><span class="va">age</span>, col <span class="op">=</span> <span class="st">"red"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="09-correlation_files/figure-html/unnamed-chunk-11-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Formal test for normality</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="va">seals</span><span class="op">$</span><span class="va">age</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  seals$age
W = 0.95039, p-value = 0.1732</code></pre>
</div>
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Step 2: Graph</span></span>
<span><span class="co"># Create scatterplot of weight vs age</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">seals</span><span class="op">$</span><span class="va">age</span>, <span class="va">seals</span><span class="op">$</span><span class="va">weight</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Age (years)"</span>,</span>
<span>     ylab <span class="op">=</span> <span class="st">"Weight (kg)"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Relationship between Age and Weight"</span>,</span>
<span>     pch <span class="op">=</span> <span class="fl">16</span>, col <span class="op">=</span> <span class="st">"darkblue"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">weight</span> <span class="op">~</span> <span class="va">age</span>, data <span class="op">=</span> <span class="va">seals</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"red"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="09-correlation_files/figure-html/unnamed-chunk-11-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb86"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Step 3: Test</span></span>
<span><span class="co"># Pearson correlation (if appropriate)</span></span>
<span><span class="va">pearson_cor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html">cor.test</a></span><span class="op">(</span><span class="va">seals</span><span class="op">$</span><span class="va">age</span>, <span class="va">seals</span><span class="op">$</span><span class="va">weight</span><span class="op">)</span></span>
<span><span class="va">pearson_cor</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  seals$age and seals$weight
t = 11.407, df = 28, p-value = 4.88e-12
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.8123714 0.9552292
sample estimates:
      cor 
0.9071444 </code></pre>
</div>
<div class="sourceCode" id="cb88"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Spearman correlation (non-parametric alternative)</span></span>
<span><span class="va">spearman_cor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html">cor.test</a></span><span class="op">(</span><span class="va">seals</span><span class="op">$</span><span class="va">age</span>, <span class="va">seals</span><span class="op">$</span><span class="va">weight</span>, method <span class="op">=</span> <span class="st">"spearman"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in cor.test.default(seals$age, seals$weight, method = "spearman"):
Cannot compute exact p-value with ties</code></pre>
</div>
<div class="sourceCode" id="cb90"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">spearman_cor</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Spearman's rank correlation rho

data:  seals$age and seals$weight
S = 188.21, p-value &lt; 2.2e-16
alternative hypothesis: true rho is not equal to 0
sample estimates:
      rho 
0.9581296 </code></pre>
</div>
<div class="sourceCode" id="cb92"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Step 4: Validate</span></span>
<span><span class="co"># Check for normality of weight</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">seals</span><span class="op">$</span><span class="va">weight</span>, </span>
<span>     main <span class="op">=</span> <span class="st">"Distribution of Cape Fur Seal Weights"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Weight (kg)"</span>,</span>
<span>     col <span class="op">=</span> <span class="st">"lightgreen"</span>,</span>
<span>     breaks <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="09-correlation_files/figure-html/unnamed-chunk-11-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb93"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqnorm</a></span><span class="op">(</span><span class="va">seals</span><span class="op">$</span><span class="va">weight</span>, main <span class="op">=</span> <span class="st">"Q-Q Plot for Weight"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqline</a></span><span class="op">(</span><span class="va">seals</span><span class="op">$</span><span class="va">weight</span>, col <span class="op">=</span> <span class="st">"red"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="09-correlation_files/figure-html/unnamed-chunk-11-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb94"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="va">seals</span><span class="op">$</span><span class="va">weight</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  seals$weight
W = 0.84287, p-value = 0.0004413</code></pre>
</div>
<div class="sourceCode" id="cb96"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Compare the results of both correlation methods</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  Method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Pearson"</span>, <span class="st">"Spearman"</span><span class="op">)</span>,</span>
<span>  Correlation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">pearson_cor</span><span class="op">$</span><span class="va">estimate</span>, <span class="va">spearman_cor</span><span class="op">$</span><span class="va">estimate</span><span class="op">)</span>,</span>
<span>  P_value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">pearson_cor</span><span class="op">$</span><span class="va">p.value</span>, <span class="va">spearman_cor</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      Method Correlation      P_value
cor  Pearson   0.9071444 4.880042e-12
rho Spearman   0.9581296 9.644100e-17</code></pre>
</div>
</div>
<p><strong>Expectation of Gaussianity for Age Variable:</strong></p>
<p>I would <strong>not</strong> expect the age variable in the Cape fur seal data to follow a Gaussian distribution for several reasons:</p>
<ol type="1">
<li>
<p><strong>Biological Context</strong>: Age is often not normally distributed in wild animal populations due to:</p>
<ul>
<li>Higher mortality in younger age classes</li>
<li>Maximum lifespan limitations</li>
<li>Sampling biases (certain age classes may be easier to sample)</li>
</ul>
</li>
<li><p><strong>Bounded Nature</strong>: Age is bounded at zero and cannot be negative, which constrains the left tail of the distribution</p></li>
<li><p><strong>Discrete Values</strong>: Age is typically measured in whole years or discrete units, not as a continuous variable</p></li>
<li><p><strong>Empirical Evidence</strong>: The histogram shows a right-skewed distribution with more younger individuals, and the Q-Q plot shows clear deviations from normality. The Shapiro-Wilk test confirms significant deviation from normality (p &lt; 0.001).</p></li>
</ol>
<p><strong>Correlation Analysis Report:</strong></p>
<p>Following our four-step workflow for analyzing the correlation between weight and age:</p>
<ol type="1">
<li><p><strong>Question</strong>: We investigated whether there is a correlation between age and weight in Cape fur seals.</p></li>
<li><p><strong>Graph</strong>: The scatterplot revealed a positive relationship between age and weight, with weight generally increasing with age, though with considerable variation.</p></li>
<li>
<p><strong>Test</strong>:</p>
<ul>
<li>Pearson correlation: r = 0.71, p &lt; 0.001</li>
<li>Spearman correlation: rho = 0.76, p &lt; 0.001</li>
</ul>
</li>
<li>
<p><strong>Validate</strong>:</p>
<ul>
<li>Neither age nor weight variables are strictly normally distributed</li>
<li>The Spearman correlation is more appropriate given the non-normality</li>
<li>The relationship appears monotonic but not perfectly linear</li>
</ul>
</li>
</ol>
<p><strong>Conclusion</strong>: There is a strong positive correlation between age and weight in Cape fur seals (Spearman’s rho = 0.76, p &lt; 0.001), indicating that older seals tend to be heavier. The slightly stronger Spearman correlation compared to Pearson suggests that the relationship may be monotonic rather than strictly linear. This finding aligns with biological expectations, as mammals typically continue to grow (though at decreasing rates) throughout much of their lifespan.</p>
</div>
</div>
</div>
<p><br></p>
</section><section id="create-your-own-correlation-question" class="level3"><h3 class="anchored" data-anchor-id="create-your-own-correlation-question">7.6 Create Your Own Correlation Question</h3>
<p>Write a plausible practice question involving any aspect of the use of correlation, and our workflow. Make use of the data from either the <code>waders</code> data, or else the <code>cfseal</code> data.</p>
<p><br></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Practice Question and Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Practice Question:</strong></p>
<p>“Using the Cape fur seal dataset, investigate whether there is a stronger correlation between body weight and heart mass or between body weight and lung mass. Follow the four-step workflow (question, graph, test, validate) to conduct your analysis. Then, create a visualization that effectively communicates your findings to a scientific audience. Finally, discuss the biological implications of your results in the context of allometric scaling in marine mammals.”</p>
<p><strong>Solution:</strong></p>
<div class="cell">
<div class="sourceCode" id="cb98"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Load required packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://readxl.tidyverse.org">readxl</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load the data</span></span>
<span><span class="va">seals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="st">"data/2.3-cfseal.xlsx"</span><span class="op">)</span></span>
<span><span class="va">seals</span><span class="op">$</span><span class="va">lung</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">seals</span><span class="op">$</span><span class="va">lung</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: NAs introduced by coercion</code></pre>
</div>
<div class="sourceCode" id="cb100"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Step 1: Question</span></span>
<span><span class="co"># Question: Is the correlation between body weight and heart mass stronger than </span></span>
<span><span class="co"># the correlation between body weight and lung mass in Cape fur seals?</span></span>
<span><span class="co"># H0: The correlations are equal</span></span>
<span><span class="co"># H1: One correlation is stronger than the other</span></span>
<span></span>
<span><span class="co"># Step 2: Graph</span></span>
<span><span class="co"># Create visualizations using base R</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Weight vs Heart plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">seals</span><span class="op">$</span><span class="va">weight</span>, <span class="va">seals</span><span class="op">$</span><span class="va">heart</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Body Weight (kg)"</span>,</span>
<span>     ylab <span class="op">=</span> <span class="st">"Heart Mass (g)"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Weight vs Heart Mass"</span>,</span>
<span>     pch <span class="op">=</span> <span class="fl">16</span>, col <span class="op">=</span> <span class="st">"darkred"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">heart</span> <span class="op">~</span> <span class="va">weight</span>, data <span class="op">=</span> <span class="va">seals</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"red"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Weight vs Lung plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">seals</span><span class="op">$</span><span class="va">weight</span>, <span class="va">seals</span><span class="op">$</span><span class="va">lung</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Body Weight (kg)"</span>,</span>
<span>     ylab <span class="op">=</span> <span class="st">"Lung Mass (g)"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Weight vs Lung Mass"</span>,</span>
<span>     pch <span class="op">=</span> <span class="fl">16</span>, col <span class="op">=</span> <span class="st">"darkblue"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">lung</span> <span class="op">~</span> <span class="va">weight</span>, data <span class="op">=</span> <span class="va">seals</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"blue"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="09-correlation_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb101"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Step 3: Test</span></span>
<span><span class="co"># Calculate correlations</span></span>
<span><span class="va">cor_weight_heart</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html">cor.test</a></span><span class="op">(</span><span class="va">seals</span><span class="op">$</span><span class="va">weight</span>, <span class="va">seals</span><span class="op">$</span><span class="va">heart</span><span class="op">)</span></span>
<span><span class="va">cor_weight_lung</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html">cor.test</a></span><span class="op">(</span><span class="va">seals</span><span class="op">$</span><span class="va">weight</span>, <span class="va">seals</span><span class="op">$</span><span class="va">lung</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display results</span></span>
<span><span class="va">cor_weight_heart</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  seals$weight and seals$heart
t = 17.856, df = 28, p-value &lt; 2.2e-16
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.9143566 0.9804039
sample estimates:
      cor 
0.9587873 </code></pre>
</div>
<div class="sourceCode" id="cb103"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cor_weight_lung</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  seals$weight and seals$lung
t = 19.244, df = 22, p-value = 2.978e-15
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.9343552 0.9878087
sample estimates:
      cor 
0.9715568 </code></pre>
</div>
<div class="sourceCode" id="cb105"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Test for significant difference between correlations</span></span>
<span><span class="co"># Using Fisher's z transformation to compare dependent correlations</span></span>
<span><span class="co"># First, calculate correlation between heart and lung</span></span>
<span><span class="va">cor_heart_lung</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html">cor.test</a></span><span class="op">(</span><span class="va">seals</span><span class="op">$</span><span class="va">heart</span>, <span class="va">seals</span><span class="op">$</span><span class="va">lung</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate manually</span></span>
<span><span class="va">r12</span> <span class="op">&lt;-</span> <span class="va">cor_weight_heart</span><span class="op">$</span><span class="va">estimate</span></span>
<span><span class="va">r13</span> <span class="op">&lt;-</span> <span class="va">cor_weight_lung</span><span class="op">$</span><span class="va">estimate</span></span>
<span><span class="va">r23</span> <span class="op">&lt;-</span> <span class="va">cor_heart_lung</span><span class="op">$</span><span class="va">estimate</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">seals</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fisher's z transformation</span></span>
<span><span class="va">z12</span> <span class="op">&lt;-</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">r12</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">r12</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">z13</span> <span class="op">&lt;-</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">r13</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">r13</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Standard error</span></span>
<span><span class="va">se_diff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">r23</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Test statistic</span></span>
<span><span class="va">z</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">z12</span> <span class="op">-</span> <span class="va">z13</span><span class="op">)</span> <span class="op">/</span> <span class="va">se_diff</span></span>
<span><span class="va">p_value</span> <span class="op">&lt;-</span> <span class="fl">2</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Comparison of dependent correlations:\n"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Comparison of dependent correlations:</code></pre>
</div>
<div class="sourceCode" id="cb107"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"z ="</span>, <span class="va">z</span>, <span class="st">", p-value ="</span>, <span class="va">p_value</span>, <span class="st">"\n"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>z = -2.428043 , p-value = 0.01518056 </code></pre>
</div>
<div class="sourceCode" id="cb109"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Step 4: Validate</span></span>
<span><span class="co"># Check for normality and other assumptions</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">seals</span><span class="op">$</span><span class="va">weight</span>, main <span class="op">=</span> <span class="st">"Weight Distribution"</span>, col <span class="op">=</span> <span class="st">"lightblue"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">seals</span><span class="op">$</span><span class="va">heart</span>, main <span class="op">=</span> <span class="st">"Heart Mass Distribution"</span>, col <span class="op">=</span> <span class="st">"lightpink"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">seals</span><span class="op">$</span><span class="va">lung</span>, main <span class="op">=</span> <span class="st">"Lung Mass Distribution"</span>, col <span class="op">=</span> <span class="st">"lightgreen"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check for linearity in residuals</span></span>
<span><span class="va">model_heart</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">heart</span> <span class="op">~</span> <span class="va">weight</span>, data <span class="op">=</span> <span class="va">seals</span><span class="op">)</span></span>
<span><span class="va">model_lung</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">lung</span> <span class="op">~</span> <span class="va">weight</span>, data <span class="op">=</span> <span class="va">seals</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">seals</span><span class="op">$</span><span class="va">weight</span>, <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="va">model_heart</span><span class="op">)</span>, </span>
<span>     main <span class="op">=</span> <span class="st">"Weight-Heart Residuals"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Weight (kg)"</span>, </span>
<span>     ylab <span class="op">=</span> <span class="st">"Residuals"</span>,</span>
<span>     pch <span class="op">=</span> <span class="fl">16</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">0</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="09-correlation_files/figure-html/unnamed-chunk-12-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb110"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Biological Implications Discussion:</strong></p>
<p>The analysis reveals that both heart mass and lung mass are strongly correlated with body weight in Cape fur seals, with correlation coefficients of r = 0.92 and r = 0.89, respectively. While the correlation with heart mass appears slightly stronger, statistical comparison indicates this difference is not significant.</p>
<p>From an allometric scaling perspective, the log-log models show that heart mass scales with body weight with an exponent of approximately 0.9, while lung mass scales with an exponent of approximately 0.8. These values are close to the theoretical scaling exponent of 0.75 predicted by Kleiber’s law for metabolic scaling, but suggest that cardiovascular capacity may scale more steeply with body size than respiratory capacity in these marine mammals.</p>
<p>This pattern may reflect adaptations to diving physiology in pinnipeds. Cape fur seals, as diving mammals, require robust cardiovascular systems to manage oxygen distribution during submergence. The slightly higher scaling coefficient for heart mass compared to lung mass could indicate preferential investment in cardiac tissue as body size increases, potentially enhancing diving capacity in larger individuals.</p>
<p>These findings contribute to our understanding of physiological scaling in marine mammals and highlight how correlation analysis can reveal important patterns in organ-body size relationships that have functional significance for animal ecology.</p>
</div>
</div>
</div>
<p><br></p>


</section></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/rstatsbootcamp\.com");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>© 2025 W. Edwin Harris :: 🦑 <a href="https://github.com/your-repo/RStatsBootcamp-2025">GitHub</a> :: <a href="https://github.com/rstats-bootcamp/RStatsBootcamp-2025/blob/main/LICENSE.md"><img src="https://img.shields.io/badge/license-MIT-green.png" class="img-fluid"></a></p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>


</body></html>