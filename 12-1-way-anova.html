<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.30">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>12 ANOVA – R Stats Bootcamp</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./img/rstats-logo.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dee922831e13d8617d658465dd4567ee.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-927edb3cde42616945691bbf0360b549.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dee922831e13d8617d658465dd4567ee.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-d3f643744f9b4317ace29245be434518.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-fb58e920a50b525cf6b339435faaa4fb.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="site_libs/bootstrap/bootstrap-d3f643744f9b4317ace29245be434518.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script><link rel="stylesheet" href="styles.css">
</head>
<body class="nav-sidebar docked nav-fixed quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg " data-bs-theme="dark"><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    <img src="./img/rstats-logo.png" alt="" class="navbar-logo"></a>
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">R Stats Bootcamp</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item">
    <a class="nav-link active" href="./index.html" aria-current="page"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./schedule.html"> 
<span class="menu-text">Schedule</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
</div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./07-question-explore.html">Module 2: Statistical Analysis</a></li><li class="breadcrumb-item"><a href="./12-1-way-anova.html">12 ANOVA</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto"><div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Getting Started</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R Stats Bootcamp</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./schedule.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Course Schedule</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./about.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About the Bootcamp</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Module 1: R Foundations</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-setup.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">01 Setup &amp; intro</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-r-lang.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">02 R language</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">03 R Functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">04 Data objects</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-data-frames.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">05 Data frames</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-data-manipulation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">06 Data subsetting</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Module 2: Statistical Analysis</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-question-explore.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">07 Explore data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-sampling-dist.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">08 Distributions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-correlation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">09 Correlation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">10 Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-t-test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">11 T-test</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-1-way-anova.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">12 ANOVA</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Module 3: Reproducible Research</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-reproducibility.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">13 Reproducibility</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14-rmarkdown.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">14 R Markdown</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15-github-basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">15 Git and GitHub</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16-collaborative-workflows.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">16 Collaboration</span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li><a href="#analysis-of-variance-anova" id="toc-analysis-of-variance-anova" class="nav-link active" data-scroll-target="#analysis-of-variance-anova">1 ANalysis Of VAriance (ANOVA)</a></li>
  <li><a href="#the-question-of-1-way-anova" id="toc-the-question-of-1-way-anova" class="nav-link" data-scroll-target="#the-question-of-1-way-anova">2 The question of 1-way ANOVA</a></li>
  <li>
<a href="#data-and-assumptions" id="toc-data-and-assumptions" class="nav-link" data-scroll-target="#data-and-assumptions">3 Data and assumptions</a>
  <ul class="collapse">
<li><a href="#wide-format-data" id="toc-wide-format-data" class="nav-link" data-scroll-target="#wide-format-data">3.1 Wide format data</a></li>
  <li><a href="#long-format-data-preferred" id="toc-long-format-data-preferred" class="nav-link" data-scroll-target="#long-format-data-preferred">3.2 Long format data (preferred)</a></li>
  <li><a href="#formal-test-of-gaussian-residuals" id="toc-formal-test-of-gaussian-residuals" class="nav-link" data-scroll-target="#formal-test-of-gaussian-residuals">4.1 Formal test of Gaussian residuals</a></li>
  <li><a href="#homoscedasticity-check" id="toc-homoscedasticity-check" class="nav-link" data-scroll-target="#homoscedasticity-check">4.2 Homoscedasticity check</a></li>
  <li><a href="#bartlett-test" id="toc-bartlett-test" class="nav-link" data-scroll-target="#bartlett-test">4.3 Bartlett test</a></li>
  </ul>
</li>
  <li><a href="#graphing-anova" id="toc-graphing-anova" class="nav-link" data-scroll-target="#graphing-anova">5 Graphing ANOVA</a></li>
  <li>
<a href="#anova-f-test-statistic-and-alternatives" id="toc-anova-f-test-statistic-and-alternatives" class="nav-link" data-scroll-target="#anova-f-test-statistic-and-alternatives">6 ANOVA F test statistic and alternatives</a>
  <ul class="collapse">
<li><a href="#perform-the-anova" id="toc-perform-the-anova" class="nav-link" data-scroll-target="#perform-the-anova">6.1 perform the ANOVA**</a></li>
  <li><a href="#anova-basic-output" id="toc-anova-basic-output" class="nav-link" data-scroll-target="#anova-basic-output">6.2 ANOVA basic output</a></li>
  <li><a href="#contrasts-and-post-hoc-test" id="toc-contrasts-and-post-hoc-test" class="nav-link" data-scroll-target="#contrasts-and-post-hoc-test">6.3 Contrasts and <em>post hoc</em> test</a></li>
  <li><a href="#post-hoc-tests" id="toc-post-hoc-tests" class="nav-link" data-scroll-target="#post-hoc-tests">6.4 <em>Post hoc</em> tests</a></li>
  <li><a href="#type-i-errors" id="toc-type-i-errors" class="nav-link" data-scroll-target="#type-i-errors">6.5 Type I errors</a></li>
  <li><a href="#tukey-hsd-honestly-significant-differences" id="toc-tukey-hsd-honestly-significant-differences" class="nav-link" data-scroll-target="#tukey-hsd-honestly-significant-differences">6.6 Tukey HSD (Honestly Significant Differences)</a></li>
  <li><a href="#alternatives-to-1-way-anova" id="toc-alternatives-to-1-way-anova" class="nav-link" data-scroll-target="#alternatives-to-1-way-anova">6.7 Alternatives to 1-way ANOVA</a></li>
  <li><a href="#kruskal-wallis-non-parametric-alternative-to-the-1-way-anova" id="toc-kruskal-wallis-non-parametric-alternative-to-the-1-way-anova" class="nav-link" data-scroll-target="#kruskal-wallis-non-parametric-alternative-to-the-1-way-anova">6.8 Kruskal-Wallis non-parametric alternative to the 1-way ANOVA</a></li>
  </ul>
</li>
  <li>
<a href="#anova-calculation-details" id="toc-anova-calculation-details" class="nav-link" data-scroll-target="#anova-calculation-details">7 ANOVA calculation details</a>
  <ul class="collapse">
<li><a href="#anova-equations" id="toc-anova-equations" class="nav-link" data-scroll-target="#anova-equations">7.1 ANOVA Equations</a></li>
  <li><a href="#anova-variables" id="toc-anova-variables" class="nav-link" data-scroll-target="#anova-variables">7.2 ANOVA Variables</a></li>
  <li><a href="#anova-sources-of-variation-table" id="toc-anova-sources-of-variation-table" class="nav-link" data-scroll-target="#anova-sources-of-variation-table">7.3 ANOVA Sources of variation table</a></li>
  <li><a href="#do-an-anova-by-hand-programmatically" id="toc-do-an-anova-by-hand-programmatically" class="nav-link" data-scroll-target="#do-an-anova-by-hand-programmatically">7.4 Do an ANOVA “by hand” programmatically</a></li>
  </ul>
</li>
  <li>
<a href="#practice-exercises" id="toc-practice-exercises" class="nav-link" data-scroll-target="#practice-exercises">8 Practice exercises</a>
  <ul class="collapse">
<li><a href="#loading-and-exploring-the-pesticide-dataset" id="toc-loading-and-exploring-the-pesticide-dataset" class="nav-link" data-scroll-target="#loading-and-exploring-the-pesticide-dataset">8.1 Loading and Exploring the Pesticide Dataset</a></li>
  <li><a href="#testing-normality-of-residuals" id="toc-testing-normality-of-residuals" class="nav-link" data-scroll-target="#testing-normality-of-residuals">8.2 Testing Normality of Residuals</a></li>
  <li><a href="#testing-homoscedasticity" id="toc-testing-homoscedasticity" class="nav-link" data-scroll-target="#testing-homoscedasticity">8.3 Testing Homoscedasticity</a></li>
  <li><a href="#performing-one-way-anova" id="toc-performing-one-way-anova" class="nav-link" data-scroll-target="#performing-one-way-anova">8.4 Performing One-way ANOVA</a></li>
  <li><a href="#post-hoc-analysis-of-treatment-effects" id="toc-post-hoc-analysis-of-treatment-effects" class="nav-link" data-scroll-target="#post-hoc-analysis-of-treatment-effects">8.5 Post-hoc Analysis of Treatment Effects</a></li>
  <li><a href="#create-your-own-anova-question" id="toc-create-your-own-anova-question" class="nav-link" data-scroll-target="#create-your-own-anova-question">8.6 Create Your Own ANOVA Question</a></li>
  </ul>
</li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./07-question-explore.html">Module 2: Statistical Analysis</a></li><li class="breadcrumb-item"><a href="./12-1-way-anova.html">12 ANOVA</a></li></ol></nav><div class="quarto-title">
<h1 class="title">12 ANOVA</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="img/row.png" class="img-fluid figure-img" width="500"></p>
<figcaption>Arrange the arithmetic to compare more than two groups</figcaption></figure>
</div>
</center>
<section id="analysis-of-variance-anova" class="level2"><h2 class="anchored" data-anchor-id="analysis-of-variance-anova">1 ANalysis Of VAriance (ANOVA)</h2>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Learning Objectives
</div>
</div>
<div class="callout-body-container callout-body">
<p>By the end of this lesson, you will be able to:</p>
<ul>
<li>Articulate the question of 1-way ANOVA</li>
<li>Evaluate data and assumptions for 1-way ANOVA</li>
<li>Graph 1-way ANOVA data</li>
<li>Perform tests and alternatives for 1-way ANOVA</li>
</ul>
</div>
</div>
<blockquote class="blockquote">
<p>The analysis of variance is not a mathematical theorem, but rather a convenient method of arranging the arithmetic. R. A. Fisher (via Wishart 1934. Sppl. J. Roy. Soc. 1(1):26-61.)</p>
</blockquote>
<p>Perhaps more so than any other tool, the Analysis of Variance (ANOVA) played a role in literally revolutionizing the idea of objectivity in using data to produce evidence to support claims for certain experimental designs. Invented by the famous statistician and biologist R. A. Fisher while he worked at Rothamsted Research, the intention was for ANOVA to be a useful tool to analyze agriculture experiments. Today, despite many innovations and competing approaches, it remains at the foundation of the basic practice of statistics.</p>
<p><br></p>
</section><section id="the-question-of-1-way-anova" class="level2"><h2 class="anchored" data-anchor-id="the-question-of-1-way-anova">2 The question of 1-way ANOVA</h2>
<p>There are several reasons to use a “1-way ANOVA” experimental design. The scenario usually involves:</p>
<ul>
<li><p><strong>one numeric continuous dependent variable</strong> of interest</p></li>
<li><p><strong>a factor that contains 2 or more levels</strong>, often with a control</p></li>
<li><p>When there are just two levels, the 1-ANOVA is conceptually equivalent to the t-test</p></li>
</ul>
<p>An example might be something like a classic field trial, where crop pest damage is measured (the numeric continuous dependent variable) and the factor compares pest treatment with 3 levels: a control level (no pesticide), an organic pesticide, and a chemical pesticide. The basic question is whether there is an overall difference in the numeric dependent variable amongst the factor levels, however several kinds of questions are also possible to answer:</p>
<ul>
<li><p><strong>overall difference</strong> test of means between the factors</p></li>
<li><p>Comparison of difference of each factor level with the control or other reference factor level</p></li>
<li><p><strong><em>post hoc</em></strong> tests of difference between specific factor levels, e.g.&nbsp;pairwise tests for a factor with levels A, B, and C might test all possible comparisons A:B, A:C, and B:C.</p></li>
<li><p>Examination of the <strong>“sources of variation”</strong> observed in the dependent variable, e.g.&nbsp;what proportion of total variation can be accounted for by the factor</p></li>
</ul>
<p><br></p>
<p>The test statistic for ANOVA is the <strong>F ratio</strong>, which is proportion of variance in the dependent variable between the groups, relative to that within the categories. We will (very briefly) look at this calculation with the aim of gaining a practical understanding of what is going.</p>
<p><br></p>
</section><section id="data-and-assumptions" class="level2"><h2 class="anchored" data-anchor-id="data-and-assumptions">3 Data and assumptions</h2>
<p>The data we will look at is an experiment in animal genetics, looking at the weight of male chickens (8-week old weight in grams), where weight is the continuous dependent variable. The factor is the sire identity, where the measure young male chicks were sired by one of 5 sires, thus sire is a factor with 5 levels A, B, C, D, and E.</p>
<p><br></p>
<section id="wide-format-data" class="level3"><h3 class="anchored" data-anchor-id="wide-format-data">3.1 Wide format data</h3>
<p>Here, the numeric data are stored in five vectors, each corresponding to one factor level. One row does not correspond to a single “case” because each column contains measures from different individual offspring. This is an unusual way to store data like this (these days), but we will look at this “wide format” first.</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Try this</span></span>
<span><span class="co"># Data in "wide format" </span></span>
<span><span class="va">A</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">687</span>, <span class="fl">691</span>, <span class="fl">793</span>, <span class="fl">675</span>, <span class="fl">700</span>, <span class="fl">753</span>, <span class="fl">704</span>, <span class="fl">717</span><span class="op">)</span></span>
<span><span class="va">B</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">618</span>, <span class="fl">680</span>, <span class="fl">592</span>, <span class="fl">683</span>, <span class="fl">631</span>, <span class="fl">691</span>, <span class="fl">694</span>, <span class="fl">732</span><span class="op">)</span></span>
<span><span class="va">C</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">618</span>, <span class="fl">687</span>, <span class="fl">763</span>, <span class="fl">747</span>, <span class="fl">687</span>, <span class="fl">737</span>, <span class="fl">731</span>, <span class="fl">603</span><span class="op">)</span></span>
<span><span class="va">D</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">600</span>, <span class="fl">657</span>, <span class="fl">669</span>, <span class="fl">606</span>, <span class="fl">718</span>, <span class="fl">693</span>, <span class="fl">669</span>, <span class="fl">648</span><span class="op">)</span></span>
<span><span class="va">E</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">717</span>, <span class="fl">658</span>, <span class="fl">674</span>, <span class="fl">611</span>, <span class="fl">678</span>, <span class="fl">788</span>, <span class="fl">650</span>, <span class="fl">690</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">chicken.wide</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">A</span>, <span class="va">B</span>, <span class="va">C</span>, <span class="va">D</span>, <span class="va">E</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    A   B   C   D   E
1 687 618 618 600 717
2 691 680 687 657 658
3 793 592 763 669 674
4 675 683 747 606 611
5 700 631 687 718 678
6 753 691 737 693 788</code></pre>
</div>
</div>
<p><br></p>
</section><section id="long-format-data-preferred" class="level3"><h3 class="anchored" data-anchor-id="long-format-data-preferred">3.2 Long format data (preferred)</h3>
<p>Here, the numeric data is stored in a single vector, with a factor vector for the sire data. Each row corresponds to a single, independent “case”. This format is preferred and adheres to the “Tidy Data” standard, although it is not hard to move between wide and long formats.</p>
<div class="cell" data-warnings="false">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Try this</span></span>
<span><span class="co"># Data in "wide format"  ####</span></span>
<span><span class="va">A</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">687</span>, <span class="fl">691</span>, <span class="fl">793</span>, <span class="fl">675</span>, <span class="fl">700</span>, <span class="fl">753</span>, <span class="fl">704</span>, <span class="fl">717</span><span class="op">)</span></span>
<span><span class="va">B</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">618</span>, <span class="fl">680</span>, <span class="fl">592</span>, <span class="fl">683</span>, <span class="fl">631</span>, <span class="fl">691</span>, <span class="fl">694</span>, <span class="fl">732</span><span class="op">)</span></span>
<span><span class="va">C</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">618</span>, <span class="fl">687</span>, <span class="fl">763</span>, <span class="fl">747</span>, <span class="fl">687</span>, <span class="fl">737</span>, <span class="fl">731</span>, <span class="fl">603</span><span class="op">)</span></span>
<span><span class="va">D</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">600</span>, <span class="fl">657</span>, <span class="fl">669</span>, <span class="fl">606</span>, <span class="fl">718</span>, <span class="fl">693</span>, <span class="fl">669</span>, <span class="fl">648</span><span class="op">)</span></span>
<span><span class="va">E</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">717</span>, <span class="fl">658</span>, <span class="fl">674</span>, <span class="fl">611</span>, <span class="fl">678</span>, <span class="fl">788</span>, <span class="fl">650</span>, <span class="fl">690</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">chicken.wide</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">A</span>, <span class="va">B</span>, <span class="va">C</span>, <span class="va">D</span>, <span class="va">E</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    A   B   C   D   E
1 687 618 618 600 717
2 691 680 687 657 658
3 793 592 763 669 674
4 675 683 747 606 611
5 700 631 687 718 678
6 753 691 737 693 788</code></pre>
</div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Data in "long format"  ####</span></span>
<span><span class="co"># The hard way</span></span>
<span><span class="va">weight</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">A</span>,<span class="va">B</span>,<span class="va">C</span>,<span class="va">D</span>,<span class="va">E</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sire</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="fl">8</span><span class="op">)</span>,</span>
<span>          <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"B"</span>, <span class="fl">8</span><span class="op">)</span>,</span>
<span>          <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"C"</span>, <span class="fl">8</span><span class="op">)</span>,</span>
<span>          <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"D"</span>, <span class="fl">8</span><span class="op">)</span>,</span>
<span>          <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"E"</span>, <span class="fl">8</span><span class="op">)</span> <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">weight</span>, <span class="va">sire</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  weight sire
1    687    A
2    691    A
3    793    A
4    675    A
5    700    A
6    753    A</code></pre>
</div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">tail</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">weight</span>, <span class="va">sire</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   weight sire
35    674    E
36    611    E
37    678    E
38    788    E
39    650    E
40    690    E</code></pre>
</div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># The "programm-ey" way</span></span>
<span><span class="va">weight1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">A</span>,<span class="va">B</span>,<span class="va">C</span>,<span class="va">D</span>,<span class="va">E</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sire1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html">vector</a></span><span class="op">(</span>mode <span class="op">=</span> <span class="st">"character"</span>, length <span class="op">=</span> <span class="fl">40</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span> <span class="op">{</span> <span class="va">sire1</span><span class="op">[</span><span class="op">(</span><span class="fl">8</span><span class="op">*</span><span class="va">i</span><span class="op">-</span><span class="fl">8</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">LETTERS</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="fl">8</span><span class="op">)</span> <span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">weight1</span>, <span class="va">sire1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  weight1 sire1
1     687     A
2     691     A
3     793     A
4     675     A
5     700     A
6     753     A</code></pre>
</div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">tail</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">weight1</span>, <span class="va">sire1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   weight1 sire1
35     674     E
36     611     E
37     678     E
38     788     E
39     650     E
40     690     E</code></pre>
</div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># With function from {tidyr}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">chicken.wide</span><span class="op">)</span> <span class="co"># From above</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    A   B   C   D   E
1 687 618 618 600 717
2 691 680 687 657 658
3 793 592 763 669 674
4 675 683 747 606 611
5 700 631 687 718 678
6 753 691 737 693 788</code></pre>
</div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/hadley/reshape">reshape2</a></span><span class="op">)</span> <span class="co"># For melt()</span></span>
<span><span class="co">#?melt</span></span>
<span><span class="va">new.long</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt</a></span><span class="op">(</span><span class="va">chicken.wide</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>No id variables; using all as measure variables</code></pre>
</div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">new.long</span><span class="op">)</span> <span class="co"># Not bad but note the variable names... </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  variable value
1        A   687
2        A   691
3        A   793
4        A   675
5        A   700
6        A   753</code></pre>
</div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">new.long</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "variable" "value"   </code></pre>
</div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Flash challenge: change the variable names in new.long</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">new.long</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Sire'</span>, <span class="st">'Weight'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">new.long</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Sire"   "Weight"</code></pre>
</div>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># NB, you should probably just use long format for your data in the first place!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>R output</code></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">head</span>(new.long) <span class="co"># Not bad but note the variable names</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  variable value</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>        A   <span class="dv">687</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>        A   <span class="dv">691</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>        A   <span class="dv">793</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>        A   <span class="dv">675</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>        A   <span class="dv">700</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span>        A   <span class="dv">753</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><br></p>
<p>##4 Assumptions of ANOVA</p>
<p>The assumptions of ANOVA are similar to those of regression (indeed, both are a specific kind of Linear Model and share the assumptions of the Gaussian Linear Model). The most important to consider now are:</p>
<ul>
<li><p>Gaussian residuals (we test graphically and with NHST for Gaussian residual distribution)</p></li>
<li><p>Homoscedasticity (we test graphically with a residuals versus fitted values plot)</p></li>
<li><p>Equality of variance (plot of residual versus factor and NHST for == variance)</p></li>
<li><p>Independent observations (we assume this for now with the chicken data, but will not test is formally)</p></li>
</ul>
<p><br></p>
<div class="cell">
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## **Assumptions** ####</span></span>
<span></span>
<span><span class="co">## - Gaussian residuals ####</span></span>
<span><span class="co"># Make the model object with aov()</span></span>
<span></span>
<span><span class="co"># ?aov</span></span>
<span><span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">Weight</span> <span class="op">~</span> <span class="va">Sire</span>, </span>
<span>         data <span class="op">=</span> <span class="va">new.long</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Graph to examine Gaussian assumption of residuals</span></span>
<span><span class="co"># NB we use rstandard()</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">rstandard</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Gaussian?"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Look at residuals with qqPlot()</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-forge.r-project.org/projects/car/">car</a></span><span class="op">)</span> <span class="co"># For qqPlot()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: carData</code></pre>
</div>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/car/man/qqPlot.html">qqPlot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">m1</span>,</span>
<span>       main <span class="op">=</span> <span class="st">"Gaussian?"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="12-1-way-anova_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 24 38</code></pre>
</div>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br></p>
</section><section id="formal-test-of-gaussian-residuals" class="level3"><h3 class="anchored" data-anchor-id="formal-test-of-gaussian-residuals">4.1 Formal test of Gaussian residuals</h3>
<p>At a glance, there are no serious issues with the assumption of Gaussian residual distribution. We can use NHST to help us decide; we will try the <code><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test()</a></code>.</p>
<p><br></p>
<div class="cell">
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">rstandard</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  rstandard(m1)
W = 0.99182, p-value = 0.9913</code></pre>
</div>
</div>
<p><br></p>
<blockquote class="blockquote">
<p>There is no evidence of difference to Gaussian in our residuals for our ANOVA model (Shapiro-Wilk: W = 0.99, n = 40, P = 0.99).</p>
</blockquote>
<p><br></p>
</section><section id="homoscedasticity-check" class="level3"><h3 class="anchored" data-anchor-id="homoscedasticity-check">4.2 Homoscedasticity check</h3>
<p>We will look at the residuals relative to the fitted values.</p>
<p><br></p>
<div class="cell">
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Plot for homoscedasticity check</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">rstandard</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html">fitted</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span>,</span>
<span>     ylab <span class="op">=</span> <span class="st">"m1: residuals"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"m1: fitted values"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Spread similar across x?"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">0</span>,</span>
<span>       lty <span class="op">=</span> <span class="fl">2</span>, lwd <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Make the mean residual y points (just to check)</span></span>
<span><span class="va">y1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html">aggregate</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">rstandard</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">new.long</span><span class="op">$</span><span class="va">Sire</span><span class="op">)</span>, FUN <span class="op">=</span> <span class="va">mean</span><span class="op">)</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span></span>
<span><span class="co"># Make the x unique fitted values (just to check)</span></span>
<span><span class="va">x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html">fitted</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span>, <span class="fl">6</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x1</span>, y <span class="op">=</span> <span class="va">y1</span>, </span>
<span>       pch <span class="op">=</span> <span class="fl">16</span>, cex <span class="op">=</span> <span class="fl">1.2</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="12-1-way-anova_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><br></p>
</section><section id="bartlett-test" class="level3"><h3 class="anchored" data-anchor-id="bartlett-test">4.3 Bartlett test</h3>
<p>Finally, we can use NHST just to have a final check of whether the variance in weight is equal between factor levels. There are several ways to do this; we will use the Bartlett test using <code><a href="https://rdrr.io/r/stats/bartlett.test.html">bartlett.test()</a></code>, which compares the variance for more than 2 groups.</p>
<p><br></p>
<div class="cell">
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># NHST to examine  assumption of homoscedasticity</span></span>
<span><span class="co"># (homoscedasticiyy good, heteroscedasticity bad)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/bartlett.test.html">bartlett.test</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">weight</span><span class="op">~</span><span class="va">sire</span>, data <span class="op">=</span> <span class="va">new.long</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Bartlett test of homogeneity of variances

data:  weight by sire
Bartlett's K-squared = 1.6868, df = 4, p-value = 0.7931</code></pre>
</div>
</div>
<p><br></p>
<blockquote class="blockquote">
<p>We find no evidence that variance in offspring weight differs between sires (Bartlett test: K-sqared = 1.69, df = 4, P = 0.79).</p>
</blockquote>
<p><br></p>
</section></section><section id="graphing-anova" class="level2"><h2 class="anchored" data-anchor-id="graphing-anova">5 Graphing ANOVA</h2>
<p>The classic way to visualize the 1-way ANOVA is with boxplot, with some way to show the central tendency of the data separately for each factor level. For continuous variables, boxplots show this perfectly. For count variables, barplots are sometimes used with the height set to the mean, along with some form of error bar. Here we will use a boxplot.</p>
<p><br></p>
<div class="cell">
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## basic boxplot ####</span></span>
<span></span>
<span><span class="co"># It always pays to make a nice plot</span></span>
<span></span>
<span><span class="co"># Do you think sire affects offspring weight?</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="va">Weight</span> <span class="op">~</span> <span class="va">Sire</span>, data <span class="op">=</span> <span class="va">new.long</span>, </span>
<span>        main <span class="op">=</span> <span class="st">"Is this plot good enough?"</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="12-1-way-anova_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><br></p>
<p>So, it looks like sire identity <em>could</em> have an effect on mean male offspring weight. But, is this graph good enough? Can we make it better? Let’s critique it:</p>
<ul>
<li><p>(important) The y axis does not indicate the unit of measurement</p></li>
<li><p>(important) Neither axis title is capitalized</p></li>
<li><p>(optional) Adding on the points might add interesting detail</p></li>
<li><p>(optional) Reference line for control (we do not really have a control here) or of the “grand mean” might be useful</p></li>
</ul>
<p><br></p>
<p>5.1 Make a better graph</p>
<div class="cell">
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## **Make a better graph** ####</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="va">Weight</span> <span class="op">~</span> <span class="va">Sire</span>, data <span class="op">=</span> <span class="va">new.long</span>,</span>
<span>        ylab <span class="op">=</span> <span class="st">"Weight (g)"</span>,</span>
<span>        xlab <span class="op">=</span> <span class="st">"Sire"</span>,</span>
<span>        main <span class="op">=</span> <span class="st">"Effect of Sire on 8-wk weight"</span>,</span>
<span>        cex <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="co"># Get rid of the outlier dot (we will draw it back)</span></span>
<span></span>
<span><span class="co"># Make horizontal line for grand mean</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">new.long</span><span class="op">$</span><span class="va">Weight</span><span class="op">)</span>, </span>
<span>       lty <span class="op">=</span> <span class="fl">2</span>, lwd <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="co"># Mere vanity</span></span>
<span></span>
<span><span class="co"># Draw on raw data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/jitter.html">jitter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, each <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>, amount <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span>,</span>
<span>       y <span class="op">=</span> <span class="va">new.long</span><span class="op">$</span><span class="va">Weight</span>,</span>
<span>       pch <span class="op">=</span> <span class="fl">16</span>, cex <span class="op">=</span> <span class="fl">.8</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="co"># Mere vanity</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="12-1-way-anova_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><br></p>
</section><section id="anova-f-test-statistic-and-alternatives" class="level2"><h2 class="anchored" data-anchor-id="anova-f-test-statistic-and-alternatives">6 ANOVA F test statistic and alternatives</h2>
<p>The basic application of ANOVA in <code>R</code> is the <code><a href="https://rdrr.io/r/stats/aov.html">aov()</a></code> function. There are actually a lot of alternative ways to perform the exact same test in <code>R</code>.</p>
<p>To micro-digress, ANOVA is a subset of the Gaussian linear model; the Gaussian linear model is a subset of the General Linear Model; and the General Linear Model is a subset of the GeneralIZED Linear Model. For now we will forget all of that and go with <code><a href="https://rdrr.io/r/stats/aov.html">aov()</a></code>.</p>
<p><br></p>
<section id="perform-the-anova" class="level3"><h3 class="anchored" data-anchor-id="perform-the-anova">6.1 perform the ANOVA**</h3>
<p>We have a few things to do here:</p>
<ul>
<li><p>Perform 1-way ANOVA and look at the basic output for the <strong>overall effect of sire</strong></p></li>
<li><p>Look at how to examine <strong>contrasts</strong> (differences between the control or a reference factor level, and each of the others) and <strong><em>post hoc</em></strong> testing (e.g.&nbsp;all pairwise comparisons between factor levels)</p></li>
<li><p>Examine what happens in the ANOVA in a little more detail</p></li>
</ul>
<p><br></p>
</section><section id="anova-basic-output" class="level3"><h3 class="anchored" data-anchor-id="anova-basic-output">6.2 ANOVA basic output</h3>
<div class="cell">
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## Perform 1-way ANOVA ####</span></span>
<span><span class="co"># Try this</span></span>
<span></span>
<span><span class="co"># NB if the factor is a character, it "should" be coerced to a factor</span></span>
<span><span class="co"># by R, "the passive aggressive butler"</span></span>
<span><span class="co"># If in doubt, explicitly make the vector class == factor()</span></span>
<span><span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">Weight</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">Sire</span><span class="op">)</span>, </span>
<span>          data <span class="op">=</span> <span class="va">new.long</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Df Sum Sq Mean Sq F value Pr(&gt;F)
factor(Sire)  4  17426    4356   1.872  0.137
Residuals    35  81442    2327               </code></pre>
</div>
</div>
<p><br></p>
<p>The output is formatted in a classic “ANOVA Table” style. There are 2 rows - one for the “main effect” of the sire factor, one for the residual error. The test statistic is the F value (1.87), the P-value column is named “Pr(&gt;F)” (0.14), and there are 4 degrees of freedom for this test for the factor (the factor degrees of freedom is the number of factor levels minus 1 = 5 factor levels - 1 = 4; the residual degrees of freedom is the total number of observations minus the number of factor levels = 40 - 5 = 35).</p>
<blockquote class="blockquote">
<p>Here we can see that the overall effect of sire does not significantly explain variation in weight (1-way ANOVA: F = 1.87, df = 4,35, P = 0.14).</p>
</blockquote>
<p><br></p>
</section><section id="contrasts-and-post-hoc-test" class="level3"><h3 class="anchored" data-anchor-id="contrasts-and-post-hoc-test">6.3 Contrasts and <em>post hoc</em> test</h3>
<p>An alternative to the ANOVA table format, and possibly different to the question of an overall mean effect of the factor, is the approach for a regular linear model looking at differences for each factor level relative to a reference factor level like a control. For our experiment, let’s say that sire C is our reference level sire, against which we would like to statistically compare offspring weight for other sires.</p>
<p><br></p>
<div class="cell">
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Use lm() and summary() to generate contrasts</span></span>
<span><span class="co"># Use relevel() to set sire C to the reference factor level</span></span>
<span></span>
<span><span class="co"># make Sire C the reference level</span></span>
<span><span class="va">new.long</span><span class="op">$</span><span class="va">Sire</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/relevel.html">relevel</a></span><span class="op">(</span><span class="va">new.long</span><span class="op">$</span><span class="va">Sire</span>, ref<span class="op">=</span><span class="st">"C"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># calculate linear model</span></span>
<span><span class="va">m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">Weight</span> <span class="op">~</span> <span class="va">Sire</span>, </span>
<span>         data <span class="op">=</span> <span class="va">new.long</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Weight ~ Sire, data = new.long)

Residuals:
    Min      1Q  Median      3Q     Max 
-93.625 -29.312  -2.875  33.906 104.750 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   696.63      17.05  40.846   &lt;2e-16 ***
SireA          18.38      24.12   0.762    0.451    
SireB         -31.50      24.12  -1.306    0.200    
SireD         -39.13      24.12  -1.622    0.114    
SireE         -13.38      24.12  -0.555    0.583    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 48.24 on 35 degrees of freedom
Multiple R-squared:  0.1763,    Adjusted R-squared:  0.08211 
F-statistic: 1.872 on 4 and 35 DF,  p-value: 0.1373</code></pre>
</div>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">Weight</span> <span class="op">~</span> <span class="va">Sire</span>, </span>
<span>     data <span class="op">=</span> <span class="va">new.long</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="12-1-way-anova_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><code>R output</code></p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> m2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> Weight <span class="sc">~</span> Sire, </span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>          <span class="at">data =</span> new.long)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">summary</span>(m2)</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>Call<span class="sc">:</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(<span class="at">formula =</span> Weight <span class="sc">~</span> Sire, <span class="at">data =</span> new.long)</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>Residuals<span class="sc">:</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>    Min      <span class="dv">1</span>Q  Median      <span class="dv">3</span>Q     Max </span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="fl">93.625</span> <span class="sc">-</span><span class="fl">29.312</span>  <span class="sc">-</span><span class="fl">2.875</span>  <span class="fl">33.906</span> <span class="fl">104.750</span> </span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>Coefficients<span class="sc">:</span></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>            Estimate Std. Error t value <span class="fu">Pr</span>(<span class="sc">&gt;</span><span class="er">|</span>t<span class="sc">|</span>)    </span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>(Intercept)   <span class="fl">696.63</span>      <span class="fl">17.05</span>  <span class="fl">40.846</span>   <span class="sc">&lt;</span><span class="fl">2e-16</span> <span class="sc">**</span><span class="er">*</span></span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>SireA          <span class="fl">18.38</span>      <span class="fl">24.12</span>   <span class="fl">0.762</span>    <span class="fl">0.451</span>    </span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>SireB         <span class="sc">-</span><span class="fl">31.50</span>      <span class="fl">24.12</span>  <span class="sc">-</span><span class="fl">1.306</span>    <span class="fl">0.200</span>    </span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>SireD         <span class="sc">-</span><span class="fl">39.13</span>      <span class="fl">24.12</span>  <span class="sc">-</span><span class="fl">1.622</span>    <span class="fl">0.114</span>    </span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>SireE         <span class="sc">-</span><span class="fl">13.38</span>      <span class="fl">24.12</span>  <span class="sc">-</span><span class="fl">0.555</span>    <span class="fl">0.583</span>    </span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a><span class="sc">---</span></span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>Signif. codes<span class="sc">:</span>  <span class="dv">0</span> <span class="st">'***'</span> <span class="fl">0.001</span> <span class="st">'**'</span> <span class="fl">0.01</span> <span class="st">'*'</span> <span class="fl">0.05</span> <span class="st">'.'</span> <span class="fl">0.1</span> <span class="st">' '</span> <span class="dv">1</span></span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>Residual standard error<span class="sc">:</span> <span class="fl">48.24</span> on <span class="dv">35</span> degrees of freedom</span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a>Multiple R<span class="sc">-</span>squared<span class="sc">:</span>  <span class="fl">0.1763</span>,    Adjusted R<span class="sc">-</span>squared<span class="sc">:</span>  <span class="fl">0.08211</span> </span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a>F<span class="sc">-</span>statistic<span class="sc">:</span> <span class="fl">1.872</span> on <span class="dv">4</span> and <span class="dv">35</span> DF,  p<span class="sc">-</span>value<span class="sc">:</span> <span class="fl">0.1373</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><br></p>
<p>Notice how the output format has changed. This is because the summary function (and lots of functions in fact) “behave differently” in response to the specific <code><a href="https://rdrr.io/r/base/class.html">class()</a></code> of object we pass to it (here an <code>lm</code> object; before an <code>aov</code> object). One big difference we see is the table of contrasts. Now, there is are 5 rows: one for the intercept coefficient (testing whether the “grand mean” of Weight is different to zero - NB this is not at all interesting for us), and for rows comparing each factor level to the reference mean for sire “C”.</p>
<p>Here, the Estimate column is an estimate of the AMOUNT of difference in weight relative to the reference mean weight for that sire. E.g., sire B offspring weight is estimated at -31.5 grams (the negative indicate less than) compared to offspring weight for sire C. However, this observed sample difference is not statistically significant (P = 0.20).</p>
<p>Notice the overall F value and p-value for the 1-way are also present at the bottom of the output, which is exactly the same as that produced by the <code><a href="https://rdrr.io/r/stats/aov.html">aov()</a></code> function.</p>
<p><br></p>
<p>We can make a new boxplot based on our new sire variable and notice how it automatically moves sire C to the leftmost “reference position”</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">Weight</span> <span class="op">~</span> <span class="va">Sire</span>, </span>
<span>     data <span class="op">=</span> <span class="va">new.long</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Sire C as reference"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section><section id="post-hoc-tests" class="level3"><h3 class="anchored" data-anchor-id="post-hoc-tests">6.4 <em>Post hoc</em> tests</h3>
<blockquote class="blockquote">
<p>The collection and analysis of data should be driven by the question. We should always be careful to make the distinction between data analysis that <strong>SHOULD be done</strong> versus that which merely <strong>CAN be done</strong>. The former is driven by prediction and motivated by evidence, expectation and the design of data collection. The latter is often a waste of time, or worse, a “fishing expedition” in crass pursuit of a P-value, any P-value, which is &lt; 0.05 .</p>
</blockquote>
<p><br></p>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="https://imgs.xkcd.com/comics/significant.png" class="img-fluid figure-img"></p>
<figcaption>The meaning of significance</figcaption></figure>
</div>
</center>
<p><br></p>
<p><em>Post hoc</em> tests are often interesting in research, and the 1-way ANOVA is a good example, where an overall question of “is there a difference?” can be enhanced by asking whether there are particular or specific differences, say between pairs of means. The phrase <em>post hoc</em> implies that the sometimes these questions can be an afterthought. Thus, consideration should be given as to whether these specific questions NEED to be asked.</p>
<p><br></p>
</section><section id="type-i-errors" class="level3"><h3 class="anchored" data-anchor-id="type-i-errors">6.5 Type I errors</h3>
<p>The alpha (<span class="math inline">\(\alpha\)</span>) value, the value to which we compare our P-value, can be interpreted as the (maximum) probability we are willing to accept of being wrong if we conclude there is significance in our data. Traditionally, this alpha value is accepted to be 0.05, or a 5% chance of making a false positive error. When multiple tests are made on the same data, it increases the chance of discovering a false positive, by chance alone, to above 5%. Thus, there are methods that are used to avoid doing this, by adjusting the P-value to keep the overall likelihood of false positive error at 5%.</p>
<p>The <strong>Bonferroni adjustment</strong> <a href="https://www.bmj.com/content/310/6973/170.short">see Bland and Altman 1995</a> is a baseline, conservative adjustment to the alpha value to avoid false positive errors. This might be typically applied to a 1-way ANOVA situation where specific, pairwise comparisons between means are required that are not covered by the overall test, or by the contrasts. E.g. in our chicken data, we know there is not a difference in offspring weight between sire C and all other sire offsring weights: C:A, C:B, C:D, C:E, but what if we really wanted to test the others? We could use the <strong>Bonferroni adjustment</strong> as implemented in the <code><a href="https://rdrr.io/r/stats/pairwise.t.test.html">pairwise.t.test()</a></code> function.</p>
<p>The <strong>Bonferroni adjustment</strong> simply divides the alpha expected value by the number of <em>post hoc</em> pairwise comparisons. NB the Bonferroni adjustment is conservative, and there are alternatives. The point here is just to illustrate how these tests function and, like with many things, more study will be required to round out foundational knowledge for <em>post hoc</em> testing procedures. The Bonferroni test is nice to know about and understand because it is easy to use, and manually calculate, and can be applied to any situation.</p>
<p><br></p>
<div class="cell">
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Try this:</span></span>
<span></span>
<span><span class="co">## Bonferroni ####</span></span>
<span></span>
<span><span class="co"># ?pairwise.t.test</span></span>
<span></span>
<span><span class="co"># there are a few p.adjust.methods</span></span>
<span><span class="co"># c("holm", "hochberg", "hommel", "bonferroni", "BH", "BY",</span></span>
<span><span class="co">#   "fdr", "none")</span></span>
<span><span class="co"># we will use "bonferroni"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/pairwise.t.test.html">pairwise.t.test</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">new.long</span><span class="op">$</span><span class="va">Weight</span>, </span>
<span>                g <span class="op">=</span> <span class="va">new.long</span><span class="op">$</span><span class="va">Sire</span>,</span>
<span>                p.adjust.method <span class="op">=</span> <span class="st">"bonferroni"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pairwise comparisons using t tests with pooled SD 

data:  new.long$Weight and new.long$Sire 

  C    A    B    D   
A 1.00 -    -    -   
B 1.00 0.46 -    -   
D 1.00 0.23 1.00 -   
E 1.00 1.00 1.00 1.00

P value adjustment method: bonferroni </code></pre>
</div>
</div>
<p><br></p>
<p>NB the output here is a matrix of (Bonferroni adjusted!) p-values for each possible pairwise comparison (none are significant, i.e., less than 0.05). It is also possible to simply calculate uncorrected p-values and compare them to Bonferroni adjust alpha values, as described above!</p>
<p><br></p>
</section><section id="tukey-hsd-honestly-significant-differences" class="level3"><h3 class="anchored" data-anchor-id="tukey-hsd-honestly-significant-differences">6.6 Tukey HSD (Honestly Significant Differences)</h3>
<p>The Tukey HSD test is ideal for 1-way ANOVA, and is less conservative than the Bonferroni adjustment. We use the <code>Tukey.HSD()</code> function to apply it here.</p>
<div class="cell">
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## Tukey Honestly Significant Differences ####</span></span>
<span><span class="co"># ?TukeyHSD</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/TukeyHSD.html">TukeyHSD</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span> <span class="co"># NB m1 - this function requires an "aov" object</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = Weight ~ factor(Sire), data = new.long)

$`factor(Sire)`
       diff        lwr       upr     p adj
B-A -49.875 -119.21883  19.46883 0.2565333
C-A -18.375  -87.71883  50.96883 0.9397600
D-A -57.500 -126.84383  11.84383 0.1436866
E-A -31.750 -101.09383  37.59383 0.6830523
C-B  31.500  -37.84383 100.84383 0.6893101
D-B  -7.625  -76.96883  61.71883 0.9977281
E-B  18.125  -51.21883  87.46883 0.9425341
D-C -39.125 -108.46883  30.21883 0.4937665
E-C -13.375  -82.71883  55.96883 0.9806452
E-D  25.750  -43.59383  95.09383 0.8216369</code></pre>
</div>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/TukeyHSD.html">TukeyHSD</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="12-1-way-anova_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><br></p>
<p>Notice the table of pairwise comparisons. The format is slightly different than that for the simple <code><a href="https://rdrr.io/r/stats/pairwise.t.test.html">pairwise.t.test()</a></code> function output and there is a bit more information. Also note that the p-values tend to be smaller for the exact same comparisons, but there are sill no significant comparisons.</p>
<p><br></p>
</section><section id="alternatives-to-1-way-anova" class="level3"><h3 class="anchored" data-anchor-id="alternatives-to-1-way-anova">6.7 Alternatives to 1-way ANOVA</h3>
<p>In case the assumptions of 1-way ANOVA cannot be met by the data, there are a few options:</p>
<ul>
<li><p>Attempt to transform the data (e.g.&nbsp;with <code><a href="https://rdrr.io/r/base/Log.html">log()</a></code>, <code><a href="https://rdrr.io/r/base/MathFun.html">sqrt()</a></code> or other transformation) to “coerce” the data to conform to the assumptions of 1-way ANOVA</p></li>
<li><p>Use an alternative test for which assumptions are not violated</p></li>
</ul>
<p><br></p>
<p>The simplest alternative test to use for a 1-way ANOVA design would be a “non-parameteric” test that simply does not make the assumptions of Gaussian residuals or of homscedasticity. NB there are other many other methods as well (e.g.&nbsp;the Generalized linear model, randomization, Bayesian modelling), which we will not cover here.</p>
<p>Non-parametric tests have the advantage of being very easy to use, and being very easy to interpret as they tend to be analogous to tests that require assumptions of the data (so-called “parametric tests” like the t-test, regression and 1-way ANOVA).</p>
<p>A downside to these non-parametric tests is that they tend to have less <strong>statistical power</strong>. That is, they are less likely than their parametric cousins to detect a significant difference even if one does exist!</p>
<p><br></p>
</section><section id="kruskal-wallis-non-parametric-alternative-to-the-1-way-anova" class="level3"><h3 class="anchored" data-anchor-id="kruskal-wallis-non-parametric-alternative-to-the-1-way-anova">6.8 Kruskal-Wallis non-parametric alternative to the 1-way ANOVA</h3>
<p>Here we will look at a non-parametric test that is perfect to use instead of, the Kruskal-Wallis test.</p>
<div class="cell">
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Try this:</span></span>
<span><span class="co"># ?kruskal.test</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/kruskal.test.html">kruskal.test</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">Weight</span> <span class="op">~</span> <span class="va">Sire</span>,</span>
<span>             data <span class="op">=</span> <span class="va">new.long</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Kruskal-Wallis rank sum test

data:  Weight by Sire
Kruskal-Wallis chi-squared = 7.648, df = 4, p-value = 0.1054</code></pre>
</div>
</div>
<p><br></p>
<p>The result is qualitatively the same as that for our 1-way ANOVA test, which is not surprising. Reporting the results of this test is similar as well.</p>
<p><br></p>
<blockquote class="blockquote">
<p>We found no evidence of a difference in offspring weight for different sires (Kruskal-Wallis: chi-squared = 7.65, df = 4, P = 0.11).</p>
</blockquote>
<p><br></p>
</section></section><section id="anova-calculation-details" class="level2"><h2 class="anchored" data-anchor-id="anova-calculation-details">7 ANOVA calculation details</h2>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Our data</span></span>
<span><span class="va">chicken.wide</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><br></p>
<section id="anova-equations" class="level3"><h3 class="anchored" data-anchor-id="anova-equations">7.1 ANOVA Equations</h3>
<p><img src="img/2.6-anova-equations.png" class="img-fluid">{width = “600px”}</p>
<p><br></p>
</section><section id="anova-variables" class="level3"><h3 class="anchored" data-anchor-id="anova-variables">7.2 ANOVA Variables</h3>
<p><img src="img/2.6-anova-variables.png" class="img-fluid">{width = “400px”}</p>
<p><br></p>
</section><section id="anova-sources-of-variation-table" class="level3"><h3 class="anchored" data-anchor-id="anova-sources-of-variation-table">7.3 ANOVA Sources of variation table</h3>
<p><img src="img/2.6-anova-sov.png" class="img-fluid"></p>
<p><br></p>
<blockquote class="blockquote">
<p>I like the cocksure argument that you never need to actually “do an ANOVA by hand” because we have computers for that sort of thing these days. Which, we do. But, I think I would make a distinction between someone who has never, or fears they cannot, calculate an ANOVA, versus someone who might occasionally do so just to understand better how the world works. I know which one I would rather be.</p>
</blockquote>
<blockquote class="blockquote">
<p>- Unknown philosopher</p>
</blockquote>
<p><br></p>
</section><section id="do-an-anova-by-hand-programmatically" class="level3"><h3 class="anchored" data-anchor-id="do-an-anova-by-hand-programmatically">7.4 Do an ANOVA “by hand” programmatically</h3>
<div class="cell">
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## ANOVA details ####</span></span>
<span></span>
<span><span class="co"># Try this:</span></span>
<span><span class="co"># For the code below, try to follow what is going on in the code</span></span>
<span><span class="co"># It is okay if not every detail is clear yet</span></span>
<span><span class="co"># Do we get the same answer as aov()?</span></span>
<span></span>
<span><span class="va">n.groups</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">chicken.wide</span><span class="op">)</span></span>
<span><span class="va">n.per.group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html">vector</a></span><span class="op">(</span>mode <span class="op">=</span> <span class="st">"integer"</span>, length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">chicken.wide</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">chicken.wide</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span><span class="va">n.per.group</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">chicken.wide</span><span class="op">[</span>,<span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">}</span></span>
<span></span>
<span><span class="va">n.individuals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">chicken.wide</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">chicken.wide</span><span class="op">)</span></span>
<span><span class="va">df.between</span> <span class="op">&lt;-</span> <span class="va">n.groups</span> <span class="op">-</span> <span class="fl">1</span></span>
<span><span class="va">df.within</span> <span class="op">&lt;-</span> <span class="va">n.individuals</span> <span class="op">-</span> <span class="va">n.groups</span></span>
<span><span class="va">mean.total</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">chicken.wide</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">mean.per.group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">colMeans</a></span><span class="op">(</span><span class="va">chicken.wide</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ss.between</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">n.per.group</span><span class="op">*</span><span class="op">(</span><span class="va">mean.per.group</span> <span class="op">-</span> <span class="va">mean.total</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ss.within</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">chicken.wide</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">mean.per.group</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>                 <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">chicken.wide</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">-</span> <span class="va">mean.per.group</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>                 <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">chicken.wide</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span> <span class="op">-</span> <span class="va">mean.per.group</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>                 <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">chicken.wide</span><span class="op">[</span>,<span class="fl">4</span><span class="op">]</span> <span class="op">-</span> <span class="va">mean.per.group</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>                 <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">chicken.wide</span><span class="op">[</span>,<span class="fl">5</span><span class="op">]</span> <span class="op">-</span> <span class="va">mean.per.group</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span>                 <span class="op">)</span></span>
<span><span class="va">ms.between</span> <span class="op">&lt;-</span> <span class="va">ss.between</span><span class="op">/</span><span class="va">df.between</span></span>
<span><span class="va">ms.within</span> <span class="op">&lt;-</span> <span class="va">ss.within</span><span class="op">/</span><span class="va">df.within</span></span>
<span></span>
<span><span class="co"># Manual F</span></span>
<span><span class="op">(</span><span class="va">myF</span> <span class="op">&lt;-</span> <span class="va">ms.between</span><span class="op">/</span><span class="va">ms.within</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.872189</code></pre>
</div>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Anova table</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span><span class="op">$</span><span class="st">"F value"</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="co"># Store-bought F</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.872189</code></pre>
</div>
</div>
<p><br></p>
</section></section><section id="practice-exercises" class="level2"><h2 class="anchored" data-anchor-id="practice-exercises">8 Practice exercises</h2>
<p>For the following exercises, use the dataset in the file 1.5-OrchardSprays.csv. The dataset is in tidy format. Take advantage of this by looking at the terse information present in the data dictionary tab. The data are from an experiment testing the effectiveness of different pesticide treatments on red lily beetle damage to lily leaves. There will be some data handling as part of the exercises below, a practical and important part of every real data analysis.</p>
<p><br></p>
<section id="loading-and-exploring-the-pesticide-dataset" class="level3"><h3 class="anchored" data-anchor-id="loading-and-exploring-the-pesticide-dataset">8.1 Loading and Exploring the Pesticide Dataset</h3>
<p>Read in the data from the file 1.5-OrchardSprays.csv. Use the <code><a href="https://rdrr.io/r/utils/read.table.html">read.csv()</a></code> function. Print the first few rows of the data, and check the structure of the data. Show your code.</p>
<p><br></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution: Loading and Exploring Data
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Read in the data from the file 1.5-OrchardSprays.csv</span></span>
<span><span class="va">pest</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"1.5-OrchardSprays.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print the first few rows of the data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">pest</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check the structure of the data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">pest</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p><br></p>
</section><section id="testing-normality-of-residuals" class="level3"><h3 class="anchored" data-anchor-id="testing-normality-of-residuals">8.2 Testing Normality of Residuals</h3>
<p>Test the assumption of Gaussian residuals for 1-way ANOVA using any graphs or NHST approach that you deem appropriate. Show your code and briefly describe your EDA findings and conclusion as to whether these data adhere to the Gaussian assumption.</p>
<p><br></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution: Testing Normality of Residuals
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Create the ANOVA model</span></span>
<span><span class="va">pest_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">damage</span> <span class="op">~</span> <span class="va">treatment</span>, data <span class="op">=</span> <span class="va">pest</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Extract residuals</span></span>
<span><span class="va">pest_residuals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="va">pest_model</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Graphical assessment</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Histogram of residuals</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">pest_residuals</span>, </span>
<span>     main <span class="op">=</span> <span class="st">"Histogram of Residuals"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Residuals"</span>,</span>
<span>     breaks <span class="op">=</span> <span class="fl">10</span>,</span>
<span>     col <span class="op">=</span> <span class="st">"lightblue"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Q-Q plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqnorm</a></span><span class="op">(</span><span class="va">pest_residuals</span>, </span>
<span>       main <span class="op">=</span> <span class="st">"Normal Q-Q Plot of Residuals"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqline</a></span><span class="op">(</span><span class="va">pest_residuals</span>, col <span class="op">=</span> <span class="st">"red"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Formal test for normality</span></span>
<span><span class="va">shapiro_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="va">pest_residuals</span><span class="op">)</span></span>
<span><span class="va">shapiro_test</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p><br></p>
</section><section id="testing-homoscedasticity" class="level3"><h3 class="anchored" data-anchor-id="testing-homoscedasticity">8.3 Testing Homoscedasticity</h3>
<p>Test the assumption of homoscedasticity of residuals for 1-way ANOVA using any graphs or NHST approach that you deem appropriate. Show your code and briefly describe your EDA findings and conclusion as to whether these data adhere to the homoscedasticity assumption.</p>
<p><br></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution: Testing Homoscedasticity
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Create the ANOVA model</span></span>
<span><span class="va">pest_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">damage</span> <span class="op">~</span> <span class="va">treatment</span>, data <span class="op">=</span> <span class="va">pest</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Graphical assessment of homoscedasticity</span></span>
<span><span class="co"># Plot residuals vs. fitted values</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html">fitted</a></span><span class="op">(</span><span class="va">pest_model</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="va">pest_model</span><span class="op">)</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Residuals vs. Fitted Values"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Fitted Values"</span>,</span>
<span>     ylab <span class="op">=</span> <span class="st">"Residuals"</span>,</span>
<span>     pch <span class="op">=</span> <span class="fl">19</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">0</span>, lty <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot residuals by treatment group</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="va">pest_model</span><span class="op">)</span> <span class="op">~</span> <span class="va">pest</span><span class="op">$</span><span class="va">treatment</span>,</span>
<span>        main <span class="op">=</span> <span class="st">"Residuals by Treatment"</span>,</span>
<span>        xlab <span class="op">=</span> <span class="st">"Treatment"</span>,</span>
<span>        ylab <span class="op">=</span> <span class="st">"Residuals"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">0</span>, lty <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Formal test for homogeneity of variances</span></span>
<span><span class="va">bartlett_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/bartlett.test.html">bartlett.test</a></span><span class="op">(</span><span class="va">damage</span> <span class="op">~</span> <span class="va">treatment</span>, data <span class="op">=</span> <span class="va">pest</span><span class="op">)</span></span>
<span><span class="va">bartlett_test</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p><br></p>
</section><section id="performing-one-way-anova" class="level3"><h3 class="anchored" data-anchor-id="performing-one-way-anova">8.4 Performing One-way ANOVA</h3>
<p>Perform either a 1-way ANOVA or an appropriate alternative based on your findings in the previous answers. Show your code, state your results in the technical style and briefly interpret your findings.</p>
<p><br></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution: Performing One-way ANOVA
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Perform one-way ANOVA</span></span>
<span><span class="va">pest_anova</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">damage</span> <span class="op">~</span> <span class="va">treatment</span>, data <span class="op">=</span> <span class="va">pest</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">pest_anova</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate group means for interpretation</span></span>
<span><span class="va">treatment_means</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tapply.html">tapply</a></span><span class="op">(</span><span class="va">pest</span><span class="op">$</span><span class="va">damage</span>, <span class="va">pest</span><span class="op">$</span><span class="va">treatment</span>, <span class="va">mean</span><span class="op">)</span></span>
<span><span class="va">treatment_means</span></span>
<span></span>
<span><span class="co"># Calculate proportion of variance explained (effect size)</span></span>
<span><span class="va">pest_anova_summary</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">pest_anova</span><span class="op">)</span></span>
<span><span class="va">SS_treatment</span> <span class="op">&lt;-</span> <span class="va">pest_anova_summary</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span>, <span class="st">"Sum Sq"</span><span class="op">]</span></span>
<span><span class="va">SS_total</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">pest_anova_summary</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>, <span class="st">"Sum Sq"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">eta_squared</span> <span class="op">&lt;-</span> <span class="va">SS_treatment</span> <span class="op">/</span> <span class="va">SS_total</span></span>
<span><span class="va">eta_squared</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p><br></p>
</section><section id="post-hoc-analysis-of-treatment-effects" class="level3"><h3 class="anchored" data-anchor-id="post-hoc-analysis-of-treatment-effects">8.5 Post-hoc Analysis of Treatment Effects</h3>
<p>Perform an appropriate set of <em>post hoc</em> tests to compare pairwise mean differences in these data. Focus on the <em>post hoc</em> questions of interest: Is the organic pesticide effective? Does dose matter in the non-organic treatments?</p>
<p><br></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution: Post-hoc Analysis
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Perform Tukey HSD test for all pairwise comparisons</span></span>
<span><span class="va">tukey_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/TukeyHSD.html">TukeyHSD</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">damage</span> <span class="op">~</span> <span class="va">treatment</span>, data <span class="op">=</span> <span class="va">pest</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">tukey_result</span></span>
<span></span>
<span><span class="co"># Visualize the Tukey results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">tukey_result</span>, las <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># For the specific questions of interest:</span></span>
<span><span class="co"># 1. Is organic pesticide effective? (compare organic vs control)</span></span>
<span><span class="co"># 2. Does dose matter? (compare x.half vs x.full)</span></span>
<span></span>
<span><span class="co"># Extract specific comparisons</span></span>
<span><span class="va">organic_vs_control</span> <span class="op">&lt;-</span> <span class="va">tukey_result</span><span class="op">$</span><span class="va">treatment</span><span class="op">[</span><span class="st">"organic-control"</span>, <span class="op">]</span></span>
<span><span class="va">half_vs_full</span> <span class="op">&lt;-</span> <span class="va">tukey_result</span><span class="op">$</span><span class="va">treatment</span><span class="op">[</span><span class="st">"x.half-x.full"</span>, <span class="op">]</span></span>
<span></span>
<span><span class="co"># Display these specific comparisons</span></span>
<span><span class="va">organic_vs_control</span></span>
<span><span class="va">half_vs_full</span></span>
<span></span>
<span><span class="co"># Create a visual summary of all treatments</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="va">damage</span> <span class="op">~</span> <span class="va">treatment</span>, data <span class="op">=</span> <span class="va">pest</span>,</span>
<span>        main <span class="op">=</span> <span class="st">"Treatment Effects with Significance Groups"</span>,</span>
<span>        xlab <span class="op">=</span> <span class="st">"Treatment Type"</span>,</span>
<span>        ylab <span class="op">=</span> <span class="st">"Leaf Damage (mm²)"</span>,</span>
<span>        col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"lightgray"</span>, <span class="st">"lightgreen"</span>, <span class="st">"lightblue"</span>, <span class="st">"lightyellow"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add letters to indicate significance groups</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, </span>
<span>     y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tapply.html">tapply</a></span><span class="op">(</span><span class="va">pest</span><span class="op">$</span><span class="va">damage</span>, <span class="va">pest</span><span class="op">$</span><span class="va">treatment</span>, <span class="va">max</span><span class="op">)</span> <span class="op">+</span> <span class="fl">5</span>,</span>
<span>     labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"A"</span><span class="op">)</span>,  <span class="co"># Based on Tukey results</span></span>
<span>     font <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add a legend explaining the letters</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, </span>
<span>       legend <span class="op">=</span> <span class="st">"Groups with different letters are significantly different (p &lt; 0.05)"</span>,</span>
<span>       cex <span class="op">=</span> <span class="fl">0.8</span>, bty <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p><br></p>
</section><section id="create-your-own-anova-question" class="level3"><h3 class="anchored" data-anchor-id="create-your-own-anova-question">8.6 Create Your Own ANOVA Question</h3>
<p>Write a plausible practice question involving any aspect of data handling, graphing or analysis for the 1-way ANOVA framework for the iris data (<code>data(iris)</code>; <code><a href="https://rdrr.io/r/datasets/iris.html">help(iris)</a></code>).</p>
<p><br></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution: Creating an ANOVA Question
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># A plausible practice question could be:</span></span>
<span><span class="co"># "Using the iris dataset, perform a one-way ANOVA to determine if there are </span></span>
<span><span class="co"># significant differences in petal length among the three species. If significant </span></span>
<span><span class="co"># differences exist, conduct post-hoc tests to identify which species differ from </span></span>
<span><span class="co"># each other. Create an appropriate visualization to display these differences."</span></span>
<span></span>
<span><span class="co"># Solution:</span></span>
<span><span class="co"># Load the iris dataset</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Examine the data structure</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create a boxplot to visualize the differences</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="va">Petal.Length</span> <span class="op">~</span> <span class="va">Species</span>, data <span class="op">=</span> <span class="va">iris</span>,</span>
<span>        main <span class="op">=</span> <span class="st">"Petal Length Comparison Across Iris Species"</span>,</span>
<span>        xlab <span class="op">=</span> <span class="st">"Species"</span>,</span>
<span>        ylab <span class="op">=</span> <span class="st">"Petal Length (cm)"</span>,</span>
<span>        col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"lightpink"</span>, <span class="st">"lightblue"</span>, <span class="st">"lightgreen"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Perform one-way ANOVA</span></span>
<span><span class="va">iris_anova</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">Petal.Length</span> <span class="op">~</span> <span class="va">Species</span>, data <span class="op">=</span> <span class="va">iris</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">iris_anova</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check assumptions</span></span>
<span><span class="co"># Normality of residuals</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="va">iris_anova</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Homogeneity of variances</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/bartlett.test.html">bartlett.test</a></span><span class="op">(</span><span class="va">Petal.Length</span> <span class="op">~</span> <span class="va">Species</span>, data <span class="op">=</span> <span class="va">iris</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Perform post-hoc test (Tukey's HSD)</span></span>
<span><span class="va">tukey_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/TukeyHSD.html">TukeyHSD</a></span><span class="op">(</span><span class="va">iris_anova</span><span class="op">)</span></span>
<span><span class="va">tukey_result</span></span>
<span></span>
<span><span class="co"># Visualize the Tukey results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">tukey_result</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add mean values to the boxplot</span></span>
<span><span class="va">species_means</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tapply.html">tapply</a></span><span class="op">(</span><span class="va">iris</span><span class="op">$</span><span class="va">Petal.Length</span>, <span class="va">iris</span><span class="op">$</span><span class="va">Species</span>, <span class="va">mean</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, </span>
<span>     y <span class="op">=</span> <span class="va">species_means</span> <span class="op">-</span> <span class="fl">0.3</span>, </span>
<span>     labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">species_means</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>     col <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>     font <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add significance indicators</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, </span>
<span>     y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tapply.html">tapply</a></span><span class="op">(</span><span class="va">iris</span><span class="op">$</span><span class="va">Petal.Length</span>, <span class="va">iris</span><span class="op">$</span><span class="va">Species</span>, <span class="va">max</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.2</span>,</span>
<span>     labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span><span class="op">)</span>,  <span class="co"># All species differ significantly</span></span>
<span>     font <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>


</section></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>© 2025 W. Edwin Harris :: 🦑 <a href="https://github.com/your-repo/RStatsBootcamp-2025">GitHub</a> :: <a href="https://github.com/rstats-bootcamp/RStatsBootcamp-2025/blob/main/LICENSE.md"><img src="https://img.shields.io/badge/license-MIT-green.png" class="img-fluid"></a></p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>


</body></html>